KISSY.version<1.4&&KISSY.config("modules",{io:{alias:["ajax"]}}),KISSY.add("modules/shop/header/favorite-recommend",function(S,DOM,Event,JSON,IO,UA){function StoreCommend(a,b){var c=this;c.config=b,c instanceof StoreCommend||new StoreCommend(a,b),StoreCommend.superclass.constructor.call(c,b),c._init(a)}var doc=document,DOM=S.DOM,Event=S.Event,JSON=S.JSON,IO=S.IO,UA=S.UA,APP_CLS=".mcc-list",NICK_NAME=S.Cookie.get("_nk_"),APP_URL=location.href,URL_REG=/daily/,DOT=".",ID="#",PREV_CLS="J_Prev",NEXT_CLS="J_Next",DIS_PREV_CLS="disable-prev",DIS_NEXT_CLS="disable-next",HOVER_PREV_CLS="hover-prev",HOVER_NEXT_CLS="hover-next",CLICK_PREV_CLS="click-prev",CLICK_NEXT_CLS="click-next",HIDDEN_CLS="hidden",HOVER_CLS="hover",HIDDEN_HOVER_CLS="hidden-hover",CLICK_CLS="click",HIDDEN_CLICK_CLS="hidden-click",UL_CLS="",POP_UP_PANEL="popupPanel",ADD_FAV="#J_AddFav";S.extend(StoreCommend,S.Base),S.mix(StoreCommend,{status:"",data:{ITEM_ID:"data-item-id",NUM:"data-num",OTHER_REC:"data-others-url"},tpl:{APP_TITLE:'<div class="content-hd"><h3>{app_title}</h3><a class="in-detail" href="{other_rec_url}" target="_blank"><span>\u66f4\u591a\u4f18\u9009\u5e97\u94fa</span><i class="detail-icon"></i></a></div>',ITEM_WRAP_BEFORE:'<div class="fav-recommend gird content-bd"><ul class="store-marking">',ITEM_LI_BEFORE:'<li data-item-id="{item_id}"><div><span class="pro-img"><a href="{item_url}" target="_blank"><img name="images" class="snap" src="{item_pic}" alt="{item_name}" /></a></span></div><span><a class="rank-iron" target="_blank" href="{credit_url}" ><img name="images" class="rank" src="{credit_pic}" border="0" align="absmiddle" /></a></span><div><span class="pro-name"><a target="_blank" href="{item_url}" title="{item_name}">{item_name}</a></span></div>',ITEM_LI_AFTER:"</li>",ITEM_WRAP_AFTER:"</ul></div>",NO_RECOMMEND:'<p class="no-recommend">\u60a8\u7684\u773c\u5149\u72ec\u5230\uff0c\u6211\u4eec\u90fd\u4e0d\u77e5\u9053\u8be5\u63a8\u8350\u4ec0\u4e48\u5e97\u94fa\u4e86\uff01</p>'},css:{CSS_TEXT:"{app_id} .store-marking { list-style: none outside none; padding: 0 10px;}{app_id} .store-marking div { *margin-top: 6px; *margin-bottom: 6px;}{app_id} .store-marking li { float:left; width: 83px; zoom: 1; letter-spacing: normal;_display:inlinevertical-align: top; word-spacing: normal; line-height: 24px; margin: 0 6px;}{app_id} .store-marking li .pro-img a {display: block; margin: 0 auto; padding: 1px;text-align: center; height: 80px; width: 80px; background-color: white; overflow: hidden;}{app_id} .store-marking img.snap { height: 80px; }{app_id} .store-marking img.rank { display:inline;  background-color:#e4f0fe}{app_id} .store-marking .pro-name { display: block; height: 38px;overflow: hidden; line-height: 18px; margin-top: 3px;}{app_id} .store-marking .pro-name a { display:block; color: gray;}{app_id} .store-marking .pro-name a:hover { color: #FF5200;}{app_id} .other-rec { position: absolute; top: 0; right: 0; font-family: simsum;}"},return_data:""}),StoreCommend.ATTRS={url:{value:""},credit_url:{value:URL_REG.test(APP_URL)?"//rate.daily.taobao.net":"//rate.taobao.com"},item_id:{value:""},api_method:{value:"old_jsonp"},jsonp_var:{value:"FAV_RECOMMEND"},sumHeight:{value:221},viewSize:{value:756},app_title:{value:""},num:{value:4},page:{value:1},container:{value:""},index:{value:0},preload:{value:null},tryNum:{value:0},tryMaxNum:{value:3},debug:{value:!1}},S.augment(StoreCommend,{_init:function(a){var b=this,c=S.one(a),d=b.get("url"),e=URL_REG.test(APP_URL);c&&(b.status="INIT",b.get("debug")&&(NICK_NAME=!0),b.set("item_id",DOM.attr(c,StoreCommend.data.ITEM_ID)),b.set("container",a),b.set("url",e?d.replace("taobao.com","daily.taobao.net"):d),b._get())},_get:function(callback){var self=this,item_id=self.get("item_id"),num=self.get("num"),page=self.get("page"),status=self.status,api_method=self.get("api_method");if(0!=num&&("LOADING"!==status||"SUCCESS"!==status))switch(self.status="LOADING",api_method){case"old_jsonp":S.getScript(self.get("url")+"&pid="+item_id+"&f=jsonp&jsonp="+self.get("jsonp_var"),function(){S.log("The server returns the jsonp global var");var data=eval(self.get("jsonp_var"));self._processData(data)});break;case"jsonp":IO({type:"GET",url:self.get("url"),data:{pid:item_id,count:num},success:function(a,b,c){self._processData(a)},dataType:"json",error:function(){S.log("ajax\u83b7\u53d6jsonp\u6570\u636e\u5931\u8d25\u4e86")}})}},_processData:function(a){var b=this;S.one(b.get("container")),b.get("sumHeight");a&&a.list&&a.list.length&&(b.status="SUCCESS",S.log("The server returns data successfully."),b.set("num",a.list.length>4?4:a.list.length),b._render(a))},_render:function(a){var b,c,d=this,e=S.one(d.get("container")),f=a.list,g=(d.get("page"),StoreCommend.tpl),h=StoreCommend.css;b=S.substitute(g.APP_TITLE,{app_title:d.get("app_title"),other_rec_url:DOM.attr(e,StoreCommend.data.OTHER_REC)})+g.ITEM_WRAP_BEFORE,S.each(f,function(a,c){var e;e=g.ITEM_LI_BEFORE+g.ITEM_LI_AFTER,b+=S.substitute(e,{item_id:a.id,item_url:a.url,item_pic:a.pic,item_name:a.name,credit_url:"#",credit_pic:d.getCreditIcon(a.shopType,a.rate)})}),b+=g.ITEM_WRAP_AFTER,c=h.CSS_TEXT,c=c.replace(/\{app_id\}/g,d.get("container")),DOM.addStyleSheet(c),DOM.html(d.get("container"),b)},getCreditIcon:function(a,b){var c="//img.alicdn.com/newrank/s_";return 1==a?"//assets.alicdn.com/sys/common/icon/trade/order_mall.png":2==a?"//img.alicdn.com/tps/i1/T10n4SXiNAXXXXXXXX-25-14.png":0==a?(4>b?c="":b>=4&&10>=b?c+="red_1.gif":b>=11&&40>=b?c+="red_2.gif":b>=41&&90>=b?c+="red_3.gif":b>=91&&150>=b?c+="red_4.gif":b>=151&&250>=b?c+="red_5.gif":b>=251&&500>=b?c+="blue_1.gif":b>=501&&1e3>=b?c+="blue_2.gif":b>=1001&&2e3>=b?c+="blue_3.gif":b>=2001&&5e3>=b?c+="blue_4.gif":b>=5001&&1e4>=b?c+="blue_5.gif":b>=10001&&2e4>=b?c+="cap_1.gif":b>=20001&&5e4>=b?c+="cap_2.gif":b>=50001&&1e5>=b?c+="cap_3.gif":b>=100001&&2e5>=b?c+="cap_4.gif":b>=200001&&5e5>=b?c+="cap_5.gif":b>=500001&&1e6>=b?c+="crown_1.gif":b>=1000001&&2e6>=b?c+="crown_2.gif":b>=2000001&&5e6>=b?c+="crown_3.gif":b>=5000001&&1e7>=b?c+="crown_4.gif":b>=10000001&&(c+="crown_5.gif"),c):void 0},isTmall:function(){var a=!1;try{TMall&&(a=!0)}catch(b){a=!1}return a},isLp:function(){var a=!1;try{Lp&&(a=!0)}catch(b){a=!1}return a},isSearch:function(){var a=S.unparam(location.href.split("?")[1]),b=!1;return a.search&&(b=!0),b},_c2cPopupPanel:function(){return parent.document.getElementById(POP_UP_PANEL)||parent.document.getElementById("__mercury_popup_yui-gen0")},setViewSize:function(){var a,b,c,d=this,e=S.get(ADD_FAV),f=Math.max(e.offsetHeight,e.scrollHeight)+"px",g=e.offsetWidth+"px";DOM.height("body",f);try{if(d.isTmall())a=TMall.XDomain.decorate(),a.initEventTrigger(),a.setFrameHeight(POP_UP_PANEL,f,g);else if(d.isLp())a=Lp.XDomain.decorate(),a.initEventTrigger(),a.setFrameHeight(POP_UP_PANEL,f,g);else if(d.isSearch()){var h,i,j=S.unparam(location.href.split("?")[1]),k=DOM.get("#ss-agency-frame");i="//"+j.search+"/templates/domain_bridge.php",j={s:"^",m:"KISSY.QuickSKU.setFavHeight",a:parseInt(f),t:(new Date).getTime()},i+="?"+S.param(j),k?DOM.attr(k,"src",i):(h=DOM.create('<iframe width="0" scrolling="no" height="0" frameborder="0" name="ss-agency-frame" id="ss-agency-frame" src="'+i+'"></iframe>'),DOM.append(h,"body"))}else if(b=d._c2cPopupPanel())if(b.style.height=f,b.style.width=g,c=DOM.get("iframe",b),"IFRAME"==c.tagName.toUpperCase())DOM.css(c,"height",f),DOM.css(c,"width",g);else if(c=b.children[0].children[0],"IFRAME"==c.tagName.toUpperCase())c.height=f,DOM.css(c,"height",f),DOM.css(c,"width",g);else{var l=b.children[1];c=l.children[1],DOM.css([b.children[0],b,l,c],"height",f),DOM.css([b.children[0],b,l,c],"width",g)}}catch(m){S.log(m)}}}),S.StoreCommend=StoreCommend},{requires:["dom","event","json","io","ua"]}),KISSY.add("modules/shop/header/index",function(S,Cookie,Suggest,Overlay,Compatible,XTemplate){function TshopPsmShopHeader(a){var b=this;b._mod=a.mod,b._mod&&b._init()}function addTimeStamp(a){var b=S.now();return a+(-1===a.indexOf("?")?"?":"&")+"t="+b}var S=KISSY,E=S.Event,D=S.DOM,C=S.Cookie,ie=document.all,win=window,doc=document,UA=S.UA,$=S.Node.all;return S.augment(TshopPsmShopHeader,{_init:function(){S.log("TshopPsmShopHeader init start");var a=this;a._bindHasLongHoverEvt(),a._initArchive(),a._initQS(),a._initSearch(),a._initCustomerService(),a._initCollect(),S.log("TshopPsmShopHeader init end")},_bindHasLongHoverEvt:function(){var a=this,b=D.query(".has-hover",a._mod),c=0,d=0;S.each(b,function(b){var e,f;E.on(b,"mouseenter",function(b){var g=b.currentTarget,h=D.get(".popup-content",g);D.hasClass(g,".new-favorites")&&0==c&&(c++,E.fire(g,"fstHover")),D.hasClass(g,".head-archives")&&0==d&&(d++,E.fire(g,"fstHover")),D.addClass(g,"hover"),e&&e.cancel(),e=S.later(function(){D.addClass(g,"long-hover"),D.addClass(D.prev(g),"next-sibling-hover"),D.removeClass(h,"hide"),a._computeSeparatorsHeight(h),a._computerQualificationServiceWidth(h),E.on(h,"mouseover",function(){f&&f.cancel()}),e.cancel()},0);var i;D.hasClass(g,"next-sibling-hover")?i=D.next(g):D.hasClass(D.prev(g),"hover")&&(i=D.prev(g)),i&&(D.removeClass(i,"hover"),D.removeClass(i,"long-hover"),D.removeClass(D.prev(i),"next-sibling-hover"),D.addClass(D.get(".popup-content",i),"hide"))}),E.on(b,"mouseleave",function(a){var b=a.currentTarget,c=D.get(".popup-content",b);f&&f.cancel(),f=S.later(function(){D.removeClass(b,"hover"),D.removeClass(b,"long-hover"),D.removeClass(D.prev(b),"next-sibling-hover"),D.addClass(c,"hide"),f.cancel()},300)})})},_computeSeparatorsHeight:function(a){var b=D.query(".vertical-separator",a),c=0,d=0;S.each(b,function(a){c=D.prev(a)?D.prev(a).offsetHeight:0,d=D.next(a)?D.next(a).offsetHeight:0,D.height(a,c>d?c:d)})},_computerQualificationServiceWidth:function(a){var b=D.query(".qualification",a),c=D.query(".service",a),d=D.parent(b,".popup-content")||D.parent(c,".popup-content");b.length&&c.length&&D.width(d,"501px")},_initSearch:function(){var a=this,b=D.get("#J_TShopSearchForm",a._mod),c=D.get("#shop-q",b);a._getSearchWidth(c),a._bindSearchEvt(b,c),S.ready(function(){a._handleSearchMonitor()})},_getSearchWidth:function(a){var b=this,c=D.get(".logo",b._mod),d=D.get(".head-archives",b._mod),e=D.get(".qualification-service",b._mod),f=D.get(".favorites",b._mod),g=D.get(".customer-service",b._mod);f||(f=D.get(".new-favorites",b._mod));var h=0;if(null!=e&&(h=e.offsetWidth),c&&d&&f&&g){var i=950-c.offsetWidth-d.offsetWidth-h-f.offsetWidth-g.offsetWidth;D.css(a,{width:i-25})}},_bindSearchEvt:function(a,b){var c=this;E.on(a,"mouseenter",function(a){var b=a.currentTarget;D.addClass(b,"form-hover")}),E.on(a,"mouseleave",function(a){var b=a.currentTarget;D.removeClass(b,"form-hover")}),c._searchInputHit(b);new S.Suggest(b,"//suggest.taobao.com/sug?code=utf-8",{resultFormat:"\u7ea6%result%\u4e2a\u5b9d\u8d1d",offset:-2});E.on(".search-button","click",function(b){var c=this;a.action=D.hasClass(c,"searchtb")?D.attr(a,"action"):D.attr(c,"data-action"),a.submit()})},_searchInputHit:function(a){if(a){var b=a.parentNode,c="form-focus",d=function(){""!==a.value?D.addClass(b,c):D.removeClass(b,c)};E.on(a,"focus",function(a){D.addClass(b,c)}),E.on(a,"blur",function(a){setTimeout(d,150)}),setTimeout(d,0)}},_handleSearchMonitor:function(a){window.g_config&&(appId=window.g_config.appId)&&(sourceId=16===appId?"ratez":"shopz",function(b){function c(){var a=new Date,b=a.getMonth()+1;10>b&&(b="0"+b);var c=a.getDate();return 10>c&&(c="0"+c),[a.getFullYear(),b,c].join("")}var d=document.createElement("input");d.setAttribute("type","hidden"),d.setAttribute("name","initiative_id"),d.value=b+"_"+c(),D.append(d,a)}(sourceId))},_initArchive:function(){function a(){var a=D,b=a.val("#dsr-userid"),c="SM_368_dsr-",d=c+b,e=a.val("#dsr-url");if(e){var f='{{#each rates}}<tr>{{#if rate===0.0}}<td><dl><dt>\u63cf\u8ff0\u76f8\u7b26\uff1a</dt><dd><a href="{{../rate_link}}" target="_blank" class="rateinfo">\u5c1a\u672a\u6536\u5230\u8bc4\u4ef7</a></dd></dl></td>{{else}}<td><dl><dt>{{#if xindex===0}}\u63cf\u8ff0\u76f8\u7b26\uff1a{{else}}{{#if xindex===1}}\u670d\u52a1\u6001\u5ea6\uff1a{{else}} \u53d1\u8d27\u901f\u5ea6\uff1a{{/if}}{{/if}}</dt><dd><a href="{{../rate_link}}" target="_blank"><em class="count" title="{{rate_title}}">{{rate}}</em></a></dd></dl></td><td>{{#if rate_UFB===0}}<a href="{{../rate_link}}" target="_blank" class="rateinfo" title="\u8ba1\u7b97\u89c4\u5219:(\u5e97\u94fa\u5f97\u5206-\u540c\u884c\u4e1a\u5e73\u5747\u5206)/(\u540c\u884c\u4e1a\u5e97\u94fa\u6700\u9ad8\u5f97\u5206-\u540c\u884c\u4e1a\u5e73\u5747\u5206)"><b>\u9ad8\u4e8e</b><em>{{rate_g}}%</em>{{else}}{{#if rate_UFB===2}}<a href="{{../rate_link}}" target="_blank" class="rateinfo" title="\u8ba1\u7b97\u89c4\u5219:(\u540c\u884c\u4e1a\u5e73\u5747\u5206-\u5e97\u94fa\u5f97\u5206)/(\u540c\u884c\u4e1a\u5e73\u5747\u5206-\u540c\u884c\u4e1a\u5e97\u94fa\u6700\u4f4e\u5f97\u5206)"><b class="lower">\u4f4e\u4e8e</b><em class="lower">{{rate_g}}%</em>{{else}}<b>\u6301\u5e73</b><em>--------</em>{{/if}}{{/if}}</a></td>{{/if}}</tr>{{/each}}',g=a.get(".shop-credit",self._mod),h=a.get("tbody",g),i=a.get(".virtual",self._mod),j=a.get(".non-virtual",self._mod),k=a.get(".good-rating",g);S.io({url:e,dataType:"jsonp",data:{keys:d},cache:"false",complete:function(b){if(b){if(0===b[d])a.html(h,'<tr class="no-rating"><td colspan="2">\u8be5\u5e97\u94fa\u5c1a\u672a\u6536\u5230\u8bc4\u4ef7</td></tr>');else if(S.isObject(b[d])){a.html(i,b[d].v),a.html(j,b[d].nv),a.html(k,"<dl><dt>\u603b\u4f53\u597d\u8bc4\u7387\uff1a</dt><dd>"+b[d].gp+"%</dd></dl>");var c=[{rate:Math.floor(10*b[d].m)/10,rate_title:b[d].m,rate_UFB:b[d].m_UFB,rate_g:b[d].m_g},{rate:Math.floor(10*b[d].s)/10,rate_title:b[d].s,rate_UFB:b[d].s_UFB,rate_g:b[d].s_g},{rate:Math.floor(10*b[d].c)/10,rate_title:b[d].c,rate_UFB:b[d].c_UFB,rate_g:b[d].c_g}];a.html(h,new XTemplate(f).render({rate_link:a.val("#dsr-ratelink"),rates:c}))}}else S.log("\u83b7\u53d6dsr\u4fe1\u606f\u5931\u8d25")}})}}var b=D.get(".head-archives",self._mod);E.on(b,"fstHover",function(){try{a()}catch(b){S.log("\u521d\u59cb\u5316dsr\u5931\u8d25")}})},_initQS:function(){var a=this,b=D.get(".qualification-service",a._mod),c=D.query("img",b);S.UA.ie&&S.UA.ie<7&&S.each(c,function(a){new Compatible(a,{png:!0,png_tag:!0})})},_initCustomerService:function(){var a=this,b=D.get(".customer-service",a._mod);S.ready(function(){var c=S.Node.all("ul.service-group",b);c.length>0&&a._displayWWGroop(c.item(c.length-1))})},_displayWWGroop:function(node){var self=this,tempwangwang,templi,tempdesc,api="//amos.alicdn.com/",config="groupid=0&v=2&site=cntaobao&s=1&charset=utf-8&uid=",url=node.attr("data-url"),nick=node.attr("data-nick"),gnick=node.attr("data-gnick"),groupIdFilter=node.attr("data-group-filter").split("@_@");node.children().innerHTML=null,""!=url&&S.getScript(url,function(){try{var groups=eval("("+groupMember+")").groups}catch(err){var groups=""}var showMainWW=function(){templi=D.create("<li>",{"data-wangwang":"mainwangwang"}),tempdesc=D.create("<span>",{"class":"groupname"}),D.html(tempdesc,"\u5ba2\u670d\u4e2d\u5fc3"),tempwangwang=D.create("<a>",{href:api+"getcid.aw?"+config+nick+"&fromid=cntaobao"+(S.Cookie.get("_nk_")?S.fromUnicode(S.Cookie.get("_nk_")):""),target:"_blank"}),tempwangwang.appendChild(D.create("<img>",{src:api+"online.aw?"+config+nick,alt:"\u70b9\u51fb\u8fd9\u91cc\u7ed9\u6211\u53d1\u6d88\u606f"})),templi.appendChild(tempdesc),D.insertAfter(tempwangwang,tempdesc),node.append(templi)};if(""!=groups&&groups.group&&groups.group.length&&""!=groupIdFilter[0]){var groupMembers=groups.group,count=0;S.each(groupMembers,function(a,b){(S.inArray(groupMembers[b].groupId.toString(),groupIdFilter)||"all"==groupIdFilter[0])&&(templi=D.create("<li>",{"class":"group"}),tempdesc=D.create("<span>",{"class":"groupname"}),D.html(tempdesc,groupMembers[b].groupName),tempwangwang=D.create("<a>",{href:api+"getcid.aw?v=3&uid="+gnick+"&site=cntaobao&groupid="+groupMembers[b].groupId+"&s=1&charset=gbk&fromid=cntaobao"+(S.Cookie.get("_nk_")?S.fromUnicode(S.Cookie.get("_nk_")):""),target:"_blank"}),tempwangwang.appendChild(D.create("<img>",{src:api+"grponline.aw?v=3&uid="+gnick+"&site=cntaobao&gids="+groupMembers[b].groupId+"&s=1",alt:"\u70b9\u51fb\u8fd9\u91cc\u7ed9\u6211\u53d1\u6d88\u606f"})),templi.appendChild(tempdesc),D.insertAfter(tempwangwang,tempdesc),node.append(templi),count++)}),count?self._moreWWHide():showMainWW()}else showMainWW()})},_moreWWHide:function(){var a=this,b=D.get(".more-WW",a._mod),c=D.query(".group",a._mod);if(c.length>5){for(var d=5;d<c.length;d++)D.css(c[d],"display","none");D.css(b,"display","block");var e;E.on(b,"click",function(){D.css(b,"display","none");for(var d=5;d<c.length;d++)D.css(c[d],"display","block");E.on(D.get(".customer-service",a._mod),"mouseleave",function(){e&&e.cancel(),e=S.later(function(){for(var a=5;a<c.length;a++)D.css(c[a],"display","none");D.css(b,"display","block"),e.cancel()},300)})}),E.on(b,"mouseenter",function(){D.addClass(b,"more-WW-hover")}),E.on(b,"mouseleave",function(){D.removeClass(b,"more-WW-hover")})}},_initCollect:function(){var a=this,b=D.get(".new-favorites",a._mod);S.ready(function(){window.shop_config&&window.shop_config.isView&&a._getCollectState(),a._handleTriggerCollect(),a._initShare(),E.on(b,"fstHover",function(){a._getCollectCount();try{new S.StoreCommend("#J_RRStoreCommend",{url:"//tui.taobao.com/api/shop?src=s2s010&count=4&p=s&from=new_wangpu_shop",num:4,jsonp_var:"fav_collect",viewSize:384,app_title:"\u559c\u6b22\u6b64\u5e97\u94fa\u7684\u4eba\u8fd8\u559c\u6b22",debug:!1,credit_url:"//rate.taobao.com"})}catch(b){S.log("\u521d\u59cb\u5316\u5173\u8054\u5e97\u94fa\u63a8\u8350\u51fa\u9519")}})})},_getCollectState:function(){var a=this,b=C.get("_l_g_")&&C.get("_nk_")||C.get("ck1")&&C.get("tracknick"),c=D.query(".J_TCollectShop",a._mod),d=D.get(".J_TCollectInit",a._mod);b&&S.io({url:addTimeStamp(D.attr(d,"data-init")),type:"post",dataType:"jsonp",success:function(b){b&&"1"===b.state&&b.isCollected&&a._handleCollectSuccess(c)}})},_handleTriggerCollect:function(){var a=this,b=D.get("#popupPanel",a._mod),c=D.query(".J_TCollectShop",a._mod);S.version.indexOf("1.4")>=0&&D.addStyleSheet(".ks-overlay-hidden{visibility:hidden}"),S.each(c,function(d){var e=new Overlay.Dialog({content:b,width:f,height:g,closable:!1,align:{node:d,points:["bl","tr"],offset:[-500,0]},elStyle:{position:"absolute"},zIndex:1e8});E.on(d,"click",function(a){if(!D.hasClass(d,"collected")||!D.parent(d,".content-bd")){if(a.preventDefault(),D.css(b,{display:"block"}),S.version.indexOf("1.4")>=0){e.render();var c=D.get(".ks-dialog-body",e.el);D.append(b,c)}e.show()}});var f=d.getAttribute("data-width"),g=d.getAttribute("data-height");e.on("show",function(){function h(){k.contentWindow._add_item&&a._handleCollectSuccess(c)}var i=addTimeStamp(d.href),j='<a class="close-btn" href="#"style="position: absolute; top: 5px; right: 4px; outline: none;display: block; width: 15px; height: 15px; background: url(//assets.alicdn.com/app/tc/img/close_btn.png) no-repeat; text-decoration: none; text-indent: -99999px">X</a><iframe id="addIframe" src="'+i+'" width="'+f+'" height="'+g+'" name="popupIframe" frameborder="0" scrolling="no"></iframe>';this.set("width",f),this.set("height",g),D.html(b,j),e.center(),E.on(D.get(".close-btn",b),"click",function(){e.hide()});var k=D.get("#addIframe");k.attachEvent?k.attachEvent("onload",function(){h()}):k.onload=function(){h()}})})},_handleCollectSuccess:function(a){S.each(a,function(a){if(D.removeClass(a,"no-collect"),D.addClass(a,"collected"),D.parent(a,".content-bd")){D.attr(a,"href",D.attr(a,"data-href"));var b=D.get(".text",a);b&&D.text(b,"\u5df2\u6536\u85cf")}})},_getCollectCount:function(){var a,b=this,c=D.get("#J_TCollCount",b._mod);c&&(a=S.unparam(c.getAttribute("data-info")))&&c.getAttribute("data-info")&&S.io({url:addTimeStamp(a.countUrl)+"&keys="+a.param,type:"post",dataType:"jsonp",success:function(b){var d=0;b&&(d=parseInt(b[a.param],10),isNaN(d)&&(d=0),d>=1e6&&(d=Math.ceil(d/1e4)+"\u4e07"),c.innerHTML='<a class="high" target="_blank" href="'+a.mecuryUrl+'">'+d+"</a>")}})},_initShare:function(){var a=this;S.getScript("//g.alicdn.com/tb/snsdk/0.0.3/core.min.js?t=20140530",{success:function(){var b=D.get(".J_TShare",a._mod);E.on(b,"click",function(a){a.preventDefault();var c={comment:"\u8fd9\u5bb6\u5e97\u4e0d\u9519\uff0c\u5206\u4eab\u7ed9\u4f60\uff01\u5e0c\u671b\u4f60\u4e5f\u559c\u6b22\u54e6~",type:"shop",key:D.attr(b,"data-id"),client_id:"13",ui:{isIframe:!1,width:900,height:390},callback:{failure:function(){},success:function(){}}};SNS.login(function(){SNS.ui("share",c)})})}})}}),TshopPsmShopHeader.selector=".tshop-psm-shop-header",TshopPsmShopHeader},{requires:["cookie","wangpu/gallery/suggest","overlay","wangpu/decoration/compatible","xtemplate","./favorite-recommend"]});KISSY.add("modules/base/common/index",function(a,b,c){var d={getVdata:function(a){if(window.login_config)return a(null,window.login_config);var d=new c(location.href).getQuery(),e={mockDate:d.get("mockDate"),isAudit:d.get("isAudit")};b({type:"get",data:e,dataType:"jsonp",url:"/i/vdata.htm?"+location.search.substr(1),success:function(b){return window.login_config=b,a(null,b)}})}};return d},{requires:["io","uri"]}),KISSY.add("modules/base/header/index",function(a,b){var c=a.Node.all,d={addExpireNotice:function(){var a=c("#header");if(0!==a.length){var b=a.attr("data-wangpu-left-days"),d="//fuwu.taobao.com/ser/detail.html?service_code=App_Service_W_Shop";b&&Number(b)>0&&Number(15>=b)&&this._isShopMaster(function(c,e){if(!c&&e){var f='<div class="header-expire-tips"><i class="icon-tips">!</i>\u60a8\u7684\u4e13\u4e1a\u7248\u65fa\u94fa<span class="highlight"> '+b+' \u5929\u540e\u5230\u671f</span>\uff0c\u8bf7\u53ca\u65f6\u7eed\u8d39\uff0c\u907f\u514d\u8fc7\u671f\u3002<a href="'+d+'" target="_blank">\u7acb\u5373\u7eed\u8d39</a>\u3002\u7eed\u8d39\u6210\u529f\u540e\uff0c\u672c\u63d0\u9192\u4f1a\u5728\u4e09\u5929\u5185\u6d88\u5931\u3002</div>';a.append(f)}})}},_isShopMaster:function(a){b.getVdata(function(b,c){a(null,c.loginUserId===window.shop_config.userId)})}};return d},{requires:["modules/base/common/index"]}),KISSY.add("modules/shop/header-v2/index",function(a,b,c,d){function e(a){var b=this;b._mod=a.mod,b._mod&&b._init()}function f(){window.temp_ua=window.ua,UA_Opt.Token=(new Date).getTime()+":"+Math.random(),UA_Opt.reload&&UA_Opt.reload()}function g(b){var c=a.now();return b+(-1===b.indexOf("?")?"?":"&")+"t="+c}function h(b){var c=a.DOM.val("#J_TokenField");return b+(-1===b.indexOf("?")?"?":"&")+"_tb_token_="+c}function i(a,b,c){var d=Math.ceil(.45*l.viewportHeight()+l.scrollTop())-c/2,e=Math.ceil((l.docWidth()-b)/2);l.offset(a,{top:d,left:e})}function j(a,b,c,d){f();var e='<a class="close-btn" href="#">X</a><iframe src="'+d+"&ua="+encodeURIComponent(window.temp_ua)+'" width="'+b+'" height="'+c+'" name="popupIframe" frameborder="0" scrolling="no"></iframe><div class="tb-canvas"></div>';l.css(a,"display","none"),l.html(a,e),l.css(a,{visibility:"visible",display:"block",width:b,height:c}),i(a,b,c)}var a=KISSY,k=a.Event,l=a.DOM,m=(a.Cookie,a.Ajax),n=(document.all,window,document,a.UA),o=a.Node.all,p=!window.shop_config,q={item:p?"2013.1.1975045609.d4916909":"a1z10.1.1996643285.d4916901",shop:p?"2013.1.1975045609.d4916913":"a1z10.1.1996643285.d4916905"};return a.augment(e,{_init:function(){a.log("TshopPsmShopHeader init start");var b=this;b._initSM(),b._initColloctWeitaoContainer(),b._initPanelHover(),b._initSearch(),b._initCollect(),b._initWeitaoHover(),b._initWeitaoBtn(),b._initQRLink(),b._initQualification(),b._initImpression(),b._initGoldLogForNewHeaderAndSignboardAndWWHover(),d.addExpireNotice(),a.log("TshopPsmShopHeader init end")},_initSM:function(){window.ua&&window.UA_Opt&&window.UA_Opt.reload||(window.ua="",window.temp_ua="",window.UA_Opt=new Object,UA_Opt.isSendError=1,UA_Opt.LogVal="ua",UA_Opt.SendMethod=8,UA_Opt.MaxKSLog=10,UA_Opt.MaxMCLog=10,UA_Opt.MaxMPLog=10,UA_Opt.MPInterval=50,UA_Opt.MaxFocusLog=10,UA_Opt.MaxGPLog=10,UA_Opt.MaxTcLog=10,UA_Opt.Flag=97422,a.getScript("//uaction.alicdn.com/js/uab.js",{success:function(){window.temp_ua=window.ua,UA_Opt.Token=(new Date).getTime()+":"+Math.random(),UA_Opt.reload&&UA_Opt.reload()}}))},_initPanelHover:function(){var a=this,b=l.get(".J_TShopSummary",a._mod),c=l.get(".J_TShopLeft",a._mod),d=l.get(".J_TSummaryPopup",a._mod),e=[c,d],f=!1,g=null;k.on(e,"mouseenter",function(){f=!0,g&&clearTimeout(g),g=setTimeout(function(){f&&l.addClass(b,"hover")},300)}),k.on(e,"mouseleave",function(){f=!1,g&&clearTimeout(g),g=setTimeout(function(){!f&&l.removeClass(b,"hover")},100)})},_initQualification:function(){function a(a){var b=a,c=l.siblings(b);l.addClass(b,"actived"),l.removeClass(c,"actived")}function b(b){if(n.ie&&n.ie<=6)return void c(b);if(b){if(1===i)return;i--}else{if(i>=j)return;i++}l.removeClass(e,"page2 page3"),l.addClass(e,"page"+i),a(h[3*(i-1)])}function c(b){if(b){if(1===i)return;i--}else if(b===!1){if(i>=j)return;i++}var c=3*(i-1),d=[].slice.call(h,c,c+3);l.hide(h),l.css(d,"display","inline"),a(h[c])}var d=this,e=l.get(".J_TQLFTBox",d._mod),f=l.get(".J_TQLeft",d._mod),g=l.get(".J_TQRight",d._mod),h=l.query(".J_TIconItem",d._mod),i=1,j=Math.ceil(h.length/3);n.ie&&n.ie<=6&&c(),k.on(f,"click",function(){b(!0)}),k.on(g,"click",function(){b(!1)}),k.delegate(e,"mouseenter",".J_TIconItem",function(b){a(b.currentTarget)}),a(h[0])},_initSearch:function(){var a=this,b=l.get("#J_TSearchForm");a._initSearchTab(),a._setSearchTips(),a._initSearchFunc(),a._handleSearchMonitor(b)},_initSearchTab:function(){var a=this,b=l.get("#J_SearchTab"),c=l.get("#J_TSearchForm"),d=l.get("#q"),e=l.get(".btn-search",a._mod);k.on(b,"mouseenter",function(){l.addClass(b,"hover")}),k.on(b,"mouseleave",function(){l.removeClass(b,"hover")}),k.delegate(b,"click",".J_SearchTab",function(a){a.halt();var e=a.currentTarget,f=l.siblings(e),g=l.attr(e,"data-action"),h=l.attr(e,"data-goldlogid"),i=l.attr(e,"data-searchtype");g&&(c.action=g)&&(h?c.setAttribute("data-goldlogid",h):c.removeAttribute("data-goldlogid")),l.val("#J_TSearchSPM","item"==i?q.item:q.shop),l.addClass(e,"selected"),l.removeClass(f,"selected"),l.removeClass(b,"hover"),l.insertBefore(e,f),d.focus()}),k.on(e,"click",function(){var a=l.attr(c,"data-goldlogid");if(a){var b="//gm.mmstat.com"+a+"?logtype=2";goldlog.send(b)}})},_initSearchFunc:function(){var b="1.4.7/",c=",tbc/search-suggest/"+b,d=["dom","index","plugin/history","plugin/tab","new_suggest.css"],e=["history","list"];a.use("event,"+d.join(c),function(a,b,c,d,f,g){var h=new d({plugins:[new f,new g({activeCls:"selected",node:"#J_SearchTab li.J_SearchTab"})],sugConfig:{sourceUrl:"//suggest.taobao.com/sug?k=1",node:"#q",resultFormat:"",isSendByForm:!1},mods:{sort:e}});h.on("beforeFocus",function(){var a=h.get("form");c.addClass(a,"search-panel-focused")}),h.on("beforeBlur",function(){var a=h.get("form");c.removeClass(a,"search-panel-focused")}),b.on(".search-panel-fields","mouseenter",function(a){var b=a.relatedTarget,d=c.get(".search-button");c.contains(d,b)&&c.addClass(".search-panel","search-panel-hover")}),b.on(".search-panel","mouseenter mouseleave",function(a){var b,d,e="mouseenter"===a.type,f=a.currentTarget,g=c.get(".search-button");e?(b=a.target,d="addClass"):(b=a.relatedTarget,d="removeClass"),c.contains(g,b)||c[d].call(this,f,"search-panel-hover")})})},_setSearchTips:function(){function a(){c.value?l.addClass(b,"focus"):l.removeClass(b,"focus")}var b=l.get("#J_TSearchForm"),c=l.get("#q");l.get("#J_SearchIcon");k.on(c,"focus valuechange",a),a()},_handleSearchMonitor:function(a){window.g_config&&(appId=window.g_config.appId)&&(sourceId=16===appId?"ratez":"shopz",function(b){function c(){var a=new Date,b=a.getMonth()+1;10>b&&(b="0"+b);var c=a.getDate();return 10>c&&(c="0"+c),[a.getFullYear(),b,c].join("")}var d=document.createElement("input");d.setAttribute("type","hidden"),d.setAttribute("name","initiative_id"),d.value=b+"_"+c(),l.append(d,a)}(sourceId))},_initCollect:function(){var a=this;a._handleTriggerCollect()},_handleTriggerCollect:function(){var a=this,b=l.get("#popupPanel");k.delegate(a._mod,"click",".J_TCollectShop",function(a){a.preventDefault();var c=a.target,d=o("#J_FavoriteIframeWidth").val()||c.getAttribute("data-width"),e=o("#J_FavoriteIframeHeight").val()||c.getAttribute("data-height"),f=h(g(c.href));j(b,d,e,f)})},_initWeitaoHover:function(){var a=this,b=!1,c=l.get(".J_TWeiTaoPopup",a._mod),d=l.get(".J_TWeitaoHover",a._mod),e=[c,d],f=null;c&&d&&(l.viewportHeight()<9999&&setTimeout(function(){!b&&l.removeClass(c,"show")},2e3),k.on(e,"mouseenter",function(){b=!0,f&&clearTimeout(f),f=setTimeout(function(){b&&l.addClass(c,"show")},200)}),k.on(e,"mouseleave",function(){b=!1,f&&clearTimeout(f),f=setTimeout(function(){!b&&l.removeClass(c,"show")},80)}))},_initWeitaoBtn:function(){var a=this,b=l.get("#popupPanel");k.delegate(a._mod,"click",".J_TWeitaoFlw",function(a){a.preventDefault();var c=a.currentTarget,d=c.getAttribute("data-width"),e=c.getAttribute("data-height");TB.Global.use("fn-login",function(a,f){f.Mini.popup(function(){var a=h(g(c.href));j(b,d,e,a)})})})},_initColloctWeitaoContainer:function(){var a=l.get("#popupPanel");a||(a=l.create('<div id="popupPanel">'),l.append(a,"body"),k.delegate(a,"click",".close-btn",function(b){b.preventDefault(),l.hide(a),iframe=l.get("iframe",a),iframe.contentWindow.sendInvite&&iframe.contentWindow.sendInvite(),l.empty(a)}))},_initQRLink:function(){var a=l.query(".J_TQRLinkShop","body"),b=l.query(".J_TQRLinkDetail","body");a&&k.delegate("body","click",".J_TQRLinkShop",function(a){a.preventDefault();var b=440,c=260,d=l.get(".J_TQRCodeShop"),e=d.src,f=l.get("#popupPanel"),g=l.get(".follow-mobile",self._mod),h=g?"//www.taobao.com/go/act/shop/pop.php?pic=":"//www.taobao.com/go/act/weitao/pop.php?pic=",i=h+encodeURIComponent(e);j(f,b,c,i)}),b&&k.delegate("body","click",".J_TQRLinkDetail",function(a){a.preventDefault();var b=440,c=260,d=l.get("#J_TWeitaoQRCode"),e=d.src,f=l.get("#popupPanel"),g="//www.taobao.com/go/act/detail/pop.php?pic="+e;j(f,b,c,g)})},_initImpression:function(){if(window.shop_config&&shop_config.hasImpress){var a=this,b=l.get(".J_TPopupFold",a._mod),c=l.get(".J_THeadCtrlBtns",a._mod);userId=window.shop_config?shop_config.userId||shop_config.isvStat.userId:g_config.sellerId,isDaily=location.host.indexOf("taobao.com")<0,colors=["red","green","blue","brown"],url=isDaily?"//count.config-vip.taobao.net:8888/counter3":"//count.taobao.com/counter5",m({url:url,data:{keys:"SIP_184_"+userId},type:"get",dataType:"jsonp",scriptCharset:"utf-8",success:function(d){if(d&&d["SIP_184_"+userId]&&d["SIP_184_"+userId].majorImprList){var e,f=d["SIP_184_"+userId].majorImprList,g=0,h="",i='<p class="impress-wrap"><span class="impress-title">\u5e97\u94fa\u5370\u8c61</span>',j=["tbwmdd.1.116","tbwmdd.1.117","tbwmdd.1.118","tbwmdd.1.119"];for(g;g<f.length;g++)e=f[g],color=colors[g%4],i+='<a data-goldlogid="'+j[g]+'" class="J_TImpressLog word '+color+'" target="_blank" href="//goodshop.taobao.com/impressiondetail/impressionDetail.htm?sellerId='+userId+"&impressionId="+e.imprId+'">'+e.imprText+"</a>",0===g&&(h='<span class="shop-impress"><a data-goldlogid="tbwmdd.1.115" class="J_TImpressLog" target="_blank" href="//goodshop.taobao.com/impressiondetail/impressionDetail.htm?sellerId='+userId+"&impressionId="+e.imprId+'">'+e.imprText+"</a></span>");i+="</p>",l.insertBefore(l.create(h),b),l.insertBefore(l.create(i),c),k.delegate(a._mod,"click",".J_TImpressLog",function(a){var b=a.target,c=b.getAttribute("data-goldlogid"),d="//gm.mmstat.com"+c+"?logtype=2";goldlog.send(d)})}}})}},_initGoldLogForNewHeaderAndSignboardAndWWHover:function(){k.delegate("body","click",".J_TGoldlog",function(b){var c=b.currentTarget,d=a.DOM.attr(c,"data-goldlog-id"),e="//gm.mmstat.com"+d+"?logtype=2";goldlog.send(e)})}}),e.selector=".tshop-psm-shop-header2",e},{requires:["cookie","overlay","modules/base/header/index"]});KISSY.add("modules/shop/header-enterprise/mods/search",function(a,b,c,d){var e=b.all,f=function(a){var b=e(".J_Search",a),f=(new c({plugins:[new d],sugConfig:{sourceUrl:"//suggest.taobao.com/sug?k=1&area=c2c",node:e(".J_Suggest",b),focused:!1,resultFormat:""},mods:{sort:["history","list"]}}),e(".J_SecondarySearch",b));f.on("click",function(){var a=f.attr("data-action");a&&e(".J_SearchForm",b).attr("action",a)});var g=e(".J_PrimarySearch",b);g.on("click",function(){})};return f},{requires:["node","tbc/search-suggest/1.4.7/index","tbc/search-suggest/1.4.7/plugin/history","tbc/search-suggest/1.4.7/new_suggest.css"]}),KISSY.add("modules/base/common/index",function(a,b,c){var d={getVdata:function(a){if(window.login_config)return a(null,window.login_config);var d=new c(location.href).getQuery(),e={mockDate:d.get("mockDate"),isAudit:d.get("isAudit")};b({type:"get",data:e,dataType:"jsonp",url:"/i/vdata.htm?"+location.search.substr(1),success:function(b){return window.login_config=b,a(null,b)}})}};return d},{requires:["io","uri"]}),KISSY.add("modules/base/header/index",function(a,b){var c=a.Node.all,d={addExpireNotice:function(){var a=c("#header");if(0!==a.length){var b=a.attr("data-wangpu-left-days"),d="//fuwu.taobao.com/ser/detail.html?service_code=App_Service_W_Shop";b&&Number(b)>0&&Number(15>=b)&&this._isShopMaster(function(c,e){if(!c&&e){var f='<div class="header-expire-tips"><i class="icon-tips">!</i>\u60a8\u7684\u4e13\u4e1a\u7248\u65fa\u94fa<span class="highlight"> '+b+' \u5929\u540e\u5230\u671f</span>\uff0c\u8bf7\u53ca\u65f6\u7eed\u8d39\uff0c\u907f\u514d\u8fc7\u671f\u3002<a href="'+d+'" target="_blank">\u7acb\u5373\u7eed\u8d39</a>\u3002\u7eed\u8d39\u6210\u529f\u540e\uff0c\u672c\u63d0\u9192\u4f1a\u5728\u4e09\u5929\u5185\u6d88\u5931\u3002</div>';a.append(f)}})}},_isShopMaster:function(a){b.getVdata(function(b,c){a(null,c.loginUserId===window.shop_config.userId)})}};return d},{requires:["modules/base/common/index"]}),KISSY.add("modules/shop/header-enterprise/index",function(a,b,c,d,e){function f(a){var b=this;b._mod=a.mod,b._mod&&b._init()}function g(){window.temp_ua=window.ua,UA_Opt.Token=(new Date).getTime()+":"+Math.random(),UA_Opt.reload&&UA_Opt.reload()}function h(b){var c=a.now();return b+(-1===b.indexOf("?")?"?":"&")+"t="+c}function i(b){var c=a.DOM.val("#J_TokenField");return b+(-1===b.indexOf("?")?"?":"&")+"_tb_token_="+c}function j(a,b,c){var d=Math.ceil(.45*m.viewportHeight()+m.scrollTop())-c/2,e=Math.ceil((m.docWidth()-b)/2);m.offset(a,{top:d,left:e})}function k(a,b,c,d){g();var e='<a class="close-btn" href="#">X</a><iframe src="'+d+"&ua="+encodeURIComponent(window.temp_ua)+'" width="'+b+'" height="'+c+'" name="popupIframe" frameborder="0" scrolling="no"></iframe><div class="tb-canvas"></div>';m.css(a,"display","none"),m.html(a,e),m.css(a,{visibility:"visible",display:"block",width:b,height:c}),j(a,b,c)}var l=a.Event,m=a.DOM,n=(a.Cookie,a.Ajax,document.all,window,document,a.UA),o=a.Node.all;!window.shop_config;return a.augment(f,{_init:function(){a.log("TshopPsmShopHeader init start");var b=this;d(b._mod),b._initSM(),b._initPanelHover(),b._initWeitaoHover(),b._initColloctWeitaoContainer(),b._initQRLink(),b._initCollect(),b._initQualification(),b._initGoldLogForNewHeaderAndSignboardAndWWHover(),e.addExpireNotice(),a.log("TshopPsmShopHeader init end")},_initSM:function(){window.ua&&window.UA_Opt&&window.UA_Opt.reload||(window.ua="",window.temp_ua="",window.UA_Opt=new Object,UA_Opt.isSendError=1,UA_Opt.LogVal="ua",UA_Opt.SendMethod=8,UA_Opt.MaxKSLog=10,UA_Opt.MaxMCLog=10,UA_Opt.MaxMPLog=10,UA_Opt.MPInterval=50,UA_Opt.MaxFocusLog=10,UA_Opt.MaxGPLog=10,UA_Opt.MaxTcLog=10,UA_Opt.Flag=97422,a.getScript("//uaction.alicdn.com/js/uab.js",{success:function(){window.temp_ua=window.ua,UA_Opt.Token=(new Date).getTime()+":"+Math.random(),UA_Opt.reload&&UA_Opt.reload()}}))},_initPanelHover:function(){var a=this,b=m.get(".J_TShopSummary",a._mod),c=!1,d=null;l.delegate(a._mod,"mouseenter",".J_TShopSummary",function(){c=!0,d&&clearTimeout(d),d=setTimeout(function(){c&&m.addClass(b,"hover")},300)}),l.delegate(a._mod,"mouseenter",".J_TSummaryPopup",function(){c=!0,d&&clearTimeout(d),d=setTimeout(function(){c&&m.addClass(b,"hover")},300)}),l.delegate(a._mod,"mouseleave",".J_TShopSummary",function(){c=!1,d&&clearTimeout(d),d=setTimeout(function(){!c&&m.removeClass(b,"hover")},100)}),l.delegate(a._mod,"mouseleave",".J_TSummaryPopup",function(){c=!1,d&&clearTimeout(d),d=setTimeout(function(){!c&&m.removeClass(b,"hover")},100)})},_initWeitaoHover:function(){var a=this,b=!1,c=m.get(".J_TWeiTaoPopup",a._mod),d=m.get(".J_TWeitaoHover",a._mod),e=null;c&&d&&(m.viewportHeight()<9999&&setTimeout(function(){!b&&m.removeClass(c,"show")},2e3),l.delegate(a._mod,"mouseenter",".J_TWeiTaoPopup",function(){b=!0,e&&clearTimeout(e),e=setTimeout(function(){b&&m.addClass(c,"show")},200)}),l.delegate(a._mod,"mouseleave",".J_TWeiTaoPopup",function(){b=!1,e&&clearTimeout(e),e=setTimeout(function(){!b&&m.removeClass(c,"show")},80)}),l.delegate(a._mod,"mouseenter",".J_TWeitaoHover",function(){b=!0,e&&clearTimeout(e),e=setTimeout(function(){b&&m.addClass(c,"show")},200)}),l.delegate(a._mod,"mouseleave",".J_TWeitaoHover",function(){b=!1,e&&clearTimeout(e),e=setTimeout(function(){!b&&m.removeClass(c,"show")},80)}))},_initQualification:function(){function a(a){var b=a,c=m.siblings(b);m.addClass(b,"actived"),m.removeClass(c,"actived")}function b(b){if(n.ie&&n.ie<=6)return void c(b);if(b){if(1===i)return;i--}else{if(i>=j)return;i++}m.removeClass(e,"page2 page3"),m.addClass(e,"page"+i),a(h[3*(i-1)])}function c(b){if(b){if(1===i)return;i--}else if(b===!1){if(i>=j)return;i++}var c=3*(i-1),d=[].slice.call(h,c,c+3);m.hide(h),m.css(d,"display","inline"),a(h[c])}var d=this,e=m.get(".J_TQLFTBox",d._mod),f=m.get(".J_TQLeft",d._mod),g=m.get(".J_TQRight",d._mod),h=m.query(".J_TIconItem",d._mod),i=1,j=Math.ceil(h.length/3);n.ie&&n.ie<=6&&c(),l.on(f,"click",function(){b(!0)}),l.on(g,"click",function(){b(!1)}),l.delegate(e,"mouseenter",".J_TIconItem",function(b){a(b.currentTarget)}),a(h[0])},_initCollect:function(){var a=this;a._handleTriggerCollect()},_initColloctWeitaoContainer:function(){var a=m.get("#popupPanel");a||(a=m.create('<div id="popupPanel">'),m.append(a,"body"),l.delegate(a,"click",".close-btn",function(b){b.preventDefault(),m.hide(a),iframe=m.get("iframe",a),iframe.contentWindow.sendInvite&&iframe.contentWindow.sendInvite(),m.empty(a)}))},_handleTriggerCollect:function(){var a=this,b=m.get("#popupPanel");l.delegate(a._mod,"click",".J_TCollectShop",function(a){a.preventDefault();var c=a.target,d=o("#J_FavoriteIframeWidth").val()||c.getAttribute("data-width"),e=o("#J_FavoriteIframeHeight").val()||c.getAttribute("data-height"),f=i(h(c.href));k(b,d,e,f)})},_initQRLink:function(){var a=m.query(".J_TQRLinkShop","body"),b=m.query(".J_TQRLinkDetail","body");a&&l.delegate("body","click",".J_TQRLinkShop",function(a){a.preventDefault();var b=440,c=260,d=m.get(".J_TQRCodeShop"),e=d.src,f=m.get("#popupPanel"),g=m.get(".follow-mobile",self._mod),h=g?"//www.taobao.com/go/act/shop/pop.php?pic=":"//www.taobao.com/go/act/weitao/pop.php?pic=",i=h+encodeURIComponent(e);k(f,b,c,i)}),b&&l.delegate("body","click",".J_TQRLinkDetail",function(a){a.preventDefault();var b=440,c=260,d=m.get("#J_TWeitaoQRCode"),e=d.src,f=m.get("#popupPanel"),g="//www.taobao.com/go/act/detail/pop.php?pic="+e;k(f,b,c,g)})},_initGoldLogForNewHeaderAndSignboardAndWWHover:function(){l.delegate("body","click",".J_TGoldlog",function(b){var c=b.currentTarget,d=a.DOM.attr(c,"data-goldlog-id"),e="//gm.mmstat.com"+d+"?logtype=2";goldlog.send(e)})}}),f.selector=".tshop-psm-shop-header-enterprise",f},{requires:["cookie","overlay","./mods/search","modules/base/header/index"]});KISSY.add("modules/shop/nav-ch/index",function(a,b,c){function d(a){var b=this;b._mod=a.mod,b._mod&&b._init()}function e(b,c){a.each(b,function(a){f.delegate(c,"mouseenter",a.selector,function(b){g.addClass(b.currentTarget,a.hClass)}),f.delegate(c,"mouseleave",a.selector,function(b){g.removeClass(b.currentTarget,a.hClass)})})}var f=a.Event,g=a.DOM,h=a.Node,i=h.all;return a.augment(d,{_init:function(){a.log("TshopPbsmShopNavCh init start");var b=this;b._menuHighlight(),b._initScroll(),a.ready(function(){b._menuPopup(),b._bindEvt(),b._setInherentStyle(),b._fixMaxHeight(),e([{selector:".all-cats",hClass:"all-cats-hover"},{selector:".fst-cat",hClass:".cat-hd-hover"},{selector:".snd-cat-hd",hClass:".snd-cat-hd-hover"},{selector:".menu",hClass:".menu-hover"},{selector:".sub-cat",hClass:".sub-cat-hover"}],g.query(".tshop-pbsm-shop-nav-ch"))}),a.log("TshopPbsmShopNavCh init end")},_menuHighlight:function(){var b=g.get("#J_TSelectedMenuInfo");if(b){var c=a.JSON.parse(g.val(b)).selectedMenu,d=g.query(".menu",self._mod),e=g.get(".menu-selected",self._mod);if(e&&g.removeClass(e,"menu-selected"),""!=c.catId){for(var f=0;f<d.length;f++)if(g.attr(d[f],"data-cat-id")==c.catId){g.addClass(d[f],"menu-selected");break}}else if(""!=c.pageId){for(var f=0;f<d.length;f++)if(g.attr(d[f],"data-page-id")==c.pageId){g.addClass(d[f],"menu-selected");break}}else if(""!=c.linkId)for(var f=0;f<d.length;f++)if(g.attr(d[f],"data-link-id")==c.linkId){g.addClass(d[f],"menu-selected");break}}},_initScroll:function(){if(i(this._mod).hasClass("J_inView")){var a=this,b=i(a._mod).offset().top,c=0;window.location.href.indexOf("preview.htm")>0&&(c=parseInt(i("#page").css("padding-top"))),i(window).on("scroll",function(d){i(document).scrollTop()>=b-c?i(a._mod).hasClass("fixed")||(i(a._mod).addClass("fixed"),i(a._mod).css("top",c+"px")):i(a._mod).hasClass("fixed")&&i(a._mod).removeClass("fixed")})}},_menuPopup:function(){function c(){a.later(function(){if(0!==i.length){try{d(i.shift())}catch(b){a.log("\u521d\u59cb\u5316\u7ec4\u4ef6\u51fa\u9519")}c()}},0)}function d(c){var d=g.get(".all-cats-popup",e),f=c,h=g.next(f,".snd-pop");if(h){var i=g.height(d);if(a.version.indexOf("1.4")>=0){g.hide(h),g.html(h,'<div class="popup-content">'+g.html(h)+"</div>"),g.css(h,{position:"absolute",top:"-99999px",left:"-99999px"}),g.addClass(h,"tb-shop-popup-content"),g.show(h);var j=g.height(g.get(".popup-content",h));if(j>i)var k=new b.Popup({prefixCls:"",srcNode:h,trigger:f,triggerType:"mouse",align:{node:d,points:["tr","tl"],offset:[0,0]},visible:!1,zIndex:1e8});else k=new b.Popup({prefixCls:"",srcNode:h,trigger:f,triggerType:"mouse",align:{node:f,points:["tr","tl"],offset:[0,0]},visible:!1,zIndex:1e8})}else k=j>i?new b.Popup({srcNode:h,trigger:f,triggerType:"mouse",align:{node:d,points:["tr","tl"],offset:[0,0]},visible:!1,zIndex:1e8}):new b.Popup({srcNode:h,trigger:f,triggerType:"mouse",align:{node:f,points:["tr","tl"],offset:[0,0]},visible:!1,zIndex:1e8})}}var e=g.create("<div class='skin-box-bd'></div>"),f=g.create("<div class='tshop-pbsm-shop-nav-ch'></div> ");g.append(e,f),g.append(f,"#content"),g.css(e,"width","0"),g.css(e,"height","0");var h=g.query(".popup-trigger",self._mod);a.each(h,function(c,d){var f=g.parent(c,".popup-container"),h=g.get(".popup-content",f);g.append(h,e);var i=h;if(a.version.indexOf("1.4")>=0){g.hide(i),g.removeClass(i,"popup-content"),g.html(i,'<div class="popup-content">'+g.html(i)+"</div>"),g.addClass(i,"tb-shop-popup-content popup-hidden overlay-hidden"),g.css(i,{position:"absolute",top:"-99999px",left:"-99999px",zIndex:1e8}),g.show(i);var j=new b.Popup({prefixCls:"",srcNode:i,trigger:c,triggerType:"mouse",align:{node:f,points:["bl","tl"],offset:[0,0]},visible:!1,zIndex:1e8})}else j=new b.Popup({prefixCls:"",srcNode:i,trigger:c,triggerType:"mouse",align:{node:f,points:["bl","tl"],offset:[0,0]},visible:!1,zIndex:1e8})});var i=g.query(".fst-cat-hd",e);c()},_bindEvt:function(){},_setInherentStyle:function(){var a=this;g.css(a._mod,"display","block"),g.css(a._mod,"visibility","visible")},_fixMaxHeight:function(){var a=this;new c(a._mod,{maxHeight:!0,maxHeightValue:150}),new c(g.get("#hd"),{maxHeight:!0,maxHeightValue:150}),g.css(".tshop-pbsm-shop-custom-banner","position","relative")}}),d.selector=".tshop-pbsm-shop-nav-ch",d},{requires:["overlay","wangpu/decoration/compatible"]});KISSY.add("modules/shop/bulletin/index",function(a){function b(a){var b=this;b._mod=a.mod,b._mod&&b._init()}var a=KISSY,c=a.Event,d=a.DOM;return a.augment(b,{_init:function(){a.log("TshopPbsmShopBulletin init start"),this._bindEvt(),a.log("TshopPbsmShopBulletin init end")},_bindEvt:function(){var a=d.get("marquee",self._mod);c.on(a,"mouseout",function(){this.start()}),c.on(a,"mouseover",function(){this.stop()})}}),b.selector=".tshop-pbsm-shop-bulletin",b});KISSY.add("modules/shop/custom-banner/index",function(a){function b(a){var b=this;b._mod=a.mod,b._mod&&b._init()}var a=KISSY;a.Event,a.DOM;return a.augment(b,{_init:function(){a.log("TshopPbsmShopCustomBanner init start")}}),b.selector=".tshop-pbsm-shop-banner",b});KISSY.add("modules/shop/friend-link/index",function(a){function b(a){var b=this;b._mod=a.mod,b._mod&&b._init()}var a=KISSY,c=a.Event,d=a.DOM;return a.augment(b,{_init:function(){a.log("TshopPbsmShopFriendLink init start");var b=this,e=d.query(".cat",b._mod);c.on(e,"mouseenter",function(a){var b=a.target;d.hasClass(a.target,"cat")||(b=d.parent(a.target,".cat")),d.addClass(b,"cat-hover")}),c.on(e,"mouseleave",function(a){var b=a.target;d.hasClass(a.target,"cat")||(b=d.parent(a.target,".cat")),d.removeClass(b,"cat-hover")}),a.log("TshopPbsmShopFriendLink init end")}}),b.selector=".tshop-pbsm-shop-friend-link",b});KISSY.add("modules/shop/main-slide/index",function(a){function b(b){var c=this;if(c._mod=b.mod,c._mod){a.log("TshopPbsmShopMainSlide init start"),c._init(),c.prevBtn=d.get(".prev-btn",c._mod),c.nextBtn=d.get(".next-btn",c._mod);var e=c.getCurrentStyle(d.get(".slide-box",c._mod),"height"),f=(e-c.getCurrentStyle(d.get(".slide-triggers",c._mod),"height")-c.getCurrentStyle(c.prevBtn,"height"))/2;c.prevBtn.style.top=(f>0?parseInt(f,10):0)+"px",c.nextBtn.style.top=(f>0?parseInt(f,10):0)+"px",a.UA.ie&&6==a.UA.ie&&(d.get(".slide-box",c._mod).className=d.get(".slide-box",c._mod).className),a.log("TshopPbsmShopMainSlide init end")}}var a=KISSY,c=a.Event,d=a.DOM;return a.augment(b,{_init:function(){var a=this;a.disBtn()},disBtn:function(){var a=this,b=d.get(".slide-box",a._mod),e=d.get(".prev-btn",a._mod),f=d.get(".next-btn",a._mod);c.on(b,"mouseenter",function(){d.addClass(e,"play"),d.addClass(f,"play")}),c.on(b,"mouseleave",function(){d.removeClass(e,"play"),d.removeClass(f,"play")}),c.on(e,"mouseenter",function(){d.addClass(e,"hover-pre")}),c.on(e,"mouseleave",function(){d.removeClass(e,"hover-pre")}),c.on(f,"mouseenter",function(){d.addClass(f,"hover-next")}),c.on(f,"mouseleave",function(){d.removeClass(f,"hover-next")})},render:function(a){},getCurrentStyle:function(a,b){var c=this,d="";return b=c.transToHump(b),d=window.getComputedStyle?window.getComputedStyle(a,null)[b]:a.currentStyle[b],parseInt(d,10)?parseInt(d,10):0},transToHump:function(a){return a.replace(/-([a-z])/gi,function(a,b){return b.toUpperCase()})}}),b.selector=".tshop-pbsm-shop-main-slide",b});KISSY.add("modules/shop/item-cates/index",function(a){function b(a){var b=this;b._mod=a.mod,b._mod&&b._init()}function c(b,c){var f=[],g=a.UA.ie;g&&6===g&&a.each(b,function(b){f=e.query(b.selector,c),a.each(f,function(a){d.on(a,"mouseenter",function(a){e.addClass(this,b.hClass)}),d.on(a,"mouseleave",function(a){e.removeClass(this,b.hClass)})})})}var a=KISSY,d=a.Event,e=a.DOM;return a.augment(b,{_init:function(){a.log("TshopPbsmShopItemCates init start");var b=this;b._catHighlight(),b._bindEvt(),c([{selector:".cat-hd",hClass:".cat-hd-hover"}],b._mod),a.log("TshopPbsmShopItemCates init end")},_catHighlight:function(){var b=e.get("#J_TSelectedMenuInfo");if(b){var c=a.JSON.parse(e.val(b)).selectedMenu,d=e.query(".cat-hd",self._mod),f=e.get(".cat-selected",self._mod);if(f&&e.removeClass(f,"cat-selected"),""==c.childCatId||""==c.catId)return;if(c.childCatId==c.catId){for(var g=0;g<d.length;g++)if(e.attr(d[g],"data-cat-id")==c.catId){e.addClass(d[g],"cat-selected");break}}else for(var g=0;g<d.length;g++)if(e.attr(d[g],"data-cat-id")==c.childCatId){e.addClass(d[g],"cat-selected");break}}},_bindEvt:function(){d.on(".cat-name","click",function(a){var b=e.get(a.currentTarget),c=e.parent(b,".cat-hd"),d=e.get(".cat-selected",self._mod);d&&e.removeClass(d,"cat-selected"),c&&!e.hasClass(c,"cat-selected")&&e.addClass(c,"cat-selected")})}}),b.selector=".tshop-pbsm-shop-item-cates",b});KISSY.add("modules/shop/item-recommend/index",function(a,b){function c(a){this.elem=a}function d(a){var b=this;b._mod=a.mod,b._mod&&b._init()}function e(a,b){var c=a.length,d=0,e=a.match(/[\u4E00-\u9FA5\uF900-\uFA2D]/g);null!=e&&(d+=e.length);var f=b-c-d;if(0>f){for(var g=0,h=a.substring(0,b),i=0;i<h.length&&(g+=/[\u4E00-\u9FA5\uF900-\uFA2D]/.test(h.charAt(i))?2:1,!(g>b));i++);return h.substring(0,i)+"\u2026"}return a}var a=KISSY,f=a.Event,g=a.DOM,h=a.all,i="disappear",j="success",k="warn",m="failure",n={"grid-m":{item3line1:[0,0,310,310],item4line1:[0,0,230,230],item5line1:[0,0,180,180],item7line1:[0,0,130,130]},"grid-m0":{item3line1:[0,0,310,310],item4line1:[0,0,230,230],item5line1:[0,0,180,180],item7line1:[0,0,130,130]},"grid-s5m0":{item3line1:[0,0,240,240],item30line1:[0,0,248,248],item4line1:[0,0,180,180]},"grid-m0s5":{item3line1:[0,0,240,240],item30line1:[0,0,248,248],item4line1:[0,0,180,180]},"grid-s5m0e5":{item3line1:[0,0,180,180],item4line1:[0,0,130,130]},"grid-m0s5e5":{item3line1:[0,0,180,180],item4line1:[0,0,130,130]},"grid-s5e5m0":{item3line1:[0,0,180,180],item4line1:[0,0,130,130]},"grid-e5s5m0":{item3line1:[0,0,180,180],item4line1:[0,0,130,130]},"grid-e5m0s5":{item3line1:[0,0,180,180],item4line1:[0,0,130,130]},"grid-m0e5s5":{item3line1:[0,0,180,180],item4line1:[0,0,130,130]},"col-sub":{item1line1:[0,0,180,180]},"col-extra":{item1line1:[0,0,180,180]}};return a.mix(c.prototype,{val:function(b,c,d){a.isString(b)&&(d=void 0===d?!0:!!d,g.html(g.get(".text",this.elem),b),this.show(c),d&&this.hide(d))},loading:function(){return this.val("\u6b63\u5728\u5904\u7406\uff0c\u8bf7\u7a0d\u540e...",1,!1)},show:function(a){var b=this.elem;g.css(b,"opacity",1),g.removeClass(b,j),g.removeClass(b,k),g.removeClass(b,m),g.removeClass(b,i),1==a?g.addClass(b,j):2==a?g.addClass(b,k):0==a&&g.addClass(b,m)},hide:function(b){var c=this,d=c.elem;return!0===b?(c.timer&&c.timer.cancel(),void(c.timer=a.later(function(){var b={opacity:0},e=new a.Anim(d,b,.5,"easeIn",function(){g.addClass(d,i),c.timer=null});e.run()},3e3))):void g.addClass(d,i)}}),a.augment(d,{_init:function(){a.log("TshopPbsmShopItemRecommend init start");var b,c=this;b=function(){c._updateToken(),c._bindEvt(),c.fixHover([{selector:".item-wrap",hClass:"item-wrap-hover"}]),c._initItemRates(),c._fixMinMax(),a.log("TshopPbsmShopItemRecommend init end")},c._ABTestRequest(b)},_ABTestRequest:function(b){var c,d,e,f=this;return e=function(){return b(),!1},(c=g.attr(f._mod,"data-ald-rcmd"))?(d=JSON.parse(c),d&&d.url?void a.io({url:d.url,dataType:"jsonp",data:{refer:document.referrer||""},success:function(b){if(!b||!b.itemList||!b.itemList.length)return e();var c=g.get(".skin-box",f._mod),i=g.innerHeight(f._mod);g.css(f._mod,"height",i),g.css(c,"display","none");var j,k=g.query(".item",f._mod);if(j=g.get(".J_TItemRatesUrl")){var l=g.val(j),m=function(){var c=[];return a.each(b,function(a){c.push(a.id)}),c.join(",")}();l.replace(/itemIds=.*&/i,"itemIds="+m+"&"),g.val(j,l)}a.each(k,function(c,e){var f,i=h(c),j=h(c).attr("data-id");a.each(b.itemList,function(a){return a.id===j?(f=a,!1):void 0});var k=g.get("img",c),l=d.picSize?d.picSize:"310",m="_"+l+"x"+l+".jpg",n=f.img+m;g.attr(k,"data-ks-lazyload")?g.attr(k,"data-ks-lazyload",n):g.attr(k,"src",n),i.attr(".s-price")&&i.attr(".s-price",f.price),g.attr(c,"data-id",f.id),g.attr(g.query("a",c),"href",f.url),g.text(g.get(".item-name",c),f.title),g.text(g.get(".c-price",c),(d.showDiscount?f.price:f.marketPrice)||""),g.text(g.get(".sale-num",c),f.sellNum||0),g.text(g.get(".comment-num",c),f.commentNum||0)}),(new Image).src=b.acurl,g.css(f._mod,"height","auto"),g.css(c,"display","block"),e()},error:e}):e()):e()},_updateToken:function(){var b=this,c=g.get("#J_TokenField");if(c){var d=/_tb_token_=[^&].*/i,e="_tb_token_="+c.value,f=g.query(".J_TCollectItem",b._mod);a.each(f,function(a){var b=g.attr(a,"data-href");d.test(b)?g.attr(a,"data-href",b.replace(d,e)):g.attr(a,"data-href",b+=(-1!==b.lastIndexOf("&")?"&":"?")+e)})}},_bindEvt:function(){},fixHover:function(b){var c=this,d=[];a.each(b,function(b){d=g.query(b.selector,c._mod),a.each(d,function(c){f.on(c,"mouseenter",function(c){a.one(this).addClass(b.hClass)}),f.on(c,"mouseleave",function(c){a.one(this).removeClass(b.hClass)})})})},_bindItemCollectEvt:function(){var b=this,d=g.get(".items",b._mod);f.on(d,"click",function(b){var d=b.target;if(g.hasClass(d,"J_TCollectItem")){var e=d;a.io({url:g.attr(e,"data-href"),data:{itemSkuList:g.attr(e,"data-item-id")},dataType:"jsonp",success:function(a){var b,d;if(a.result.status)b="\u6536\u85cf\u6210\u529f",d=1;else{switch(a.result.message.errorCode){case 7:case 8:case 11:d=2;break;default:d=0}b=a.result.message.error}var f=new c(g.get(".J_TMsg",g.parent(e)));f.val(b,d)},error:function(a){var b=new c(g.get(".J_TMsg",g.parent(e)));b.val("\u64cd\u4f5c\u8d85\u65f6",0)}})}})},_initItemRates:function(){function b(){a.io({url:h.value,dataType:"jsonp",jsonp:"jsoncallback",type:"post",success:function(b){var c,f,h=b.batchQueryRateList,i=g.query(".item",d._mod);a.each(i,function(a){c=g.attr(a,"data-id");for(var b=0;b<h.length;b++)h[b].auctionNumId==c&&(f=g.get(".J_TRate",a),""==h[b].rateContent?g.text(f,"\u6682\u65e0\u8bc4\u8bba"):g.text(f,e(h[b].rateContent,72)))})},error:function(b){a.log("\u67e5\u8be2\u5b9d\u8d1d\u8bc4\u8bba\u5931\u8d25")}})}function c(){!d.isSendRate&&g.scrollTop(window)>=i&&(d.isSendRate=!0,b(),f.detach(window,"scroll",c))}var d=this,h=g.get(".J_TItemRatesUrl",d._mod),i=g.offset(d._mod).top-g.viewportHeight();d.isSendRate=!1,h&&""!=h.value&&f.on(window,"scroll",c)},_fixMinMax:function(){var c,d,e,f=this;if(null!=g.parent(f._mod,".col-sub"))c=n["col-sub"];else if(null!=g.parent(f._mod,".col-extra"))c=n["col-extra"];else{var h=g.parent(f._mod,".layout"),i=["grid-m","grid-m0","grid-s5m0","grid-m0s5","grid-s5m0e5","grid-m0s5e5","grid-s5e5m0","grid-e5s5m0","grid-e5m0s5","grid-m0e5s5"];for(e=0,l=i.length;e<l&&!g.hasClass(h,i[e]);e++);c=n[i[e]]}var j=["item1line1","item3line1","item30line1","item4line1","item5line1","item7line1"],k=g.get("div",g.get(".skin-box-bd",f._mod));for(e=0,l=j.length;e<l&&!g.hasClass(k,"."+j[e]);e++);if(d=c[j[e]],void 0!=d){var m=d,o=g.query("img",f._mod),p={},q=["minWidth","minHeight","maxWidth","maxHeight"];for(e=0,l=m.length;e<l;e++)0!==parseInt(m[e])&&(p[q[e]]=!0,p[q[e]+"Value"]=parseInt(m[e]));a.each(o,function(a){new b(a,p)})}}}),d.selector=".tshop-pbsm-shop-item-recommend",d},{requires:["wangpu/decoration/compatible"]});KISSY.add("modules/shop/item-pre-recommend/index",function(a,b){function c(a){this.elem=a}function d(a){var b=this;b._mod=a.mod,b._mod&&b._init()}function e(a,b){var c=a.length,d=0,e=a.match(/[\u4E00-\u9FA5\uF900-\uFA2D]/g);null!=e&&(d+=e.length);var f=b-c-d;if(0>f){for(var g=0,h=a.substring(0,b),i=0;i<h.length&&(g+=/[\u4E00-\u9FA5\uF900-\uFA2D]/.test(h.charAt(i))?2:1,!(g>b));i++);return h.substring(0,i)+"\u2026"}return a}var a=KISSY,f=a.Event,g=a.DOM,h="disappear",i="success",j="warn",k="failure",m={"grid-m":{item3line1:[0,0,310,310],item4line1:[0,0,230,230],item5line1:[0,0,180,180],item7line1:[0,0,130,130]},"grid-m0":{item3line1:[0,0,310,310],item4line1:[0,0,230,230],item5line1:[0,0,180,180],item7line1:[0,0,130,130]},"grid-s5m0":{item3line1:[0,0,240,240],item30line1:[0,0,248,248],item4line1:[0,0,180,180]},"grid-m0s5":{item3line1:[0,0,240,240],item30line1:[0,0,248,248],item4line1:[0,0,180,180]},"grid-s5m0e5":{item3line1:[0,0,180,180],item4line1:[0,0,130,130]},"grid-m0s5e5":{item3line1:[0,0,180,180],item4line1:[0,0,130,130]},"grid-s5e5m0":{item3line1:[0,0,180,180],item4line1:[0,0,130,130]},"grid-e5s5m0":{item3line1:[0,0,180,180],item4line1:[0,0,130,130]},"grid-e5m0s5":{item3line1:[0,0,180,180],item4line1:[0,0,130,130]},"grid-m0e5s5":{item3line1:[0,0,180,180],item4line1:[0,0,130,130]},"col-sub":{item1line1:[0,0,180,180]},"col-extra":{item1line1:[0,0,180,180]}};return a.mix(c.prototype,{val:function(b,c,d){a.isString(b)&&(d=void 0===d?!0:!!d,g.html(g.get(".text",this.elem),b),this.show(c),d&&this.hide(d))},loading:function(){return this.val("\u6b63\u5728\u5904\u7406\uff0c\u8bf7\u7a0d\u540e...",1,!1)},show:function(a){var b=this.elem;g.css(b,"opacity",1),g.removeClass(b,i),g.removeClass(b,j),g.removeClass(b,k),g.removeClass(b,h),1==a?g.addClass(b,i):2==a?g.addClass(b,j):0==a&&g.addClass(b,k)},hide:function(b){var c=this,d=c.elem;return!0===b?(c.timer&&c.timer.cancel(),void(c.timer=a.later(function(){var b={opacity:0},e=new a.Anim(d,b,.5,"easeIn",function(){g.addClass(d,h),c.timer=null});e.run()},3e3))):void g.addClass(d,h)}}),a.augment(d,{_init:function(){a.log("TshopPbsmShopItemPreRecommend init start");var b,c=this;b=function(){c._updateToken(),c._bindEvt(),c.fixHover([{selector:".item-wrap",hClass:"item-wrap-hover"}]),c._initItemRates(),c._fixMinMax(),a.log("TshopPbsmShopItemPreRecommend init end")},c._ABTestRequest(b)},_ABTestRequest:function(b){var c,d,e,f=this;return e=function(){return b(),!1},(c=g.attr(f._mod,"data-ald-rcmd"))?(d=JSON.parse(c),d&&d.url?void a.io({url:d.url,dataType:"jsonp",data:{refer:document.referrer||""},success:function(b){if(!b||!b.itemList||!b.itemList.length)return e();var c=g.get(".skin-box",f._mod),h=g.innerHeight(f._mod);g.css(f._mod,"height",h),g.css(c,"display","none");var i,j=g.query(".item",f._mod);if(i=g.get(".J_TItemRatesUrl")){var k=g.val(i),l=function(){var c=[];return a.each(b,function(a){c.push(a.id)}),c.join(",")}();k.replace(/itemIds=.*&/i,"itemIds="+l+"&"),g.val(i,k)}a.each(j,function(a,c){var e=b.itemList[c],f=g.get("img",a),h=d.picSize?d.picSize:"310",i="_"+h+"x"+h+".jpg",j=e.img+i;g.attr(f,"data-ks-lazyload")?g.attr(f,"data-ks-lazyload",j):g.attr(f,"src",j),g.attr(a,"data-id",e.id),g.attr(g.query("a",a),"href",e.url),g.text(g.get(".item-name",a),e.title),g.text(g.get(".c-price",a),(d.showDiscount?e.price:e.marketPrice)||""),g.text(g.get(".sale-num",a),e.sellNum||0),g.text(g.get(".comment-num",a),e.commentNum||0)}),(new Image).src=b.acurl,g.css(f._mod,"height","auto"),g.css(c,"display","block"),e()},error:e}):e()):e()},_updateToken:function(){var b=this,c=g.get("#J_TokenField");if(c){var d=/_tb_token_=[^&].*/i,e="_tb_token_="+c.value,f=g.query(".J_TCollectItem",b._mod);a.each(f,function(a){var b=g.attr(a,"data-href");d.test(b)?g.attr(a,"data-href",b.replace(d,e)):g.attr(a,"data-href",b+=(-1!==b.lastIndexOf("&")?"&":"?")+e)})}},_bindEvt:function(){},fixHover:function(b){var c=this,d=[];a.each(b,function(b){d=g.query(b.selector,c._mod),a.each(d,function(c){f.on(c,"mouseenter",function(c){a.one(this).addClass(b.hClass)}),f.on(c,"mouseleave",function(c){a.one(this).removeClass(b.hClass)})})})},_bindItemCollectEvt:function(){var b=this,d=g.get(".items",b._mod);f.on(d,"click",function(b){var d=b.target;if(g.hasClass(d,"J_TCollectItem")){var e=d;a.io({url:g.attr(e,"data-href"),data:{itemSkuList:g.attr(e,"data-item-id")},dataType:"jsonp",success:function(a){var b,d;if(a.result.status)b="\u6536\u85cf\u6210\u529f",d=1;else{switch(a.result.message.errorCode){case 7:case 8:case 11:d=2;break;default:d=0}b=a.result.message.error}var f=new c(g.get(".J_TMsg",g.parent(e)));f.val(b,d)},error:function(a){var b=new c(g.get(".J_TMsg",g.parent(e)));b.val("\u64cd\u4f5c\u8d85\u65f6",0)}})}})},_initItemRates:function(){function b(){a.io({url:h.value,dataType:"jsonp",jsonp:"jsoncallback",type:"post",success:function(b){var c,f,h=b.batchQueryRateList,i=g.query(".item",d._mod);a.each(i,function(a){c=g.attr(a,"data-id");for(var b=0;b<h.length;b++)h[b].auctionNumId==c&&(f=g.get(".J_TRate",a),""==h[b].rateContent?g.text(f,"\u6682\u65e0\u8bc4\u8bba"):g.text(f,e(h[b].rateContent,72)))})},error:function(b){a.log("\u67e5\u8be2\u5b9d\u8d1d\u8bc4\u8bba\u5931\u8d25")}})}function c(){!d.isSendRate&&g.scrollTop(window)>=i&&(d.isSendRate=!0,b(),f.detach(window,"scroll",c))}var d=this,h=g.get(".J_TItemRatesUrl",d._mod),i=g.offset(d._mod).top-g.viewportHeight();d.isSendRate=!1,h&&""!=h.value&&f.on(window,"scroll",c)},_fixMinMax:function(){var c,d,e,f=this;if(null!=g.parent(f._mod,".col-sub"))c=m["col-sub"];else if(null!=g.parent(f._mod,".col-extra"))c=m["col-extra"];else{var h=g.parent(f._mod,".layout"),i=["grid-m","grid-m0","grid-s5m0","grid-m0s5","grid-s5m0e5","grid-m0s5e5","grid-s5e5m0","grid-e5s5m0","grid-e5m0s5","grid-m0e5s5"];for(e=0,l=i.length;e<l&&!g.hasClass(h,i[e]);e++);c=m[i[e]]}var j=["item1line1","item3line1","item30line1","item4line1","item5line1","item7line1"],k=g.get("div",g.get(".skin-box-bd",f._mod));for(e=0,l=j.length;e<l&&!g.hasClass(k,"."+j[e]);e++);if(d=c[j[e]],void 0!=d){var n=d,o=g.query("img",f._mod),p={},q=["minWidth","minHeight","maxWidth","maxHeight"];for(e=0,l=n.length;e<l;e++)0!==parseInt(n[e])&&(p[q[e]]=!0,p[q[e]+"Value"]=parseInt(n[e]));a.each(o,function(a){new b(a,p)})}}}),d.selector=".tshop-pbsm-shop-item-pre-recommend",d},{requires:["wangpu/decoration/compatible"]});KISSY.add("modules/shop/self-defined/index",function(a){function b(a){var b=this;b._mod=a.mod,b._mod&&b._init()}var a=KISSY,c=a.Event,d=a.DOM,e=document;return a.augment(b,{_init:function(){a.log("TshopPbsmShopSelfDefined init start");var b=this;b._initFilter(),b._initBanner(),a.log("TshopPbsmShopSelfDefined init end")},_initFilter:function(){var b,d,f=this,g="\u60a8\u9009\u4e2d\u7684\u5185\u5bb9\u53ef\u80fd\u6709\u5b89\u5168\u9690\u60a3,\u8bf7\u8c28\u614e\u4f7f\u7528! ",h=f._mod,i=e.createElement("div"),j="<.+(?:",k=").+>",l="\\s*",m=/[\r\n]+/g,n=[["display","none"],["visibility","hidden"],["width","0"],["text-indent","-\\d{3,}"]],o=[];a.each(n,function(a){o.push(a[0]+l+":"+l+a[1])}),b=j+o.join("|")+k,d=new RegExp(b,"mi"),c.on(h,"copy",function(a){var b,c;window.getSelection?b=window.getSelection():e.selection&&(b=e.selection.createRange()),c=b.htmlText||b.getRangeAt(0).cloneContents(),"string"!=typeof c&&(i.appendChild(c),c=i.innerHTML),c=c.replace(m,""),d.test(c)&&(alert(g),a.halt()),i.innerHTML=""})},_initBanner:function(){var b=d.get(".J_TBannerMaker",this._mod);if(b){var c=d.attr(b,"data-jsurl");c&&a.getScript(c,function(){BM&&BM.getURL(function(a){d.attr(b,"src",a)})})}}}),b.selector=".tshop-pbsm-shop-self-defined",b});KISSY.add("modules/shop/srch-inshop/index",function(a){function b(b){var e=d.get(b.mod);if(e){a.log("TshopPbsmShopSrchInshop init start");var f=d.get(".J_TKeyword",e),g=d.query(".J_TCheckPrice",e),h=d.query(".J_TSubmitBtn",e);c.on(f,"focus",function(a){var b=a.target;d.removeClass(b,"prompt"),d.val(b,"")}),c.on(g,"keyup",function(a){var b=/\D/g,c=a.target,e=d.val(c);d.val(c,e.replace(b,""))}),c.on(h,"click",function(a){var b=a.currentTarget,c=d.parent(b,"form");c.submit()}),a.log("TshopPbsmShopSrchInshop init end")}}var a=KISSY,c=a.Event,d=a.DOM;return b.selector=".tshop-pbsm-shop-srch-inshop",b});KISSY.add("modules/shop/top-list/index",function(a,b){function c(a){var b=this;b._mod=a.mod,b._mod&&(b.collectLoaded=!1,b.tabItems=[],b.tabItems[0]=e.parent(e.get(".J_CollectTab",b._mod),"li"),b.tabItems[1]=e.parent(e.get(".J_SaleTab",b._mod),"li"),b.panels=[],b.panels[0]=e.get("div.collection",b._mod),b.panels[1]=e.get("div.sale",b._mod),b.showMoreBtns=[],b.showMoreBtns[0]=e.get(".hotkeep_desc",b._mod),b.showMoreBtns[1]=e.get(".hotsell_desc",b._mod),b._init())}var a=KISSY,d=a.Event,e=a.DOM;a.all;return a.augment(c,{_init:function(){a.log("TshopPbsmShopTopList init start");var b=this;b.topLists=e.query(c.selector),b.rIndex=a.indexOf(b._mod,b.topLists),b.idx=0,b._renderPanels(),b._bindEvent(),a.log("TshopPbsmShopTopList init end")},_renderPanels:function(){function b(){a.each(c.panels,function(a){e.addClass(a,"disappear")}),a.each(c.showMoreBtns,function(a){e.addClass(a,"disappear")})}var c=this,d=!1;a.each(c.tabItems,function(a,f){e.hasClass(a,"selected")&&(d=!0,b(),e.removeClass(c.panels[f],"disappear"),e.removeClass(c.showMoreBtns[f],"disappear"),c.idx=f,e.hasClass(a,"J_Collect")&&c._initCollectBox(e.attr(a,"data-geturl")))}),0==d&&(e.addClass(c.tabItems[0],"selected"),b(),e.removeClass(c.panels[0],"disappear"),e.removeClass(c.showMoreBtns[0],"disappear"),c.idx=0)},_initCollectBox:function(c){var d=this,c=c+"&jsoncallback=window.shop.rankCallback&index="+d.rIndex;e.html(d.panels[0],'<img class="loading-img" src="//img.alicdn.com/tps/i2/T16WJqXaXeXXXXXXXX-32-32.gif" />'),d.collectLoaded=!0,window.shop=window.shop||{},window.shop.rankCallback=function(c){if(void 0!=c.index){var f=d.topLists[c.index],g=e.get(".collection",f),h='<li class="{{odd_even}} {{is_first_last}}"><div class="ranking"><span>{{idx}}</span></div><div class="more"><a target="_blank" href="{{linkUrl}}"><img class="hover-show" src="{{imgUrl}}_120x120.jpg"></a></div><div class="img"><a href="javascript:void(0);"><img  class="hover-show" src="{{imgUrl}}_120x120.jpg" alt="\u5546\u54c1\u56fe\u7247"></a></div><div class="detail"><p class="desc"><a href="{{linkUrl}}" title="{{productName}}" target="_blank">{{productName}}</a></p><p class="price"><span class="symbol">&yen;</span><span >{{price}}</span></p><p class="sale">\u5df2\u6536\u85cf<span class="sale-count">{{sellOffCount}}</span>\u7b14</p></div></li>',i="<ul>";a.each(c.items,function(a,d){var e="";0==d?e="first":d==c.items.length-1&&(e+="last"),i+=b(h).render({odd_even:d%2==0?"even":"odd",idx:d+1,linkUrl:a.link,imgUrl:a.imageUrl,price:(parseInt(100*a.price)/100).toFixed(2),productName:a.title,sellOffCount:a.collectorCount,is_first_last:e})}),i+="</ul>",e.html(g,i)}},a.getScript(c)},_bindEvent:function(){var b=this;a.each(b.tabItems,function(a,c){d.on(a,"mouseover",function(d){b.idx!=c&&(b.idx=c,e.toggleClass(b.tabItems[0],"selected"),e.toggleClass(b.tabItems[1],"selected"),e.toggleClass(b.panels[0],"disappear"),e.toggleClass(b.panels[1],"disappear"),e.toggleClass(b.showMoreBtns[1],"disappear"),e.toggleClass(b.showMoreBtns[1],"disappear"),e.hasClass(a,"J_Collect")&&b.collectLoaded===!1&&b._initCollectBox(e.attr(a,"data-geturl")))})});var c=setTimeout(function(){}),f=setTimeout(function(){}),g=10,h=100,i=null,j=setTimeout(function(){}),k=null;d.on(b._mod,"mouseover mouseout",function(a){var b=a.target;"mouseover"==a.type?("IMG"==b.tagName&&(clearTimeout(f),c=setTimeout(function(){var a=e.parent(b,"LI");e.removeClass(i,"show-more"),e.addClass(a,"show-more"),i=a},g)),("LI"==b.tagName||e.parent(b,"LI"))&&(clearTimeout(j),e.removeClass(k,"hover"),k="LI"==b.tagName?b:e.parent(b,"LI"),e.addClass(k,"hover"))):"mouseout"==a.type&&("IMG"==b.tagName&&(clearTimeout(c),f=setTimeout(function(){var a=e.parent(b,"LI");e.removeClass(a,"show-more")},h)),("LI"==b.tagName||e.parent(b,"LI"))&&(j=setTimeout(function(){e.removeClass(k,"hover")},50)))})}}),c.selector=".tshop-pbsm-shop-top-list",c},{requires:["wangpu/gallery/template"]});KISSY.add("modules/shop/ww-hover/index",function(S,Cookie,Compatible){function TshopPsmShopWwHover(a){var b=this;b._mod=a.mod,b._mod&&b._init()}var Event=S.Event,DOM=S.DOM,Node=S.Node,Anim=S.Anim,UA=S.UA,doc=document,docBody=doc.body,isIE6=6===UA.ie,isShop=window.shop_config?!0:!1,isDaily=!!(location.host.indexOf("daily.")>=0);return S.augment(TshopPsmShopWwHover,{_init:function(){S.log("TshopPsmShopWwHover init start");var a=this;a.isOldWW=DOM.get(".first-block",a._mod),a._setPosForDetail(),a._bindHover(),a._top(),a._dealWW(),a._dealSignin(),a._dealScroll(),a._dealScrollForDetail(),S.log("TshopPsmShopWwHover init end")},_dealSignin:function(){function a(b){d--<0||("complete"==document.readyState?b():setTimeout(function(){a(b)},100))}var b=this,c=DOM.get(".J_Signin",b._mod),d=100;c&&window.shop_config&&a(function(){var a=DOM.get("a",c),b=a.href,d=DOM.val("#J_TokenField");S.use("modules/component/taojinbi/",function(e,f){var g=new f({sellerId:shop_config.userId,token:d,shopUrl:"//"+location.host});g.getActStatus(function(d){d&&d.sign&&(window.login_config&&login_config.loginUserId?g.isSign(function(d){d&&d.has_signed&&(DOM.addClass(c,"signed"),a.href=b.replace(/(&|\?)signin=true/i,"$1")),DOM.show(c)}):DOM.show(c))})})})},_fixedForIE6:function(){if(isIE6);},_setPosForDetail:function(){function a(){var a=DOM.offset(c).left+d+10;DOM.css(b._mod,{left:a})}if(!isShop){var b=this,c=DOM.get("#detail"),d=DOM.width(c);c&&(a(),DOM.show(b._mod),Event.on(window,"resize",S.buffer(a,100)))}},_bindHover:function(){var a=this,b=DOM.get(".skin-box-bd",a._mod),c=DOM.get(".WW",a._mod),d=DOM.query(".img",DOM.get(".skin-box-hd",this._mod));Event.on([c,b],"mouseenter",function(){if((!a.onlyMainWW||isShop)&&DOM.css(b,"display"," block"),!a.isSetBDPos){var d=DOM.offset(c).top+DOM.height(c)/2,e=DOM.height(b);DOM.offset(b,{top:d-e/2}),a.isSetBDPos=!0}S.later(function(){(!a.onlyMainWW||isShop)&&DOM.css(b,"display","block")},300)}),Event.on([c,b],"mouseleave",function(){S.later(function(){a.hideWW(),DOM.css(b,"display","none")},300)}),Event.on(d,"mouseenter",function(a){DOM.addClass(a.currentTarget,"hover")}),Event.on(d,"mouseleave",function(a){DOM.removeClass(a.currentTarget,"hover")})},_top:function(){var a=this,b=DOM.get(".toTop",a._mod);Event.on(b,"click",function(a){a.halt(),DOM.scrollTop(0)})},_dealWW:function(){var self=this,uls=Node.all(".wws",self._mod),node=uls.item(uls.length-1),tempwangwang,templi,tempdesc,api="//amos.alicdn.com/",config="groupid=0&v=2&site=cntaobao&s=1&charset=utf-8&uid=",url=node.attr("data-url"),nick=node.attr("data-nick"),gnick=node.attr("data-gnick"),groupIdFilter=node.attr("data-group-filter").split("@_@"),wwContent=DOM.get(".skin-box-bd",self._mod);node.children().innerHTML=null,""!=url&&S.getScript(url,function(){try{var groups=eval("("+groupMember+")").groups}catch(err){var groups=""}var showMainWW=function(){DOM.css(DOM.query(".service-block",wwContent)[1],"display","none"),self.onlyMainWW=!0};if(isShop||(self.onlyMainWW=!0),""!=groups&&groups.group&&groups.group.length&&""!=groupIdFilter[0]){var groupMembers=groups.group,count=0;if(S.each(groupMembers,function(a,b){(S.inArray(groupMembers[b].groupId.toString(),groupIdFilter)||"all"==groupIdFilter[0])&&(templi=DOM.create("<li>",{"class":"group"}),tempdesc=DOM.create("<span>",{"class":"groupname"}),DOM.html(tempdesc,groupMembers[b].groupName),tempwangwang=DOM.create("<a>",{href:api+"getcid.aw?v=3&uid="+gnick+"&site=cntaobao&groupid="+groupMembers[b].groupId+"&s=1&charset=gbk&fromid=cntaobao"+(S.Cookie.get("_nk_")?S.fromUnicode(S.Cookie.get("_nk_")):""),target:"_blank"}),tempwangwang.appendChild(DOM.create("<img>",{src:api+"grponline.aw?v=3&uid="+gnick+"&site=cntaobao&gids="+groupMembers[b].groupId+"&s=1",alt:"\u70b9\u51fb\u8fd9\u91cc\u7ed9\u6211\u53d1\u6d88\u606f"})),templi.appendChild(tempdesc),DOM.insertAfter(tempwangwang,tempdesc),node.append(templi),count++)}),count){self.onlyMainWW=!1,DOM.addClass(self._mod,"has-group"),self.hideWW();var moreWW=DOM.get(".more-WW",self._mod),allWW=DOM.query(".group",self._mod);allWW.length>5&&(Event.on(moreWW,"click",function(){DOM.css(moreWW,"display","none");for(var a=5;a<allWW.length;a++)DOM.css(allWW[a],"display","block")}),Event.on(moreWW,"mouseenter",function(){DOM.addClass(moreWW,"more-WW-hover")}),Event.on(moreWW,"mouseleave",function(){DOM.removeClass(moreWW,"more-WW-hover")}))}else showMainWW()}else showMainWW()})},_dealScroll:function(){function a(){var a=DOM.scrollTop(),c=DOM.viewportHeight();DOM.css(b._mod,{top:a+c-300})}var b=this,c=(DOM.get(".WW",b._mod),DOM.get(".toTop",b._mod)),d=DOM.get(".suggestion",b._mod),e=DOM.get(".item-qr",b._mod),f=window,g=!1;Event.on(f,"scroll",function(){DOM.scrollTop()>=window.screen.height&&!g?(c&&DOM.removeClass(c,"tb-scrolling"),d&&DOM.removeClass(d,"tb-scrolling"),e&&DOM.removeClass(e,"tb-scrolling"),g=!0):DOM.scrollTop()<window.screen.height&&g&&(c&&DOM.addClass(c,"tb-scrolling"),d&&DOM.addClass(d,"tb-scrolling"),e&&DOM.addClass(e,"tb-scrolling"),g=!1)}),isIE6&&Event.on(f,"scroll",S.buffer(a,100))},_dealScrollForDetail:function(){if(!isShop&&!isIE6&&window.DT){var a=this;DT.Messenger.on("ui:tabbar:unstick",function(){var b=DOM.viewportHeight()-DOM.height(a._mod)-55;DOM.css(a._mod,{top:"auto",bottom:b}),S.later(function(){Anim(a._mod,{bottom:300},.3,"ease").run()},0)}),DT.Messenger.on("ui:tabbar:stick",function(){var b=DOM.css(a._mod,"top");DOM.css(a._mod,{top:b}),S.later(function(){Anim(a._mod,{top:55},.3,"ease").run()},0)})}},hideWW:function(){var a=this,b=DOM.get(".more-WW",a._mod),c=DOM.query(".group",a._mod);if(c.length>5){for(var d=5;d<c.length;d++)DOM.css(c[d],"display","none");DOM.css(b,"display","block")}}}),TshopPsmShopWwHover.selector=".tshop-psm-shop-ww-hover",TshopPsmShopWwHover},{requires:["cookie"]});KISSY.add("modules/shop/srch-list/index",function(a,b,c){function d(a){var b=this;b._mod=a.mod,b._mod&&b._init(b._mod)}var e=a.Event,f=a.DOM;return a.augment(d,{_init:function(b){var c=this;a.log("TshopPbsmShopSrchList init start"),f.get("#J_ShopAsynSearchURL")?c._asynSearch(function(){c._initMods(b)}):c._initMods(b),a.log("TshopPbsmShopSrchList init end")},_asynSearch:function(b){a.io(c({dataType:"jsonp",url:f.get("#J_ShopAsynSearchURL").value,success:function(a){f.get("#J_ShopSearchResult").innerHTML=a,b()}},{style:"taobao"}))},_initMods:function(a){var b=this;b._bindEvt(a),b._bindWidgetEvt(a),b._fixHover(a)},_bindEvt:function(a){e.delegate(a,"click",".x-more",function(a){var b=a.currentTarget,c=f.parent(b,"tr"),d=f.query("li",c);if(d.length>6)for(var e=6;e<d.length;e++)f.toggleClass(d[e],"disappear");f.toggleClass(f.get(".xmore-icon",b),"part"),f.toggleClass(f.query(".xmore-text",b),"disappear")}),e.delegate(a,"click",".more",function(a){var b=(a.currentTarget,f.query("tr",f.get(".J_AttrBox")));if(b.length>3)for(var c=3;c<b.length;c++)f.toggleClass(b[c],"disappear");f.toggleClass(".more-icon","part"),f.toggleClass(".more-text","disappear")})},_bindWidgetEvt:function(c){var d,e,g=f.query(".J_TWidget",c);a.each(g,function(c){d=c.getAttribute("data-widget-type"),e=c.getAttribute("data-widget-config"),e=e.replace(/'/g,'"'),e=a.JSON.parse(e),new b[d](c,a.merge(e,{lazyDataType:"img-src"}))})},_fixHover:function(b){var c=".item-wrap",d="item-wrap-hover",g=a.UA.ie;g&&6===g&&(e.delegate(b,"mouseenter",c,function(a){f.addClass(this,d)}),e.delegate(b,"mouseleave",c,function(a){f.removeClass(this,d)}))}}),d.selector=".tshop-pbsm-shop-srch-list",d},{requires:["wangpu/gallery/switchable","sd/data_sufei/sufei"]});KISSY.add("modules/shop/coupon/index",function(a,b,c){function d(a){var b=this;b._mod=a.mod,b._mod&&b._init()}var a=KISSY,e=a.DOM,f=a.Event;return a.augment(d,{_init:function(){a.log("TshopPbsmShopCoupon init start"),this._pngInit(),this._bindEvt(),a.log("TshopPbsmShopCoupon init end")},_pngInit:function(){var b=this;a.UA.ie&&a.UA.ie<7&&(a.each(e.query(".item,.icon",b._mod),function(a){new c(a,{png:!0,png_bg:!0})}),a.each(e.query("img",b._mod),function(a){new c(a,{png:!0,png_tag:!0}),e.css(e.parent(a),"display","none")}))},_bindEvt:function(){var c=this,d=e.query(".item",c._mod);a.each(d,function(d){var g=e.attr(d,"data-url")+"&applySource=shop",h="<iframe style='border:none;height:100%;width:100%' src="+g+">";f.on(d,"mouseenter",function(){e.css(e.get(".item-hover",d),"display","block")}),f.on(d,"mouseleave",function(){e.css(e.get(".item-hover",d),"display","none")}),f.on(d,"click",function(d){var f=d.target;e.hasClass(f,"situation")||(c.getCoupon&&c.getCoupon.destroy(),c.getCoupon=new b.Dialog({content:h,zIndex:1e8,elCls:"ds-getCoupon",elStyle:{position:6==a.UA.ie?"absolute":"fixed"},align:{points:["cc","cc"]},closeAction:"destroy"}),c.getCoupon.render(),c.getCoupon.show())})})}}),d.selector=".tshop-pbsm-shop-coupon",d},{requires:["overlay","wangpu/decoration/compatible"]});"use strict";KISSY.add("modules/shop/double-row-img/index",function(a,b){function c(a){this._mod=a.mod,this._mod&&this._init()}var d=a.all,e=".tshop-pbsm-shop-double-row-img";return a.augment(c,{_init:function(){a.log("TshopPsmShopDoubleRowImg init start"),this.container=d(e),a.log("TshopPsmShopDoubleRowImg init end")}}),c.selector=e,c},{requires:["node"]});KISSY.add("modules/base/common/index",function(a,b,c){var d={getVdata:function(a){if(window.login_config)return a(null,window.login_config);var d=new c(location.href).getQuery(),e={mockDate:d.get("mockDate"),isAudit:d.get("isAudit")};b({type:"get",data:e,dataType:"jsonp",url:"/i/vdata.htm?"+location.search.substr(1),success:function(b){return window.login_config=b,a(null,b)}})}};return d},{requires:["io","uri"]}),KISSY.add("modules/shop/promotion-red-envelope/coupon/index",function(a,b){function c(a){var b=this;b.config=a,b.type=a.type?a.type:"hongbao",b.activityId=a.activityId,b.showItems=void 0!=a.showItems?a.showItems:!0,b.sellerId=a.sellerId,b.daily=void 0!=a.daily?a.daily:!1,b.applyChannel=a.applyChannel,b.isShop=a.isShop?!0:!1,b.token=a.token?a.token:"";var c="taoquan.taobao.com";b.daily&&(c="taoquan.daily.taobao.net"),"hongbao"==b.type?(b.cburl=a.cburl,b.applyUrl="//"+c+"/coupon/shopbonus/buyer_share_apply.htm"):b.applyUrl="//"+c+"/coupon/itemCoupon/item_coupon_promotion_apply.htm",b.init()}var a=KISSY,d=a.DOM,e=a.Event,f=function(a){return this instanceof f?(a=a||{},this.cburl=a.cburl,this.daily=!!a.daily,this.from=a.from,f.__INSTANCE__=this,this.available=!0,void this._init()):new f(a)};return a.augment(f,e.Target,{_init:function(){return a.namespace("Member.Weibo",!0),window.Member.Weibo.Bind=f,this.from&&this.cburl&&0===this.cburl.indexOf(window.location.protocol+"//"+window.location.host)?void(this.url="//member1."+(this.daily?"daily.taobao.net":"taobao.com")+"/member/fresh/weibo_bind_management.htm"):(this.available=!1,this.fire("failure"),void alert("ERROR: no from/cburl param or domain not match."))},show:function(){return this.available?(this.o=new b.Dialog({prefixCls:"applyCoupon-",width:400,headerContent:"\u9886\u53d6\u7ea2\u5305\u9700\u8f6c\u53d1\u6d3b\u52a8\u5fae\u535a",bodyContent:'<iframe src="'+this.url+"?cburl="+this.cburl+"&from="+this.from+'" style="display:block;width:400px;height:355px;" scrolling="no" frameborder="0" allowtransparency="true"></iframe>',closable:!0,closeAction:"destroy",mask:!1,zIndex:1e9}),this.o.render(),this.o.center(),this.o.get("el").all(".applyCoupon-ext-close-x").html("\xd7"),this.o.show(),this._bindEvent(),this):this},hide:function(){return this.available?(this.o&&this.o.destroy(),this.o=null,this.fire("hide"),this):this},_bindEvent:function(){this.on("success failure",function(){this.hide()},this),this.o&&this.o.on("hide",function(){this.fire("hide"),this.fire("destroy")},this)}}),window.location.href.indexOf("jiyoujia.com")>-1?loHref="//shop"+shop_config.shopId+".taobao.com/dc-3773.htm":loHref=location.href,a.augment(c,e.Target,{init:function(){var a=this,b=!1;if(-1==loHref.indexOf("taobao"))b=!0;else{var c=function(a){var b,c;return(c=String(document.cookie).match(new RegExp("(?:^| )"+a+"(?:(?:=([^;]*))|;|$)")))&&(b=c[1]?decodeURIComponent(c[1]):""),b};b=!!(c("_l_g_")&&c("_nk_")||c("ck1")&&c("tracknick")||c("lgc"))}a.initLogin(b)},normalize:function(a){var b=this;return a=b.daily?a.replace("a.tbcdn.cn","assets.daily.taobao.net").replace("taobao.com","daily.taobao.net"):a.replace("assets.daily.taobao.net","a.tbcdn.cn").replace("daily.taobao.net","taobao.com")},initLogin:function(b){var c=this;if(0==b){goldlog&&goldlog.send("//ga.mmstat.com/tbtwlact.2.2",{});var f=c.normalize("//login.taobao.com/member/login.jhtml?style=mini&is_ignore=false&full_redirect=true"),g='<div class="sns-login-content"><div class="sns-login-wrap"><div class="sns-login-title">\u6dd8\u5b9d\u4f1a\u5458</div><iframe width="330" height="285" frameborder="0"scrolling="no" src="'+f+'&redirect_url={redirectUrl}"></iframe></div><s style="display:{closeBtn}" class="sns-close-btn">&times;</s></div>',h=".sns-close-btn {    color:#9c9c97;    text-decoration:none;    font-size:22px;    position:absolute;    right:12px;    top:5px;    cursor:pointer;}.sns-popup-login { position:absolute;}.sns-login-content {   border-radius: 3px; border:3px solid #d5d5d5; background-color:#FAFAFA;}.sns-login-wrap {   width: 330px;    border: 1px solid #aaa;   overflow: hidden; }.sns-login-title {   background: #f2f2f2;   height: 35px;   line-height: 35px;   font-size: 14px;   font-weight: 700;   color: #000;   padding-left: 15px;   margin-bottom: 25px;}";d.addStyleSheet(h);var i=new a.Overlay({elCls:"sns-popup-login",content:a.substitute(g,{closeBtn:"block",redirectUrl:encodeURIComponent(loHref)}),zIndex:1e9,mask:!1,align:{node:null,points:["cc","cc"],offset:[0,0]}});i.render(),i.show();var j;j=a.isFunction(i.get)?i.get("el").getDOMNode():i.container,e.on(d.get(".sns-close-btn",j),"click",function(){i.destroy()})}else a.io({url:c.applyUrl,data:{activityId:c.activityId,sellerId:c.sellerId,applyChannel:c.applyChannel},cache:!1,dataType:"jsonp",success:function(a){if(c.shopUrl=a.shopUrl,c.shopName=a.shopName,c.amount=a.amount,c.startTime=a.startTime,c.endTime=a.endTime,c.startFee=a.startFee,c.discount=a.discount,c.activeCenter=a.activeCenter,"true"==a.success)c.renderPop(a);else{if("NOT_LOGIN"==a.code)return void c.initLogin(!1);if("NOT_BIND_WEIBO"==a.code)return void c.weiboBind();if("SHARE_WEIBO"==a.code)return void c.share();if("PARAM_VALID"==a.code)return void alert(a.msg);"APPLY_ERROR"==a.code&&c.renderPop(a)}}})},weiboBind:function(){goldlog&&goldlog.send("//ga.mmstat.com/tbtwlact.2.3",{});var a=this;f({cburl:a.cburl,daily:a.daily,from:"sns"}).show().on("success",function(){a.share(),goldlog&&goldlog.send("//ga.mmstat.com/tbtwlact.2.8",{})}).on("failure",function(){goldlog&&goldlog.send("//ga.mmstat.com/tbtwlact.2.8",{})})},_getValue:function(b){var c=a.trim(d.attr(b,"placeholder")),e=a.trim(b.value),f=d.attr(b,"maxlength");return c===e?"":f&&e>=f?e.substr(0,f):e},encodeGBK:function(a){function b(a){return a?window.ActiveXObject?(execScript('SetLocale "zh-cn"',"vbscript"),a.replace(/[\d\D]/g,function(a){return window.vbsval="",execScript('window.vbsval=Hex(Asc(" '+a+'"))',"vbscript"),"%"+window.vbsval.slice(0,2)+"%"+window.vbsval.slice(-2)})):(c.src="//www.atpanel.com/jsclick?globaljs=1&separator="+a,c.src.split("&separator=").pop()):""}var c=document.createElement("img");return a.replace(/([^\x00-\xff]+)|([\x00-\xff]+)/g,function(a,c,d){return b(c)+encodeURIComponent(d||"")})},share:function(){goldlog&&goldlog.send("//ga.mmstat.com/tbtwlact.2.1",{});var c=this,d=a.Cookie.get("_nk_")||a.Cookie.get("lgc");void 0!=d&&(d=a.fromUnicode(d)),c.shopName||(c.shopName="");var e='<div class=\'apply-coupon-content clearfix\'><div class="sns-content">\n<div class="article">\n    <div class="selected">\n        <span class="title">\u540c\u6b65\u5230:</span>\n        <i class="i-sina"></i>\n    </div>\n    <div class="item">\n        <div class="share-ipt">\n            <div class="user">\n                <img src="//wwc.taobaocdn.com/avatar/getAvatar.do?userNick='+c.encodeGBK(d).toLowerCase()+'&width=80&height=80&type=sns" width="40" height="40">\n                <span class="user-nick">'+d+'</span>\n            </div>\n            <div class="entry">\n                <textarea maxlength="140" class="J_SnsShareComment">#1212\u5e97\u94fa\u7ea2\u5305\u5927\u6d3e\u9001#\u8f7b\u8f7b\u677e\u677e\u5c31\u9886\u5230'+c.amount+"\u5757\u94b1\uff0c\u597d\u55e8\u68ee\uff01\uff01\u4f60\u60f3\u8981\u5417\uff1f"+c.shopName+'\u5e97\u94fa\u6b63\u5728\u53d1\u7ea2\u5305\uff0c\u5c0f\u4f19\u4f34\u4eec\u90fd\u62a2\u75af\u4e86\uff0c\u518d\u4e0d\u53bb\u5c31\u6ca1\u5566\uff01</textarea>\n            </div>\n            <p class="count hidden">\u8fd8\u53ef\u4ee5\u8f93\u5165 <em class="J_Count">135</em> \u4e2a\u5b57</p><s></s></div>\n    </div>\n</div>\n<div class="sns-share-widget-footer">\n    <div class="operate">\n        <a class="continue J_Continue J_Submit" href="">\u7acb\u5373\u5206\u4eab</a>\n        <a class="cancel J_Cancel J_Close" href="">\u53d6\u6d88</a>\n    </div>\n    <div class="J_ExtraInfo extra-info"></div>\n</div>\n</div></div>';c.amount||(e='<div class=\'apply-coupon-content clearfix\'><div class="sns-content">\n<div class="article">\n    <div class="selected">\n        <span class="title">\u540c\u6b65\u5230:</span>\n        <i class="i-sina"></i>\n    </div>\n    <div class="item">\n        <div class="share-ipt">\n            <div class="user">\n                <img src="//wwc.taobaocdn.com/avatar/getAvatar.do?userNick='+c.encodeGBK(d).toLowerCase()+'&width=80&height=80&type=sns" width="40" height="40">\n                <span class="user-nick">'+d+'</span>\n            </div>\n            <div class="entry">\n                <textarea maxlength="140" class="J_SnsShareComment">#1212\u5e97\u94fa\u7ea2\u5305\u5927\u6d3e\u9001#\u8f7b\u8f7b\u677e\u677e\u5c31\u9886\u5230\u7ea2\u5305\uff0c\u597d\u55e8\u68ee\uff01\uff01\u4f60\u60f3\u8981\u5417\uff1f'+c.shopName+'\u5e97\u94fa\u6b63\u5728\u53d1\u7ea2\u5305\uff0c\u5c0f\u4f19\u4f34\u4eec\u90fd\u62a2\u75af\u4e86\uff0c\u518d\u4e0d\u53bb\u5c31\u6ca1\u5566\uff01</textarea>\n            </div>\n            <p class="count hidden">\u8fd8\u53ef\u4ee5\u8f93\u5165 <em class="J_Count">135</em> \u4e2a\u5b57</p><s></s></div>\n    </div>\n</div>\n<div class="sns-share-widget-footer">\n    <div class="operate">\n        <a class="continue J_Continue J_Submit" href="">\u7acb\u5373\u5206\u4eab</a>\n        <a class="cancel J_Cancel J_Close" href="">\u53d6\u6d88</a>\n    </div>\n    <div class="J_ExtraInfo extra-info"></div>\n</div>\n</div></div>');var f=new b.Dialog({prefixCls:"applyCoupon-",zIndex:1e9,mask:!1,headerContent:"\u9886\u53d6\u7ea2\u5305\u9700\u8f6c\u53d1\u6d3b\u52a8\u5fae\u535a",bodyContent:e,closeable:!0,closeAction:"destroy"});f.render(),f.get("el").all(".applyCoupon-ext-close-x").html("\xd7"),f.center(),f.show(),f.get("el").one("textarea").on("focus",function(b){a.all(b.target).css("color","#000")}),f.get("el").one("textarea").on("blur",function(b){a.all(b.target).css("color","#999")}),c._maxlength(f.get("el").getDOMNode()),f.get("el").one(".J_Close").on("click",function(a){a.preventDefault(),goldlog&&goldlog.send("//ga.mmstat.com/tbtwlact.2.7",{}),f.destroy()}),f.get("el").one(".applyCoupon-ext-close-x").on("click",function(a){goldlog&&goldlog.send("//ga.mmstat.com/tbtwlact.2.7",{})}),f.get("el").one(".J_Submit").on("click",function(b){b.preventDefault(),goldlog&&goldlog.send("//ga.mmstat.com/tbtwlact.2.6",{}),a.io({url:c.applyUrl,data:{activityId:c.activityId,sellerId:c.sellerId,applyChannel:c.applyChannel,title:encodeURIComponent("\u6dd8\u5b9d\u7f51\u53cc\u5341\u4e8c\u5e97\u94fa\u7ea2\u5305\u6d3b\u52a8"),comment:encodeURIComponent(c._getValue(f.get("el").all(".J_SnsShareComment").getDOMNode())),link:c.activeCenter},dataType:"jsonp",cache:!1,success:function(a){if(f.destroy(),"true"==a.success)goldlog&&goldlog.send("//ga.mmstat.com/tbtwlact.2.5",{activityId:c.activityId,sellerId:c.sellerId,applyChannel:c.applyChannel}),c.renderPop(a);else{if("PARAM_VALID"==a.code)return void alert(a.msg);"APPLY_ERROR"==a.code&&c.renderPop(a)}}})})},hasParam:function(a){return a.indexOf("?")>-1?a+"&":a+"?"},_maxlength:function(a){var b="maxLength"in document.createElement("textarea");if(!b){var c=a.getAttribute("maxlength");e.on(a,"valuechange",function(b){a.value.length>c&&(a.value=a.value.substring(0,c))})}},renderPop:function(c){var f=this,g="",h="",i='<div style="margin-top: 13px;color: #666;"><a class="J_close">\u786e \u5b9a</a>',j="";"hongbao"==f.type?(j="1223.1.10",goldlog&&goldlog.send("//ga.mmstat.com/tbtwlact.1.1",{})):(j="1223.2.10",goldlog&&goldlog.send("//ga.mmstat.com/tbtwlact.3.1",{}));var k='<div class="applyCouponResult"><div class="close">\xd7</div> <div class="results">';if("true"==c.success){goldlog&&goldlog.send("//ga.mmstat.com/shopcoupons.1.* ",{});var l=!1;if(f.fire("success"),k+=' <div class="label suc"></div>',c.startTime=c.startTime.slice(0,10).replace("-",".").replace("-","."),c.endTime=c.endTime.slice(0,10).replace("-",".").replace("-","."),"hongbao"==f.type){var m="";c.amount&&(m='<span class="red"><span class="money">\uffe5</span>'+c.amount+"</span>"),g="\u606d\u559c\uff0c\u60a8\u5df2\u6210\u529f\u9886\u53d6"+m+'\u5e97\u94fa\u7ea2\u5305\u3002<a target="_blank" href="//taoquan.taobao.com/framework/got_bonus.htm?scm=1223.1.10.1&tabIndex=5" style="font-size: 12px">\u67e5\u770b></a></div>',g+='<div class="date">\u4f7f\u7528\u65f6\u95f4\uff1a'+c.startTime+"-"+c.endTime+" \u5168\u5e97\u901a\u7528</div>",h="<div>"}else{var m="";c.startFee&&c.discount&&(m='<span class="red">\u6ee1'+c.startFee+"\u51cf"+c.discount+"\u5143</span>"),g="\u606d\u559c\uff0c\u60a8\u5df2\u6210\u529f\u9886\u53d6"+m+'\u5546\u54c1\u4f18\u60e0\u5238\u3002</div><div class="date">\u4f7f\u7528\u65f6\u95f4\uff1a'+c.startTime+"-"+c.endTime,c.shopUrl&&(g+='<a href="'+f.hasParam(c.shopUrl)+"scm="+j+'.4" target="_blank">\u67e5\u770b\u9002\u7528\u5b9d\u8d1d</a>'),g+="</div>"}l&&(i+='<span style="*vertical-align: bottom"><input checked="checked" class="J_collect" type="checkbox">\u6536\u85cf\u8be5\u5e97</span>')}else goldlog.send("//ga.mmstat.com/shopcoupons.2.* ",{}),k+='<div class="label fail"></div>',f.fire("fail"),g=c.msg+"</div>","hongbao"==f.type&&(h='<a target="_blank" href="//taoquan.taobao.com/framework/got_bonus.htm?scm=1223.1.10.1&tabIndex=5" style="font-size: 12px">\u67e5\u770b\u5df2\u9886\u5230\u7684\u5e97\u94fa\u7ea2\u5305></a>');i+="</div>","hongbao"!=f.type&&(!f.isShop&&c.activeCenter&&(g+='<div><a href="'+f.hasParam(c.activeCenter)+"scm="+j+'.1" target="_blank">\u67e5\u770b\u8be5\u5e97\u66f4\u591a\u4f18\u60e0</a></div>'),h=' <div>\u67e5\u770b\u5df2\u9886\u5546\u54c1\u4f18\u60e0\u5238\uff1a<a href="//taoquan.taobao.com/framework/got_bonus.htm?tabIndex=2&display=true&tabDomId=itemCouponTab&scm='+j+'.2" target="_blank">\u6211\u7684\u4f18\u60e0\u4fe1\u606f</a></div>'),k+=' <div class="result-text"><div class="result">'+g+'<div class="gray">'+h+" </div>"+i+"</div> </div> ",k+="</div>";var n=new b.Popup({prefixCls:"applyCoupon-",zIndex:1e9,mask:!1,content:k,closeable:!0,closeAction:"destroy"});n.render(),n.center(),n.show(),e.on(d.get(".close",n.get("el")),"click",function(a){n.destroy()}),e.on(d.get(".J_close",n.get("el")),"click",function(b){var e=d.get(".J_collect",n.get("el"));if(e&&d.prop(e,"checked")){var g;g=f.daily?"//favorite.daily.taobao.net/json/addCollectionForAll.htm":"//favorite.taobao.com/json/addCollectionForAll.htm",a.io({url:g,data:{shopId:c.shopId,favType:0},dataType:"jsonp",cache:"false"})}n.destroy()})}}),c},{requires:["overlay"]}),KISSY.add("modules/shop/promotion-red-envelope/index",function(a,b,c,d,e){function f(a){this._mod=a.mod,this._mod&&this._init()}var g=a.all,h=".tshop-pbsm-shop-promotion-red-envelope",i=/(taobao|tmall|jiyoujia)\.com/.test(location.host);return a.augment(f,{_init:function(){a.log("TshopPsmShopPromotionRedEnvelop init start"),this.container=g(this._mod),this.btn=this.container.one(".J_GetEnvelope"),this.btn&&(this.activityId=this.btn.attr("data-activity-id"),this.userId=window.shop_config.userId||window.shop_config.isvStat.userId,this._bindEvent(),a.log("TshopPsmShopPromotionRedEnvelop init end"))},_initBtnStatus:function(){var b=this,c=b.btn,d=(c.attr("data-start"),c.attr("data-end"),function(b){try{return"ing"}catch(c){return a.log(c,"error"),"error"}});b._getServerTime(function(b,e){if(b)return void a.log(b,"error");var f=d(e);"over"===f?c.html("\u5df2\u7ed3\u675f"):"will"===f?c.html("\u672a\u5f00\u59cb"):"error"===f?c.html("\u670d\u52a1\u5668\u5f02\u5e38"):c.addClass("active").html("\u7acb\u5373\u9886\u53d6")})},_bindEvent:function(){var a=this,b=a.btn;b.on("click",function(){b.hasClass("active")&&a._getBonus(function(a){})})},_getBonus:function(a){var b={type:"hongbao",activityId:this.activityId,sellerId:this.userId,daily:!i,applyChannel:1};new e(b).on("success",function(){a(null)}).on("fail",function(){a(new Error("\u9886\u53d6\u5931\u8d25\uff01"))})},_compareTime:function(b,c){if(b===c)return 0;var d=-1;return b=b.split("-"),c=c.split("-"),a.each(b,function(a,e){return Number(b[e])>Number(c[e])?(d=1,!1):Number(b[e])<Number(c[e])?(d=-1,!1):void 0}),d},_getServerTime:function(a){d.getVdata(function(b,c){a(null,c.currentTime)})}}),f.selector=h,f},{requires:["node","ajax","modules/base/common/index","./coupon/index"]});KISSY.add("modules/other/customer-service/index",function(S){function TshopPbsmOtherCustomerService(a){var b=this;b._mod=a.mod,b._mod&&b._init()}var S=KISSY,DOM=S.DOM,Node=S.Node;return S.augment(TshopPbsmOtherCustomerService,{_init:function(){S.log("TshopPbsmOtherCustomerService init start");var a=this;a._displayWWGroop(),S.log("TshopPbsmOtherCustomerService init end")},_displayWWGroop:function(){var self=this,tempwangwang,templi,tempdesc,api="//amos.alicdn.com/",config="groupid=0&v=2&site=cntaobao&s=1&charset=utf-8&uid=",uls=Node.all("ul.service-group",self._mod),node=uls.item(uls.length-1),url=node.attr("data-url"),nick=node.attr("data-nick"),gnick=node.attr("data-gnick"),groupIdFilter=node.attr("data-group-filter").split("@_@");node.children().innerHTML=null,""!=url&&S.getScript(url,function(){try{var groups=eval("("+groupMember+")").groups}catch(err){var groups=""}var showMainWW=function(){templi=DOM.create("<li>",{"data-wangwang":"mainwangwang"}),tempdesc=DOM.create("<span>",{"class":"groupname"}),DOM.html(tempdesc,"\u5ba2\u670d\u4e2d\u5fc3"),tempwangwang=DOM.create("<a>",{href:api+"getcid.aw?"+config+nick+"&fromid=cntaobao"+(S.Cookie.get("_nk_")?S.fromUnicode(S.Cookie.get("_nk_")):""),target:"_blank"}),tempwangwang.appendChild(DOM.create("<img>",{src:api+"online.aw?"+config+nick,alt:"\u70b9\u51fb\u8fd9\u91cc\u7ed9\u6211\u53d1\u6d88\u606f"})),templi.appendChild(tempdesc),DOM.insertAfter(tempwangwang,tempdesc),node.append(templi)};if(""!=groups&&groups.group&&groups.group.length&&""!=groupIdFilter[0]){var groupMembers=groups.group,count=0;S.each(groupMembers,function(a,b){(S.inArray(groupMembers[b].groupId.toString(),groupIdFilter)||"all"==groupIdFilter[0])&&(templi=DOM.create("<li>",{"class":"group"}),tempdesc=DOM.create("<span>",{"class":"groupname"}),DOM.html(tempdesc,groupMembers[b].groupName),tempwangwang=DOM.create("<a>",{href:api+"getcid.aw?v=3&uid="+gnick+"&site=cntaobao&groupid="+groupMembers[b].groupId+"&s=1&charset=gbk&fromid=cntaobao"+(S.Cookie.get("_nk_")?S.fromUnicode(S.Cookie.get("_nk_")):""),target:"_blank"}),tempwangwang.appendChild(DOM.create("<img>",{src:api+"grponline.aw?v=3&uid="+gnick+"&site=cntaobao&gids="+groupMembers[b].groupId+"&s=1",alt:"\u70b9\u51fb\u8fd9\u91cc\u7ed9\u6211\u53d1\u6d88\u606f"})),templi.appendChild(tempdesc),DOM.insertAfter(tempwangwang,tempdesc),node.append(templi),count++)}),count||showMainWW()}else showMainWW()})}}),TshopPbsmOtherCustomerService.selector=".tshop-pbsm-other-customer-service",TshopPbsmOtherCustomerService});KISSY.add("modules/other/guanliantuijian/index",function(S,Template){function TshopPbsmOtherGuanliantuijian(a){var b=a.mod;a.document;b&&!S.get(".guanliantuijian-preview")&&(S.log("TshopPbsmOtherGuanliantuijian init start"),this.pageType=this.checkPageType(),"design"!==this.pageType&&(this.box=Node.one(b),this.con=Node.one(DOM.get(".J_guanliantuijian",b)),this.bd=Node.one(DOM.get(".J_bd",b)),this.moduleRegion=Node.one(DOM.parent(b,".tb-module")),this.bdGrid=Node.one(DOM.get(".J_blocks",b)),this.tpl=Template(Node.one(DOM.get("textarea",b)).val()),this.data=void 0,this.moduleConfig=this.getModuleConfig(),this.fetch(),S.log("TshopPbsmOtherGuanliantuijian init end")))}var S=KISSY,Event=S.Event,DOM=S.DOM,Node=S.Node,GCfg={pageType:{design:"design",detail:"detail",other:"other"},moduleTitle:{view:"\u5927\u5bb6<b>\u770b</b>\u4e86\u4e4b\u540e\u4f1a\u4e70",buy:"\u5927\u5bb6<b>\u4e70</b>\u4e86\u4e4b\u540e\u8fd8\u4f1a\u4e70",same:"\u540c\u7c7b\u70ed\u9500\u5b9d\u8d1d"},APITpl:"//{host}/recommend?appid=1837&itemid={itemId}&count=5&style=h&types={type}",APIHost:location.href.indexOf("daily")>-1?"tui.daily.taobao.net":"tui.taobao.com"};return TshopPbsmOtherGuanliantuijian.prototype={fetch:function(){var a=this;S.IO({type:"get",url:this.getUrl(),success:function(b){a.dataHandle(b),a.render()},dataType:"jsonp",jsonp:"callback"})},dataHandle:function(a){var b=a.result||a.list,c=a.count.split(","),d=a.types.split(","),e=this.moduleConfig,f={blocks:[]},g=this;return S.each(d,function(a,d){var e={type:a,title:GCfg.moduleTitle[a],list:b.splice(0,parseInt(c[d]))};f.blocks.push(e)}),S.each(f.blocks,function(a){var b,c,d,f=/_160x160\.jpg$/;if(b=a.list){for(d=0;b[d];d++)c=b[d].pic,c&&"string"==typeof c&&(c=c.replace(/\s*/g,""),f.test(c)||(b[d].pic=c+"_160x160.jpg"));g.itemSort(b,e.sort)}}),this.data=f,f},itemSort:function(a,b){var c;switch(b){case"default":return;case"price":c="price";break;case"sales":c="sellCount";break;default:return}a.sort(function(a,b){return a[c]-b[c]})},render:function(){var a=this.data,b=this.box,c=0;try{for(var d=0;d<a.blocks.length;d++)c+=a.blocks[d].list.length}catch(e){return void S.log("guanliantuijian data error","error")}c>0?(this.bdGrid.html(this.tpl.render(a)),this.con.show()):DOM.addClass(DOM.parent(b,".box"),"hidden")},getLayoutWidth:function(){return this.moduleRegion?this.moduleRegion.width():0},checkPageType:function(){var a=location.origin;return a="detail.taobao.com",a.indexOf("design.taobao")>=0||a.indexOf("design.daily.taobao")>=0?GCfg.pageType.design:a.indexOf("item.taobao")>=0||a.indexOf("item.daily.taobao")>=0?GCfg.pageType.detail:GCfg.pageType.other},getModuleConfig:function(){return eval("("+this.con.attr("data-config")+")")},getUrl:function(){var a=g_config.idata.item.id,b=(g_config.idata.seller.id,g_config.idata.shop.id);return this.url=S.substitute(GCfg.APITpl,{host:GCfg.APIHost,itemId:a,shopId:b,type:this.moduleConfig.type}),this.url}},TshopPbsmOtherGuanliantuijian.selector=".tshop-pbsm-other-guanliantuijian",TshopPbsmOtherGuanliantuijian},{requires:["wangpu/gallery/template"]});KISSY.add("modules/other/recharge-center/index",function(a){function b(b){var h=this;if(h._mod=b.mod,h._mod&&d.attr("#J_RechargeData","data-value")){var i=a.JSON.parse(d.attr("#J_RechargeData","data-value")),j="\u53f7\u7801\u6709\u8bef,\u8bf7\u91cd\u65b0\u8f93\u5165",k="\u53f7\u7801\u4e0d\u4e00\u81f4,\u8bf7\u91cd\u65b0\u8f93\u5165",l="\u8bf7\u9009\u62e9\u9762\u503c",m="\u8d27\u7269\u6682\u7f3a",n="\u6b63\u5728\u5904\u7406\u8bf7\u7a0d\u540e\u2026\u2026",o="\u8d27\u7269\u6682\u7f3a\uff0c\u8d2d\u4e70\u5176\u4ed6",p="\u8bf7\u9009\u62e9\u76f8\u5e94\u4fe1\u606f",q={create:function(){"undefined"!=typeof localStorage?c=localStorage:g&&(c=f.createElement("input"),c.type="hidden",f.body.appendChild(c),c.addBehavior("#default#userData"))},set:function(a,b){if("setItem"in c)c.setItem(a,b);else if(g)try{c.setAttribute(a,b),c.save("IELocalDataStore")}catch(d){}},get:function(a){if("getItem"in c)return c.getItem(a);if(g)try{return c.load("IELocalDataStore"),c.getAttribute(a)}catch(b){}}},r=function(){this._catOpts=d.get("#J_GameCatId").options,this._parPriceOpts=d.get("#J_GameParPrice").options,this._catIndex=0,this._parPriceIndex=0,this._gameCatsInfo=new Array,this._gameItemsInfo=new Array,this._chargeType,this._selectedItemId,this._searchMore,this.init()};a.augment(r,{init:function(){this._initGameEvent(),i.showCard&&i.showGold?"card"==q.get("gameType")?(d.attr("#J_GameCard","checked","checked"),this._displayCatName("#J_GameCard")):"gold"==q.get("gameType")?(d.attr("#J_GameGold","checked","checked"),this._displayCatName("#J_GameGold")):d.attr("#J_GameCard","checked")?this._displayCatName("#J_GameCard"):d.attr("#J_GameGold","checked")?this._displayCatName("#J_GameGold"):(d.attr("#J_GameCard","checked","checked"),this._displayCatName("#J_GameCard")):i.showCard?this._requestCardCatsInfo():i.showGold&&this._requestQQCatsInfo()},_initGameEvent:function(){var a=this;d.get("#J_GameCard")&&d.get("#J_GameGold")&&(e.on("#J_GameCard","click",function(){a._msgToRecharge(),a._displayCatName(this)}),e.on("#J_GameGold","click",function(){a._msgToRecharge(),a._displayCatName(this)})),e.on("#J_GameCatId","change",function(){a._catIndex=this.selectedIndex,a._catChange()}),e.on("#J_GameParPrice","change",function(){a._parPriceIndex=this.selectedIndex,a._parPriceChange()}),e.on(f.gameCardForm,"submit",function(){return a._formValidate()?(1!==a._chargeType&&(2===a._chargeType&&d.val(f.gameCardForm.auto_post,"1"),d.val(f.gameCardForm.auto_post_1,"zhanghao"),f.gameCardForm.action=i.buyDomain+"/buy_now.htm"),a._rechargeToMsg(n,"dealing"),!0):!1})},_displayCatName:function(a){"J_GameCard"===d.attr(a,"id")?(q.set("gameType","card"),d.text("#J_GameCatName","\u6e38\u620f\uff1a"),this._requestCardCatsInfo()):(q.set("gameType","gold"),d.text("#J_GameCatName","\u79cd\u7c7b\uff1a"),this._requestQQCatsInfo())},_requestCardCatsInfo:function(){var b=this;a.io({dataType:"jsonp",url:i.storeDomain+"/shop/rechargeCenter.htm",data:{type:"game",game_type:"card",user_num_id:i.userNumId,sign:i.sign},success:function(a){b.getCardCats(a)}})},getCardCats:function(a){this._gameCatsInfo=a.cardIdNameInfos,this._fillCatOpts()},_requestQQCatsInfo:function(){var b=this;a.io({dataType:"jsonp",url:i.storeDomain+"/shop/rechargeCenter.htm",data:{type:"game",game_type:"qq",user_num_id:i.userNumId,sign:i.sign},success:function(a){b.getQQCats(a)}})},getQQCats:function(a){""==i.searchMoreQQUrl?this._gameCatsInfo=a.qqsInfo:this._gameCatsInfo=a.qqIdNameInfos,this._fillCatOpts()},_fillCatOpts:function(){var b=this._catOpts;this._recoveryCatOpts(),this._recoveryPrice(),this._gameCatsInfo.length>0&&a.each(this._gameCatsInfo,function(a){b[b.length]=new Option(a.alias,a.categoryId)})},_recoveryCatOpts:function(){this._catOpts.length=1,this._catIndex=0,d.hasClass("#J_GameCatId","prompt")||d.addClass("#J_GameCatId","prompt")},_recoveryPrice:function(){this._parPriceOpts.length=1,this._parPriceIndex=0,d.hasClass("#J_GameParPrice","prompt")||d.addClass("#J_GameParPrice","prompt"),d.text("#J_GameSalePrice","")},_catChange:function(){this._recoveryPrice(),this._catIndex>0?(d.hasClass("#J_GameCatId","prompt")&&d.removeClass("#J_GameCatId","prompt"),d.attr("#J_GameGold","checked")&&""==i.searchMoreQQUrl?(this._gameItemsInfo=this._gameCatsInfo[this._catIndex-1].gamePVList,this._fillParPriceOpts()):d.attr("#J_GameGold","checked")?this._requestQQItemsInfo():this._requestCardItemsInfo()):d.hasClass("#J_GameCatId","prompt")||d.addClass("#J_GameCatId","prompt")},_requestCardItemsInfo:function(){var b=this;a.io({dataType:"jsonp",url:i.storeDomain+"/shop/rechargeCenter.htm",data:{type:"game",game_type:"card",cat_id:b._catOpts[b._catIndex].value,user_num_id:i.userNumId,sign:i.sign},success:function(a){b._gameItemsInfo=a.cardsInfo,b._fillParPriceOpts()}})},_requestQQItemsInfo:function(){var b=this;a.io({dataType:"jsonp",url:i.storeDomain+"/shop/rechargeCenter.htm",data:{type:"game",game_type:"qq",pid_vid:b._catOpts[b._catIndex].value,user_num_id:i.userNumId,sign:i.sign},success:function(a){b._gameItemsInfo=a.qqsInfo,b._fillParPriceOpts()}})},_fillParPriceOpts:function(){var b=this._parPriceOpts;this._gameItemsInfo.length>0?(this._msgToRecharge(),a.each(this._gameItemsInfo,function(a){b[b.length]=new Option(a.parPrice,a.itemNumId)})):this._rechargeToMsg(o,"warning")},_parPriceChange:function(){var a=this._parPriceIndex;if(a>0){d.hasClass("#J_GameParPrice","prompt")&&d.removeClass("#J_GameParPrice","prompt");var b=this._gameItemsInfo[a-1];d.text("#J_GameSalePrice",b.salePrice),d.val(f.gameCardForm.sku_id,b.skuId),this._selectedItemId=b.itemNumId,this._chargeType=b.chargeType,this._isAutoRecharge(),this._msgToRecharge()}else d.text("#J_GameSalePrice",""),d.hasClass("#J_GameParPrice","prompt")||d.addClass("#J_GameParPrice","prompt")},_isAutoRecharge:function(){var b=this;1===b._chargeType&&a.getScript(i.buyDomain+"/buy.htm?from=tcc&item_id="+b._selectedItemId,{success:function(){window.loginIndicator&&(f.gameCardForm.action=window.loginIndicator.isFastBuy?i.buyDomain+"/buy_now.htm":i.buyDomain+"/fastbuy/fast_buy.htm")}})},_formValidate:function(){return 1==this._catOpts.length||this._catIndex>0&&1==this._parPriceOpts.length?(this._rechargeToMsg(o,"warning"),!1):this._catIndex&&this._parPriceIndex?!0:(this._rechargeToMsg(p,"warning"),!1)},_rechargeToMsg:function(a,b){d.text("#J_GameMsg",a),d.hasClass("#J_GameMsgBox",b)||("dealing"==b&&(d.hasClass("#J_GameMsgBox","warning")&&d.removeClass("#J_GameMsgBox","warning"),d.hasClass("#J_GameSubmit","hidden")||d.addClass("#J_GameSubmit","hidden")),d.addClass("#J_GameMsgBox",b)),d.hasClass("#J_GameMsgBox","hidden")&&d.removeClass("#J_GameMsgBox","hidden")},_msgToRecharge:function(){d.hasClass("#J_GameMsgBox","hidden")||d.addClass("#J_GameMsgBox","hidden")}});var s=function(a){this._telBoxType=190==d.width(d.parent(a))?"vt":"hz",this._telPanel=d.get(".tel-panel"),this._telSubbtn=d.get("#J_TelSubmit"),this._parPriceOpts=d.get("#J_TelParPrice").options,this._mobilesInfo=new Array,this._initTelEvent()};a.augment(s,{_initTelEvent:function(){var a=this;e.on("#J_TelInput","focus",function(){d.hasClass(this,"prompt")&&(d.val(this,""),d.removeClass(this,"prompt")),d.attr("#J_TelInputCfm","disabled")&&d.removeAttr("#J_TelInputCfm","disabled"),a._msgToRecharge()}),e.on("#J_TelInputCfm","focus",function(){d.hasClass(this,"prompt")&&(d.val(this,""),d.removeClass(this,"prompt"))}),e.on("#J_TelInput","paste",function(){return!1}),e.on("#J_TelInputCfm","paste",function(){return!1}),e.on("#J_TelInput","contextmenu",function(){return!1}),e.on("#J_TelInputCfm","contextmenu",function(){return!1}),e.on("#J_TelInput","keyup",function(){var a=/\D/g,b=d.val(this);d.val(this,b.replace(a,"")),d.val("#J_TelInputCfm")&&(d.val("#J_TelInputCfm","\u8bf7\u518d\u6b21\u8f93\u5165"),d.addClass("#J_TelInputCfm","prompt")),d.hasClass("#J_TelOperator","hidden")||d.addClass("#J_TelOperator","hidden")}),e.on("#J_TelInputCfm","keyup",function(){var a=/\D/g,b=d.val(this);d.val(this,b.replace(a,""))}),e.on("#J_TelInput","blur",function(){("1"!==d.val(this).charAt(0)||d.val(this).length<11)&&(a._rechargeToMsg(j,"warning"),d.attr("#J_TelInputCfm","disabled","disabled"))}),e.on("#J_TelInputCfm","blur",function(){d.val("#J_TelInput")!==d.val("#J_TelInputCfm")?a._rechargeToMsg(k,"warning"):a._msgToRecharge()}),e.on("#J_TelInputCfm","keyup",function(){11===d.val("#J_TelInputCfm").length&&(d.val("#J_TelInput")!==d.val("#J_TelInputCfm")?a._rechargeToMsg(k,"warning"):(a._msgToRecharge(),a._getOperators()))}),e.on("#J_TelParPrice","change",function(){var b=this.selectedIndex;b>0?(d.text("#J_TelSalePrice",a._mobilesInfo[b-1].salePrice),d.hasClass(this,"prompt")&&d.removeClass(this,"prompt"),a._mobilesInfo[b-1].auto?d.val("#J_TelMode","buynow/PhoneEcardBuyNowAction"):d.val("#J_TelMode","buynow/SmcMobileBuyNowDirectAction"),a._msgToRecharge()):(d.text("#J_TelSalePrice",""),d.hasClass(this,"prompt")||d.addClass(this,"prompt"))}),e.on(f.telForm,"submit",function(){return"1"!==d.val("#J_TelInput").charAt(0)||d.val("#J_TelInput").length<11?(a._rechargeToMsg(j,"warning"),!1):d.val("#J_TelInput")!==d.val("#J_TelInputCfm")?(a._rechargeToMsg(k,"warning"),!1):1==a._parPriceOpts.length?(a._rechargeToMsg(m,"warning"),!1):0===d.get("#J_TelParPrice").selectedIndex?(a._rechargeToMsg(l,"warning"),!1):(a._rechargeToMsg(n,"dealing"),!0)})},_rechargeToMsg:function(a,b){d.text("#J_TelMsg",a),"warning"!=b||a!=j&&a!=k||(d.hasClass("#J_TelOperator","hidden")||d.addClass("#J_TelOperator","hidden"),d.hasClass("#J_TelOperator","operator")&&d.removeClass("#J_TelOperator","operator"),this._parPriceOpts.length>1&&(this._parPriceOpts.length=1),d.hasClass("#J_TelParPrice","prompt")||d.addClass("#J_TelParPrice","prompt"),d.text("#J_TelSalePrice","")),d.hasClass("#J_TelMsgBox",b)||("dealing"==b&&(d.hasClass("#J_TelMsgBox","warning")&&d.removeClass("#J_TelMsgBox","warning"),d.hasClass("#J_TelSubmit","hidden")||d.addClass("#J_TelSubmit","hidden")),d.addClass("#J_TelMsgBox",b)),d.hasClass("#J_TelMsgBox","hidden")&&d.removeClass("#J_TelMsgBox","hidden"),"vt"==this._telBoxType&&(d.css(this._telPanel,"height","190px"),d.css(this._telSubbtn,"top","162px"))},_msgToRecharge:function(){d.hasClass("#J_TelMsgBox","hidden")||d.addClass("#J_TelMsgBox","hidden"),"vt"==this._telBoxType&&(d.css(this._telPanel,"height","161px"),d.css(this._telSubbtn,"top","136px"))},_getOperators:function(){var b=this;a.io({dataType:"jsonp",url:"//tcc.taobao.com/cc/json/mobile_tel_segment.htm",data:{tel:d.val("#J_TelInput")},success:function(a){b.displayOperators(a)}})},displayOperators:function(a){var b=a.catName.substr(2);d.text("#J_TelOperator",a.province+b),d.hasClass("#J_TelOperator","hidden")&&d.removeClass("#J_TelOperator","hidden"),d.hasClass("#J_TelOperator","operator")||d.addClass("#J_TelOperator","operator"),d.val("#J_TelProvince",a.province),d.val("#J_TelCatName",b),this._getPrice(a)},_getPrice:function(b){var c=this;a.io({dataType:"jsonp",url:i.storeDomain+"/shop/rechargeCenter.htm",data:{type:"mobile",province:b.province,catName:b.catName.substr(2),user_num_id:i.userNumId,sign:i.sign,_input_charset:"utf-8"},success:function(a){c.displayPrice(a)}})},displayPrice:function(b){this._parPriceOpts=d.get("#J_TelParPrice").options;var c=this._parPriceOpts;this._mobilesInfo=b.mobilesInfo,c.length>1&&(c.length=1),d.hasClass("#J_TelParPrice","prompt")||d.addClass("#J_TelParPrice","prompt"),d.text("#J_TelSalePrice",""),this._mobilesInfo.length>0?a.each(this._mobilesInfo,function(a){c[c.length]=new Option(a.parPrice,a.itemNumId)}):this._rechargeToMsg(m,"warning")}}),h._init(q,i,s,r)}}var c,a=KISSY,d=a.DOM,e=a.Event,f=document,g=document.all;return a.augment(b,{_init:function(b,c,d,e){a.log("TshopPbsmOtherRechargeCenter init start");var f=this;a.ready(function(){if(b.create(),c.showMobile){new d(f._mod)}if(c.showCard||c.showGold){new e}}),a.log("TshopPbsmOtherRechargeCenter init end")}}),b.selector=".tshop-pbsm-other-recharge-center",b});KISSY.add("modules/other/taoke-recharge/index",function(a){function b(b){var h=this;if(h._mod=b.mod,h._mod&&d.attr("#J_AlimRechargeData","data-value")){var i=a.JSON.parse(d.attr("#J_AlimRechargeData","data-value")),j=i.taokeServer,k={phoneList:"/chongzhi/phone_list.do",phoneSearch:"/chongzhi/phone_search.do",phoneCard:"/chongzhi/phone_card.do"},l={qqList:"/chongzhi/qq_list.do",qqCard:"/chongzhi/qq_card.do"},m={cardList:"/chongzhi/dian_ka_list.do",cardBuy:"/chongzhi/dian_ka.do"},n={onlineList:"/chongzhi/hot_games.do",onlineBuy:"/chongzhi/game_goods_submit.do"},o="mm_"+i.taokepid+"_0_0",p={tel:"//s8.taobao.com/search?q=%B3%E4%D6%B5&ex_q=&filterFineness=&atype=&isprepay=1&promoted_service4=4&user_type=1&olu=yes&commend=all&sort=coefp&style=grid&viewIndex=7&p4p_str=lo1%3D0%26lo2%3D0%26nt%3D1&mode=86&${SearchString}&b=zhl347",card:"//s8.taobao.com/search?q=%B5%E3%BF%A8&${SearchString}&mode=86&rt=1323847099431",gold:"//s8.taobao.com/search?q=qq&{SearchString}&mode=86&rt=1323847137408",online:"//s8.taobao.com/search?q=%CD%F8%D3%CE&unid=0&mode=86&${SearchString}&p4p_str=lo1%3D0%26lo2%3D0%26nt%3D1&cat=50017708&from=compass&navlog=compass-3-c-50017708"},q="\u53f7\u7801\u6709\u8bef,\u8bf7\u91cd\u65b0\u8f93\u5165",r="\u53f7\u7801\u4e0d\u4e00\u81f4,\u8bf7\u91cd\u65b0\u8f93\u5165",s="\u8d27\u7269\u6682\u7f3a",t="\u83b7\u53d6\u6570\u636e\u9519\u8bef\uff0c\u8bf7\u91cd\u8bd5",u={create:function(){"undefined"!=typeof localStorage?c=localStorage:g&&(c=f.createElement("input"),c.type="hidden",f.body.appendChild(c),c.addBehavior("#default#userData"))},set:function(a,b){if("setItem"in c)c.setItem(a,b);else if(g)try{c.setAttribute(a,b),c.save("IELocalDataStore")}catch(d){}},get:function(a){if("getItem"in c)return c.getItem(a);if(g)try{return c.load("IELocalDataStore"),c.getAttribute(a)}catch(b){}}},v=function(a){this._gameSubbtn=d.get("#J_AlimGameSubmit",a),this._gameCatD=d.get("#J_AlimGameCatId",a),this._catOpts=this._gameCatD.options,this._gameCatNameD=d.get("#J_AlimGameCatName",a),this._parPriceLabelD=d.get("#J_AlimGameParPrice_label",a),this._parPriceD=d.get("#J_AlimGameParPrice",a),this._parPriceOpts=this._parPriceD.options,this._gameSalePriceEntry=d.get("#J_AlimGameSalePriceEntry",a),this._gameSalePriceLabelD=d.get("#J_AlimGameSalePriceLabel",a),this._gameSalePriceD=d.get("#J_AlimGameSalePrice",a),this._gameCardD=d.get("#J_AlimGameCard",a),this._gameGoldD=d.get("#J_AlimGameGold",a),this._gameOnlineD=d.get("#J_AlimGameOnline",a),this._gameMsgBox=d.get("#J_AlimGameMsgBox",a),this._gameMsgD=d.get("#J_AlimGameMsg",a),this._isGameLackItem=!1,this._currentGameType=null,this.GAME_TYPE={GOLD:"gold",CARD:"card",ONLINE:"online"},this._catIndex=0,this._parPriceIndex=0,this._gameCatsInfo=new Array,this._gameItemsInfo=null,this._searchMore=null;var b=this;window.setTimeout(function(){b.init()},200)};a.augment(v,{init:function(){this._initGameEvent();var a=i.showCard+i.showGold+i.showOnline;a>1?"card"==u.get("gameType")?(d.attr(this._gameCardD,"checked","checked"),this._displayCatName(this._gameCardD)):"gold"==u.get("gameType")?(d.attr(this._gameGoldD,"checked","checked"),this._displayCatName(this._gameGoldD)):"online"==u.get("gameType")?(d.attr(this._gameOnlineD,"checked","checked"),this._displayCatName(this._gameOnlineD)):d.attr(this._gameCardD,"checked")?this._displayCatName(this._gameCardD):d.attr(this._gameGoldD,"checked")?this._displayCatName(this._gameGoldD):d.attr(this._gameOnlineD,"checked")?this._displayCatName(this._gameOnlineD):(d.attr(this._gameCardD,"checked","checked"),this._displayCatName(this._gameCardD)):i.showCard?(this._currentGameType=this.GAME_TYPE.CARD,this._requestCardCatsInfo()):i.showGold?(this._currentGameType=this.GAME_TYPE.GOLD,this._requestQQCatsInfo()):i.showOnline&&(this._currentGameType=this.GAME_TYPE.ONLINE,this._togglePriceEntry("hidden"),this._requestOnlineCatsInfo())},_initGameEvent:function(){var b=this;a.each([b._gameCardD,b._gameGoldD,b._gameOnlineD],function(a){!!a&&e.on(a,"click",function(){b._msgToRecharge(),b._displayCatName(this)})},b),e.on(b._gameCatD,"change",function(){b._catIndex=this.selectedIndex,b._catChange()}),e.on(b._parPriceD,"change",function(){b._parPriceIndex=this.selectedIndex,b._parPriceChange()})},_clearDataCache:function(){this._gameCatsInfo=[],this._gameItemsInfo=null},_markGameLackItem:function(a){this._gameSalePriceLabelD.innerHTML="\u6682\u7f3a\uff1a",this._gameSalePriceD.innerHTML="<a href='"+p[a].replace(/\$\{SearchString\}/,"pid="+o)+"' target='_blank'>\u70b9\u6b64\u641c\u7d22</a>",d.hasClass(this._gameSubbtn,"hidden")||d.addClass(this._gameSubbtn,"hidden")},_displayCatName:function(a){switch(this._clearDataCache(),this._clearPrice(),d.attr(a,"id")){case"J_AlimGameGold":this._currentGameType=this.GAME_TYPE.GOLD,u.set("gameType","gold"),d.text(this._gameCatNameD,"\u79cd\u7c7b\uff1a"),d.text(this._parPriceLabelD,"\u9762\u503c\uff1a"),this._togglePriceEntry("show"),this._requestQQCatsInfo();break;case"J_AlimGameCard":this._currentGameType=this.GAME_TYPE.CARD,u.set("gameType","card"),d.text(this._gameCatNameD,"\u6e38\u620f\uff1a"),d.text(this._parPriceLabelD,"\u9762\u503c\uff1a"),this._togglePriceEntry("show"),this._requestCardCatsInfo();break;case"J_AlimGameOnline":this._currentGameType=this.GAME_TYPE.ONLINE,u.set("gameType","online"),d.text(this._gameCatNameD,"\u6e38\u620f\uff1a"),d.text(this._parPriceLabelD,"\u7269\u54c1\uff1a"),this._togglePriceEntry("hidden"),this._requestOnlineCatsInfo()}},_togglePriceEntry:function(a){"show"===a?d.removeClass(this._gameSalePriceEntry,"hidden"):"hidden"===a&&(d.hasClass(this._gameSalePriceEntry,"hidden")||d.addClass(this._gameSalePriceEntry,"hidden"))},_requestOnlineCatsInfo:function(){var b=this;a.io({dataType:"jsonp",url:j+n.onlineList,success:function(a){return a.success?(b._isGameLackItem=!1,void b.getOnlineCats(a)):(b._isGameLackItem=!0,void b._rechargeToMsg(t,"warning"))}})},getOnlineCats:function(b){return b.data?(a.each(b.data,function(a,b){this._gameCatsInfo.push({catId:b,catData:a})},this),this._fillCatOpts(),void this._catChange()):void h._rechargeToMsg(t,"warning")},_requestCardCatsInfo:function(){var b=this;a.io({dataType:"jsonp",url:j+m.cardList,success:function(a){return a.success?(b._isGameLackItem=!1,void b.getCardCats(a)):(b._isGameLackItem=!0,void b._rechargeToMsg(t,"warning"))}})},getCardCats:function(b){return b.data?(a.each(b.data,function(a,b){this._gameCatsInfo.push({catId:b,catData:a})},this),this._gameCatsInfo.sort(function(a,b){return a.catData.name.localeCompare(b.catData.name)}),this._fillCatOpts(),void this._catChange()):void h._rechargeToMsg(t,"warning")},_requestQQCatsInfo:function(){var b=this;a.io({dataType:"jsonp",url:j+l.qqList,success:function(a){return a.success?(b._isGameLackItem=!1,void b.getQQCats(a)):(b._isGameLackItem=!0,void b._rechargeToMsg(t,"warning"))}})},getQQCats:function(b){return b.data?(a.each(b.data,function(a,b){this._gameCatsInfo.push({catId:b,catData:a})},this),this._fillCatOpts(),void this._catChange()):void h._rechargeToMsg(t,"warning")},_fillCatOpts:function(){var b=this._catOpts;this._recoveryCatOpts(),this._recoveryPrice(),this._gameCatsInfo.length>0&&a.each(this._gameCatsInfo,function(a){b[b.length]=new Option(a.catData.name,a.catId)})},_recoveryCatOpts:function(){this._catOpts.length=0,this._catIndex=0},_recoveryPrice:function(){this._parPriceOpts.length=0,this._parPriceIndex=0,d.text(this._gameSalePriceD,"")},_catChange:function(){this._recoveryPrice(),this._clearPrice(),this._gameItemsInfo=this._gameCatsInfo[this._catIndex],this._fillParPriceOpts(),this._parPriceChange()},_fillParPriceOpts:function(){var b,c,d=this._parPriceOpts;this._currentGameType===this.GAME_TYPE.ONLINE?(b=this._gameItemsInfo?this._gameItemsInfo.catData.goods:[],c=b.length>0?this._gameItemsInfo.catData.pidvid:[]):(b=this._gameItemsInfo?this._gameItemsInfo.catData.price:[],c=b.length>0?this._gameItemsInfo.catData.price_vid:[]),this._msgToRecharge(),a.each(b,function(a,b){d[d.length]=new Option(a,c[b])})},_clearPrice:function(){d.text(this._gameSalePriceLabelD,"\u552e\u4ef7\uff1a"),d.text(this._gameSalePriceD,""),d.hasClass(this._gameSubbtn,"hidden")&&d.removeClass(this._gameSubbtn,"hidden")},_parPriceChange:function(){this._clearPrice();var b=this._parPriceIndex,c=this._gameItemsInfo;switch(this._currentGameType){case this.GAME_TYPE.GOLD:var d=c.catData,e=this;a.io({dataType:"jsonp",url:j+l.qqCard,data:{cat_id:c.catId,price_id:d.price_id,mm_id:o,price_vid:d.price_vid[b],service_id:d.service_id},success:function(a){return a.success?(e._isGameLackItem=!1,void e._fillPriceAndEnableBuy({clickUrl:a.click_url,price:a.price})):(e._isGameLackItem=!0,void e._markGameLackItem("gold"))}});break;case this.GAME_TYPE.CARD:var d=c.catData,e=this;a.io({dataType:"jsonp",url:j+m.cardBuy,data:{cat_id:c.catId,price_id:d.price_id,mm_id:o,price_vid:d.price_vid[b],service_id:d.service_id},success:function(a){return a.success?(e._isGameLackItem=!1,void e._fillPriceAndEnableBuy({clickUrl:a.click_url,price:a.price})):(e._isGameLackItem=!0,void e._markGameLackItem("card"))}});break;case this.GAME_TYPE.ONLINE:var d=c.catData,e=this;e._togglePriceEntry("hidden"),a.io({dataType:"jsonp",url:j+n.onlineBuy,data:{cat_id:c.catId,mm_id:o,pidvid:d.pidvid[b]},success:function(a){return a.success?(e._isGameLackItem=!1,void e._fillPriceAndEnableBuy({clickUrl:a.click_url,price:a.price})):(e._isGameLackItem=!0,e._togglePriceEntry("show"),void e._markGameLackItem("online"))}})}},_fillPriceAndEnableBuy:function(a){d.text(this._gameSalePriceD,a.price),d.attr(this._gameSubbtn,"href",a.clickUrl),this._msgToRecharge()},_rechargeToMsg:function(b,c){d.text(this._gameMsgD,b),d.hasClass(this._gameMsgBox,c)||("dealing"==c&&(d.hasClass(this._gameMsgBox,"warning")&&d.removeClass(this._gameMsgBox,"warning"),d.hasClass(this._gameSubbtn,"hidden")||d.addClass(this._gameSubbtn,"hidden")),d.addClass(this._gameMsgBox,c)),d.hasClass(this._gameMsgBox,"hidden")&&d.removeClass(this._gameMsgBox,"hidden"),a.UA.ie&&8>a.UA.ie&&(d.css(this._telSubbtn,"zoom",""),d.css(this._telSubbtn,"zoom","1"))},_msgToRecharge:function(){d.hasClass(this._gameMsgBox,"hidden")||d.addClass(this._gameMsgBox,"hidden"),a.UA.ie&&8>a.UA.ie&&(d.css(this._telSubbtn,"zoom",""),d.css(this._telSubbtn,"zoom","1"))}});var w=function(a){this._telBoxType=190==d.width(d.parent(a))?"vt":"hz",this._telPanel=d.get(".tel-panel",a),this._telSubbtn=d.get("#J_AlimTelSubmit",a),this._telMsgBoxD=d.get("#J_AlimTelMsgBox",a),this._telMsgD=d.get("#J_AlimTelMsg",a),this._telOperatorD=d.get("#J_AlimTelOperator",a),this._parPriceD=d.get("#J_AlimTelParPrice",a),this._parPriceOpts=this._parPriceD.options,this._telSalePriceLabelD=d.get("#J_AlimTelSalePriceLabel",a),this._telSalePriceD=d.get("#J_AlimTelSalePrice",a),this._telInputD=d.get("#J_AlimTelInput",a),this._telInputCfmD=d.get("#J_AlimTelInputCfm",a),this._telProvinceD=d.get("#J_AlimTelProvince",a),this._telCatNameD=d.get("#J_AlimTelCatName",a),this._isTelLackItem=!1,this._mobilesInfo=new Array,this._getPriceData={},this._getPriceData.mm_id=o,this._initTelEvent(),this._getPrice()};a.augment(w,{_initTelEvent:function(){var a=this;e.on(a._telInputD,"focus",function(){d.hasClass(this,"prompt")&&(d.val(this,""),d.removeClass(this,"prompt")),d.attr(a._telInputCfmD,"disabled")&&d.removeAttr(a._telInputCfmD,"disabled"),a._msgToRecharge()}),e.on(a._telInputCfmD,"focus",function(){d.hasClass(this,"prompt")&&(d.val(this,""),d.removeClass(this,"prompt"))}),e.on(a._telInputD,"paste",function(){return!1}),e.on(a._telInputCfmD,"paste",function(){return!1}),e.on(a._telInputD,"contextmenu",function(){return!1}),e.on(a._telInputCfmD,"contextmenu",function(){return!1}),e.on(a._telInputD,"keyup",function(){var b=/\D/g,c=d.val(this);d.val(this,c.replace(b,"")),d.val(a._telInputCfmD)&&(d.val(a._telInputCfmD,"\u8bf7\u518d\u6b21\u8f93\u5165"),d.addClass(a._telInputCfmD,"prompt")),d.hasClass(a._telOperatorD,"hidden")||d.addClass(a._telOperatorD,"hidden"),a._clearPrice()}),e.on(a._telInputCfmD,"keyup",function(){var a=/\D/g,b=d.val(this);d.val(this,b.replace(a,""))}),e.on(a._telInputD,"blur",function(){("1"!==d.val(this).charAt(0)||d.val(this).length<11)&&(a._rechargeToMsg(q,"warning"),d.attr(a._telInputCfmD,"disabled","disabled"))}),e.on(a._telInputCfmD,"blur",function(){d.val(a._telInputD)!==d.val(a._telInputCfmD)?a._rechargeToMsg(r,"warning"):a._msgToRecharge()}),e.on(a._telInputCfmD,"keyup",function(){11===d.val(a._telInputCfmD).length&&(d.val(a._telInputD)!==d.val(a._telInputCfmD)?a._rechargeToMsg(r,"warning"):(a._msgToRecharge(),a._getOperators()))}),e.on(a._parPriceD,"change",function(){a._priceChange(this)}),e.on(a._telSubbtn,"click",function(b){"1"!==d.val(a._telInputD).charAt(0)||d.val(a._telInputD).length<11?(a._rechargeToMsg(q,"warning"),b.halt()):d.val(a._telInputD)!==d.val(a._telInputCfmD)?(a._rechargeToMsg(r,"warning"),b.halt()):0==a._parPriceOpts.length?(a._rechargeToMsg(s,"warning"),b.halt()):a._isTelLackItem&&b.halt()})},_isPhoneCheckOK:function(a){var b=d.val(this._telInputD),c=d.val(this._telInputCfmD);return"1"!==b.charAt(0)||11!==b.length?(a&&this._rechargeToMsg(q,"warning"),!1):b!==c?(a&&this._rechargeToMsg(r,"warning"),!1):!0},_priceChange:function(b){var c=this;c._clearPrice();var e=b.selectedIndex;c._getPriceData.price_id=c._mobilesInfo[e].id,c._getPriceData.phone=d.val(c._telInputD),c._isPhoneCheckOK()&&a.io({dataType:"jsonp",url:j+k.phoneCard,data:c._getPriceData,success:function(a){return a.success?(c._isTelLackItem=!1,d.text(c._telSalePriceD,a.price),d.attr(c._telSubbtn,"href",a.click_url),d.hasClass(this,"prompt")&&d.removeClass(this,"prompt"),void c._msgToRecharge()):(c._isTelLackItem=!0,void c._markLackItem())}})},_markLackItem:function(){this._telSalePriceLabelD.innerHTML="\u7f3a\u8d27\uff1a",this._telSalePriceD.innerHTML="<a href='"+p.tel.replace(/\$\{SearchString\}/,"pid="+o)+"' target='_blank'>\u70b9\u6b64\u641c\u7d22</a>",d.hasClass(this._telSubbtn,"hidden")||d.addClass(this._telSubbtn,"hidden")},_clearPrice:function(){this._telSalePriceLabelD.innerHTML="\u552e\u4ef7\uff1a",d.text(this._telSalePriceD,""),d.hasClass(this._telSubbtn,"hidden")&&d.removeClass(this._telSubbtn,"hidden")},_rechargeToMsg:function(b,c){var e=this;d.text(e._telMsgD,b),"warning"!=c||b!=q&&b!=r||(d.hasClass(e._telOperatorD,"hidden")||d.addClass(e._telOperatorD,"hidden"),d.hasClass(e._telOperatorD,"operator")&&d.removeClass(e._telOperatorD,"operator")),d.hasClass(e._telMsgBoxD,c)||("dealing"==c&&(d.hasClass(e._telMsgBoxD,"warning")&&d.removeClass(e._telMsgBoxD,"warning"),d.hasClass(e._telSubbtn,"hidden")||d.addClass(e._telSubbtn,"hidden")),d.addClass(e._telMsgBoxD,c)),d.hasClass(e._telMsgBoxD,"hidden")&&d.removeClass(e._telMsgBoxD,"hidden"),a.UA.ie&&8>a.UA.ie&&(d.css(e._telSubbtn,"zoom",""),d.css(e._telSubbtn,"zoom","1"))},_msgToRecharge:function(){d.hasClass(this._telMsgBoxD,"hidden")||d.addClass(this._telMsgBoxD,"hidden"),a.UA.ie&&8>a.UA.ie&&(d.css(this._telSubbtn,"zoom",""),d.css(this._telSubbtn,"zoom","1"))},_getOperators:function(){var b=this;a.io({dataType:"jsonp",url:j+k.phoneSearch,data:{phone:d.val(b._telInputD)},success:function(a){return a.success?(b.displayOperators(a),void b._priceChange(b._parPriceD)):void b._rechargeToMsg(q,"warning")}})},displayOperators:function(a){var b=this;b._getPriceData.cat_id=a.cat_id,b._getPriceData.province_id=a.province_id;var c=a.cat_name.substr(2);d.text(b._telOperatorD,a.province_name+c),d.hasClass(b._telOperatorD,"hidden")&&d.removeClass(b._telOperatorD,"hidden"),d.hasClass(b._telOperatorD,"operator")||d.addClass(b._telOperatorD,"operator"),d.val(b._telProvinceD,a.province),d.val(b._telCatNameD,c)},_getPrice:function(){var b=this;a.io({dataType:"jsonp",url:j+k.phoneList,success:function(a){return a.success?void b.displayPrice(a):void b._rechargeToMsg(t,"warning")}})},displayPrice:function(b){var c=this._parPriceOpts;return b.denomination?(this._mobilesInfo=b.denomination,c.length>0&&(c.length=0),d.hasClass(this._parPriceD,"prompt")&&d.removeClass(this._parPriceD,"prompt"),d.text(this._telSalePriceD,""),void(this._mobilesInfo.length>0&&a.each(this._mobilesInfo,function(a){var b=new Option(a.name,a.id);"100\u5143"===a.name&&(b.selected=!0),c[c.length]=b}))):void this._rechargeToMsg(t,"warning")}}),h._init(u,i,w,v)}}var c,a=KISSY,d=a.DOM,e=a.Event,f=document,g=document.all;return a.augment(b,{_init:function(b,c,d,e){a.log("TshopPbsmOtherTaokeRecharge init start");var f=this;a.ready(function(a){if(b.create(),c.showMobile){new d(f._mod)}if(c.showCard||c.showGold||c.showOnline){new e(f._mod)}}),a.log("TshopPbsmOtherTaokeRecharge init end")}}),b.selector=".tshop-pbsm-other-taoke-recharge",b});KISSY.add("modules/other/cainixihuan/index",function(a){function b(a){var b=this;b._el=a.mod,b._init(b._el)}function c(b,c,i){var j,k,l,m,n,o,o,p=g.get(".mod-tags",c),q=g.get(".mod-detail",c);if(p&&q){if(0==b.list.length&&!b.listDesc.hasOwnProperty("tags"))return void g.hide(".tshop-um-recommend");var r,s;if(r=b.listDesc.tags,s=b.list,j="",750==i||950==i){for(f=0;f<r.length;f++){var t=r[f];j+="<a class='tags' target='_blank' href='"+shop_url+"/search.htm?keyword="+t.encode+"'>"+t.keyword+"</a>"}j+="<div class='tags-title'>\u4f60\u53ef\u80fd\u5173\u6ce8\u672c\u5e97\u7684</div>"}else if(190==i)for(j+="<div class='tags-title'>\u4f60\u53ef\u80fd\u5173\u6ce8\u672c\u5e97\u7684</div>",f=0;f<r.length;f++){var t=r[f];j+="<a class='tags' target='_blank' href='"+shop_url+"/search.htm?keyword="+t.encode+"'>"+t.keyword+"</a>"}if(g.html(p,j),j="",s.length<=2)return void g.hide(".tshop-um-recommend");for(f=0;f<s.length;f++)s[f].price=e(s[f].price),s[f].promotionPrice=e(s[f].promotionPrice),""==s[f].pic?s[f].pic="//img.alicdn.com/newshop/nopicture.gif":190==i?s[f].pic+="_40x40.jpg":(950==i||750==i)&&(s[f].pic+="_160x160xz.jpg");for(j="<div class='related-items grid'>",j+="<div class='related-items-switchable'><div class='ks-switchable-content'>",k=0;2>k;k++){for(j+=k>0?"<ul class='item-list' style='display: none'>":"<ul class='item-list'>",f=5*k,l=0;f<s.length&&5>l;f++,l++){m=s[f];var u;190==i?u=m.name.length>8?m.name.replace(/(.{8}).*$/,"$1..."):m.name:(750==i||950==i)&&(u=m.name.length>24?m.name.replace(/(.{24}).*$/,"$1..."):m.name);var v="<p class='tuijian-price tuijian-light'><b class='yen'>&yen;</b><b class='price'>"+m.price+"</b></p>";0!=m.promotionPrice&&(v='<p class="tuijian-price"><span class="tuijian-light"><b class="yen">&yen;</b><b class="promotion-price">'+m.promotionPrice+'</b></span><span class="old-price"><b class="price">'+m.price+"</b></span></p>"),n="<li><div class='item'><div class='pic'><a class='side-item' target='_blank' href='"+m.url+"'><img title='"+m.name+"' src='"+m.pic+"'/></a></div><div class='info'><div class='desc'><a class='side-item' style='width' target='_blank' href='"+m.url+"' >"+u+"</a></div>"+v,n+=0==m.monthSellCount?"<div class='month-sell'>\u7b49\u4f60\u6765\u4e70</div>":"<div class='month-sell'>\u5df2\u552e\u51fa<span class='month-sell-count'>"+m.monthSellCount+"</span>\u7b14</div>",n+="</div></div></li>",j+=n}j+="</ul>"}j+="</div></div>",j+="<a href=# class='prev'></a>",j+="<a href=# class='next'></a>",j+="</div>",g.html(q,j);var w,x=g.get(".prev",c),y=g.get(".next",c),z=g.get(".skin-box-hd",c),A=g.get(".related-items-switchable",c),B=g.query(".tags",c);190==i||750==i?w="scrollx":950==i&&(w="fade"),g.css(z,"height","0px"),a.use("wangpu/gallery/switchable",function(a,b){o=new b(A,{hasTriggers:!1,panelCls:"item-list",effect:w,easing:"easeOutStrong",duration:1,markupType:1})}),190==i||950==i?s.length<=5&&(g.hide(x),g.hide(y)):750==i&&s.length<=4&&(g.hide(x),g.hide(y)),h.on(x,"click",function(a){a.preventDefault(),190==i?(g.css(x,"background-position","-134px -8px"),g.css(y,"background-position","-117px -8px"),o.switchTo(0)):(750==i||950==i)&&o.prev()}),h.on(y,"click",function(a){a.preventDefault(),190==i?(g.css(x,"background-position","-117px -8px"),g.css(y,"background-position","-134px -8px"),o.switchTo(1)):(750==i||950==i)&&o.next()}),h.on(B,"click",function(a){var b=g.attr(a.currentTarget,"href"),c="//ju.mmstat.com/?url="+b+"&scm=1007.329.0.0&t="+(new Date).getTime();d(c)})}}function d(a){if(a){var b="hold_"+(new Date).getTime(),c=window[b]=new Image;c.onload=c.onerror=function(){window[b]=null},c.src=a,c=null}}function e(a){return a>99999999?parseFloat(a/1e8).toFixed(2)+"\u4ebf":a>9999?parseFloat(a/1e4).toFixed(2)+"\u4e07":parseFloat(a).toFixed(2)}var f,g=a.DOM,h=a.Event;return b.prototype={_init:function(b){var d,e,f,h,i=g.width(b),j=(new Date).getTime();750==i?f=8:(190==i||950==i)&&(f=10),h=g.attr(".tshop-um-recommend","seller-id"),shop_url=g.attr(".tshop-um-recommend","shop-url"),e=location.host.indexOf("daily")>-1?"tui.daily.taobao.net":"tui.taobao.com",a.IO({dataType:"jsonp",url:"//"+e+"/api/item",data:{p:"u",from:"dianpuhome_guesslike",count:f,sellerid:h,t:j,f:"jp",jsonpCallback:"jsonp"},success:function(a){d=a,c(d,b,i)},error:function(b){a.log("Ajax error:"+b)}})}},b.selector=".tshop-um-recommend",b});KISSY.add("modules/other/jiyoujia-itemlist/index",function(a){function b(){this.init()}return a.augment(b,{init:function(){a.log("tshop-pbsm-other-jiyoujia-itemlist init"),a.use("tbc/webww/1.1.9/webww")}}),b.selector="tshop-pbsm-other-jiyoujia-itemlist",b},{requires:[]});KISSY.add("modules/other/jiyoujia-sign/index",function(a,b){function c(){this.init()}return a.augment(c,{init:function(){a.log("tshop-pbsm-other-jiyoujia-sign init"),new b({callback:function(a){}})}}),c.selector="tshop-pbsm-other-jiyoujia-sign",c},{requires:["tbc/favorite/1.0.15/"]});KISSY.add("modules/shop/lab/index",function(a,b,c){function d(a){var b=this;b._mod=a.mod,b._mod&&b._init()}var a=KISSY,e=a.Event,f=a.DOM;document;return a.augment(d,{_init:function(){a.log("TshopPbsmShopLab Preview init start");var b=this;b._initVersionTabs(),b._initLabInfo(),a.log("TshopPbsmShopLab Preview init end")},_initVersionTabs:function(){var a=this,c=b.Tabs,d=f.get(".J_TLabTabs",a._mod);d&&(a._tabs=new c(d,{navCls:"lab-tab-nav",contentCls:"lab-tab-content",activeTriggerCls:"active-version",activeIndex:1,triggerType:"click"}))},_initLabInfo:function(){var b=this,c=f.get(".J_TLabInfoTrigger",b._mod),d=f.get(".lab-title",b._mod),g=f.get(".lab-tab-nav",b._mod),h=f.get(".lab-tab-content",b._mod),i=f.query(".lab-tab-panel",h),j=(f.query(".lab-mask",h),[]);j.push(c),j.push(h);var k=[];k.push(d),k.push(g),k.push(g);var l,m;e.on(j,"mouseenter",function(c){m&&m.cancel(),l&&l.cancel(),l=a.later(function(){var a=i[b._tabs.activeIndex],c=f.get(".lab-mask",a),d=f.get(".lab-crowd",a);k.push(c),d&&k.push(d),f.show(k),l.cancel()},100)}),e.on(j,"mouseleave",function(c){l&&l.cancel(),m&&m.cancel(),m=a.later(function(){var a=i[b._tabs.activeIndex],c=f.get(".lab-mask",a),d=f.get(".lab-crowd",a);k.push(c),k.push(d),f.hide(k),m.cancel()},1e3)}),e.delegate(h,"click",".J_TCrowdInfoTrigger",function(a){var b=a.currentTarget,c=f.parent(b,".lab-crowd"),d=f.get(".crowd-bd",c);f.toggleClass(d,"hide"),f.toggleClass(b,"icon-hide-crowd-info")})}}),d.selector=".tshop-pbsm-shop-lab-preview",d},{requires:["wangpu/gallery/switchable","wangpu/gallery/datalazyload"]});KISSY.add("modules/shop/new-signboard/index",function(a,b){function c(a){var b=this;b._mod=a.mod,b._mod&&b._init()}function d(b){var c=a.now();return b+(-1===b.indexOf("?")?"?":"&")+"t="+c}function e(b){var c=a.DOM.val("#J_TokenField");return b+(-1===b.indexOf("?")?"?":"&")+"_tb_token_="+c}function f(a,b,c){var d=Math.ceil(.45*h.viewportHeight()+h.scrollTop())-c/2,e=Math.ceil((h.docWidth()-b)/2);h.offset(a,{top:d,left:e})}var g,h,i,j;return g=a.all,h=a.DOM,i=a.Event,UA=a.UA,j=1===g_config.appId||(window.g_config?window.g_config.preview:void 0),a.augment(c,{_init:function(){var a=this;a._initCollect(),a._initQualification(),a._initWeitaoBtn()},_initQualification:function(){function a(a){var b=a,c=h.siblings(b);h.addClass(b,"actived"),h.removeClass(c,"actived")}function b(b){if(UA.ie&&UA.ie<=6)return void c(b);if(b){if(1===j)return;j--}else{if(j>=m)return;j++}h.removeClass(e,"page2 page3"),h.addClass(e,"page"+j),a(k[3*(j-1)])}function c(b){if(b){if(1===j)return;j--}else if(b===!1){if(j>=m)return;j++}var c=3*(j-1),d=[].slice.call(k,c,c+3);h.hide(k),h.css(d,"display","inline"),a(k[c])}var d=this,e=h.get(".J_TQLFTBox",d._mod),f=h.get(".J_TQLeft",d._mod),g=h.get(".J_TQRight",d._mod),j=1,k=h.query(".J_TIconItem",d._mod),l=k.length,m=Math.ceil(l/3);l>3&&h.addClass(e,"more-than-3"),UA.ie&&UA.ie<=6&&c(),i.on(f,"click",function(){b(!0)}),i.on(g,"click",function(){b(!1)}),i.delegate(e,"mouseenter",".J_TIconItem",function(b){a(b.currentTarget)}),a(k[0])},_initCollect:function(){var a=this;a._handleTriggerCollect()},_handleTriggerCollect:function(){var a=this,b=h.get("#popupPanel");i.delegate(a._mod,"click",".J_TCollectShop",function(a){a.preventDefault();var c=a.target,g=c.getAttribute("data-width"),i=c.getAttribute("data-height");h.css(b,"display","none");var j=e(d(c.href)),k='<a class="close-btn" href="#">X</a><iframe src="'+j+'" width="'+g+'" height="'+i+'" name="popupIframe" frameborder="0" scrolling="no"></iframe><div class="tb-canvas"></div>';h.html(b,k),h.css(b,{visibility:"visible",display:"block",width:g,height:i}),f(b,g,i)})},_initWeitaoBtn:function(){var a=this,b=h.get("#popupPanel");i.delegate(a._mod,"click",".J_TWeitaoFlw",function(a){a.preventDefault(),TB.Global.use("fn-login",function(c,e){e.Mini.popup(function(){var c=a.target,e=c.getAttribute("data-width"),g=c.getAttribute("data-height");h.css(b,"display","none");var i=d(c.href),j='<a class="close-btn" href="#">X</a><iframe src="'+i+'" width="'+e+'" height="'+g+'" name="popupIframe" frameborder="0" scrolling="no"></iframe><div class="tb-canvas"></div>';h.html(b,j),h.css(b,{visibility:"visible",display:"block",width:e,height:g}),f(b,e,g)})})})},_initColloctWeitaoContainer:function(){var a=h.get("#popupPanel");a||(a=h.create('<div id="popupPanel">'),h.append(a,"body"),i.delegate(a,"click",".close-btn",function(b){b.preventDefault(),h.hide(a),iframe=h.get("iframe",a),iframe.contentWindow.sendInvite&&iframe.contentWindow.sendInvite(),h.empty(a)}))}}),c.selector=".tshop-pbsm-signboard",c},{requires:["overlay"]});KISSY.add("modules/shop/cross-shop/index",function(a,b){function c(b){var c=this;if(c._mod=b.mod,c._mod){a.log("TshopPsmShopCrossShop init start");var f=a.buffer(function(){var a;return a=d.scrollTop(window)+d.viewportHeight()-d.offset("#bd").top+800,a>=d.offset("#ft").top?(c._init(),void e.detach(window,"scroll",f)):void 0},100);e.on(window,"scroll",f),a.log("TshopPsmShopCrossShop init end")}}var a=KISSY,d=a.DOM,e=a.Event;return a.augment(c,{_init:function(){var c=this,e="//"+(window.location.host.indexOf("taobao.com")<0?"tad.skip.daily.taobao.net":"tad.t.taobao.com")+"/api/list",f='{{#each result as item}}<dl class="item "><dt class="photo"><a href="{{item.url}}" target="_blank"><img src="{{item.pic}}_180x180.jpg"  alt="{{item.itemName}}"></a></dt><dd class="detail"><a class="item-name" href="{{item.url}}" target="_blank">{{item.itemName}}</a><div class="attribute"><div class="price-area"><span class="money"></span><span class="s-price">{{item.price}}</span><span class="c-price">{{#if item.promotionPrice == 0}}{{item.price}}{{#else}}{{item.promotionPrice}} {{/if}}</span></div><div class="sold">\u6708\u9500\u91cf\uff1a{{item.monthSellCount}}</div></div></dd></dl>{{/each}}';a.io({url:e,dataType:"jsonp",data:{sellerid:d.attr(c._mod,"data-pid"),resourcecode:"110.0.4112.0",buyerid:d.attr(c._mod,"data-ext"),count:5},success:function(e){if(e.result.length>0){var g=b(f).render(e);d.html(d.get(".item5line1",c._mod),g),d.addClass(d.query(".item",c._mod)[4],"last"),6!=a.UA.ie&&d.insertAfter(c._mod,"#bd"),d.css(c._mod,"display","block"),d.attr(c._mod,"data-spm","4112")}}}),(new Image).src="//gm.mmstat.com/shopflow.2?logtype=2"}}),c.selector=".tshop-psm-cross-shop",c},{requires:["wangpu/gallery/template"]});KISSY.add("modules/shop/fans-price-activity/index",function(a,b){function c(b){var c=this;c._mod=b.mod,c._mod&&(a.log("TshopPbsmShopFansPriceActivity init start"),c._init(),a.log("TshopPbsmShopMainSlide init end"))}var a=KISSY,d=(a.Event,a.DOM),e=a.all,f=e(d.create("<div class='freeze-layer'></div>"));return a.augment(c,{_init:function(){var a=this;a.bindEvent()},showLogin:function(){var a=this,b=e("#J_LoginTPL").html();b=b.replace(/redirectURL=(.+?)"/im,"redirectURL="+encodeURIComponent(LOGIN_PROXY_URL+"?"+encodeURIComponent(location.href))+'"');var c=e(d.create(b));return c.appendTo(f),a.showOverlay(),c.one(".login-close").on("click",function(b){a.closeOverlay()}),!1},showOverlay:function(){f.appendTo("body"),f.show()},closeOverlay:function(){f.hide(),f.empty().remove()},getUserState:function(){var b=this;a.io({url:GET_STATE,dataType:"jsonp",type:"get",success:function(c){e(".J_Acount").removeClass("disabled"),c&&1==c.state?(0==c.userStatus?b.showLogin():1==c.userStatus?b.bindAcount():2==c.userStatus?b.toFollow():(e(".J_ActFans").parent(".activity-pt").show(),e(".J_Acount").parent(".activity-pt").hide(),b.changeActivityState(c.activityStatus)),b.getData()):a.log(c.message)},error:function(){a.log("\u83b7\u53d6\u72b6\u6001\u5931\u8d25")}})},changeActivityState:function(a){1==a?(e(".J_ActivityTime").show(),e(".J_ActivityState").hide(),e(".activity-sale").addClass("red-sale")):2==a?(e(".J_ActivityState").text("[\u5df2\u7ed3\u675f]").show(),e(".J_ActivityTime").hide(),e(".activity-sale").removeClass("red-sale")):(e(".J_ActivityState").text(e(".J_ActivityState").attr("post-data")).show(),e(".J_ActivityTime").hide(),e(".activity-sale").addClass("red-sale"))},bindAcount:function(){var a=e("#J_BindDlg"),c=new b.Dialog({srcNode:"#J_BindDlg",closable:!1,mask:!0,align:{points:["cc","cc"]}});c.show(),a.all(".bind-close").on("click",function(a){c.hide(),window.location.reload()}),a.one("#J_BindHref").on("click",function(a){e(a.target).hide(),e("#J_BindFinish").show()}),a.all("#J_BindFinish").on("click",function(a){c.hide(),window.location.reload()})},toFollow:function(){a.io({url:FOLLOW_FANS,dataType:"jsonp",type:"get",success:function(a){a&&1==a.state&&(e(".J_ActFans").parent(".activity-pt").show(),e(".J_Acount").parent(".activity-pt").hide())},error:function(){a.log("\u52a0\u5173\u6ce8\u5931\u8d25")}})},getData:function(){a.io({url:GET_DATA,dataType:"jsonp",type:"get",success:function(a){a&&1==a.state&&(a.pv&&e(".J_WatchNum").text(a.pv),a.buyCount&&e(".J_JoinNum").text(a.buyCount))},error:function(){a.log("\u83b7\u53d6\u56f4\u89c2\u6570\u5931\u8d25")}})},bindEvent:function(){var b=this;e(".J_ActivitySwitch").on("mouseenter",function(a){e(".J_ActivityHover").show()}),e(".J_ActivityHover").on("mouseleave",function(a){e(".J_ActivityHover").hide()}),a.io({url:GET_STATE,dataType:"jsonp",type:"get",success:function(c){e(".J_Acount").removeClass("disabled"),c&&1==c.state?(0==c.userStatus||1==c.userStatus||2==c.userStatus?(e(".J_ActFans").parent(".activity-pt").hide(),e(".J_Acount").parent(".activity-pt").show(),e(".J_Acount").on("click",function(a){var c=e(".J_Acount");c.hasClass("disabled")||(c.addClass("disabled"),b.getUserState())})):(e(".J_ActFans").parent(".activity-pt").show(),e(".J_Acount").parent(".activity-pt").hide()),b.changeActivityState(c.activityStatus),b.getData()):a.log(c.message)},error:function(){a.log("\u83b7\u53d6\u72b6\u6001\u5931\u8d25")}})}}),c.selector=".tshop-pbsm-shop-fans-price-activity",c},{requires:["overlay"]});KISSY.add("modules/shop/fans-price-list/index",function(a,b){function c(a){var b=this;b._mod=a.mod,b._mod&&b._init()}var a=KISSY,d=(a.Event,a.DOM,a.all);return a.augment(c,{_init:function(){a.log("TshopPbsmShopFansPriceList init start");var b=this;b.getItemStatus()},getItemStatus:function(){var b=this;a.io({url:LIST_GET_STATE,dataType:"jsonp",type:"get",success:function(c){c&&1==c.state?(1==c.activityStatus?d(".J_OverMask").addClass("hidden"):2==c.activityStatus?d(".J_OverMask").removeClass("hidden"):d(".J_OverMask").addClass("hidden"),b.getData()):a.log(c.message)},error:function(){a.log("\u83b7\u53d6\u72b6\u6001\u5931\u8d25")}})}}),c.selector=".tshop-pbsm-shop-fans-price-list",c});"use strict";KISSY.add("modules/shop/elevator/index",function(a,b){function c(a){this._mod=a.mod,this._mod&&this._init()}var d=a.Node,e=d.all,f=".tshop-pbsm-shop-elevator";return a.augment(c,{_init:function(){a.log("TshopPsmShopElevator init start"),this.container=e(f),this._initPlace(),a.log("TshopPsmShopElevator init end")},_initPlace:function(){var a=e(".skin-box-bd",f),b=0,c=a.attr("origin-top"),d=a.offset().top,b=40;window.location.href.indexOf("preview.htm")>0&&(b+=parseInt(e("#page").css("padding-top"))),e(window).on("scroll",function(g){e(f).hasClass("fixed")||a.offset().top==d||(d=a.offset().top),d-e(document).scrollTop()<=b?(e(f).addClass("fixed"),e(f).width(e(f).parent(".layout").width()),a.css("top",b+"px")):(e(f).removeClass("fixed"),e(f).width("100%"),a.css("top",c))}),e(window).on("resize",function(){e(f).hasClass("fixed")&&e(f).width(e(f).parent(".layout").width())})}}),c.selector=f,c});KISSY.add("modules/other/xiamiplayer/index",function(a){function b(b){window.shop_config.xiamiplayer&&KISSY.ready(function(){a.use("music-wplayer/wp_musicplayer")})}var c="//g.alicdn.com/de/music-wplayer/0.1.6/";return a.config({packages:[{name:"music-wplayer",tag:Math.random(),path:c,charset:"utf-8",ignorePackageNameInUri:!0}]}),b.type="xiamiplayer",b});KISSY.add("modules/multi-mods/slide/index",function(a){function b(b){var c=this;if(c._mod=b.mod,c._mod){a.log("TshopPbsmShopMainSlide init start"),c._init(),c.prevBtn=d.get(".prev-btn",c._mod),c.nextBtn=d.get(".next-btn",c._mod);var e=c.getCurrentStyle(d.get(".slide-box",c._mod),"height"),f=(e-c.getCurrentStyle(d.get(".slide-triggers",c._mod),"height")-c.getCurrentStyle(c.prevBtn,"height"))/2;c.prevBtn.style.top=(f>0?parseInt(f,10):0)+"px",c.nextBtn.style.top=(f>0?parseInt(f,10):0)+"px",a.UA.ie&&6==a.UA.ie&&(d.get(".slide-box",c._mod).className=d.get(".slide-box",c._mod).className),a.log("TshopPbsmShopMainSlide init end")}}var a=KISSY,c=a.Event,d=a.DOM;return a.augment(b,{_init:function(){var a=this;a.disBtn()},disBtn:function(){var a=this,b=d.get(".slide-box",a._mod),e=d.get(".prev-btn",a._mod),f=d.get(".next-btn",a._mod);c.on(b,"mouseenter",function(){d.addClass(e,"play"),d.addClass(f,"play")}),c.on(b,"mouseleave",function(){d.removeClass(e,"play"),d.removeClass(f,"play")}),c.on(e,"mouseenter",function(){d.addClass(e,"hover-pre")}),c.on(e,"mouseleave",function(){d.removeClass(e,"hover-pre")}),c.on(f,"mouseenter",function(){d.addClass(f,"hover-next")}),c.on(f,"mouseleave",function(){d.removeClass(f,"hover-next")})},render:function(a){},getCurrentStyle:function(a,b){var c=this,d="";return b=c.transToHump(b),d=window.getComputedStyle?window.getComputedStyle(a,null)[b]:a.currentStyle[b],parseInt(d,10)?parseInt(d,10):0},transToHump:function(a){return a.replace(/-([a-z])/gi,function(a,b){return b.toUpperCase()})}}),b.selector=".tshop-pbsm-multi-main-slide",b});KISSY.add("modules/multi-mods/ranking-deprecated/index",function(a,b){function c(a){var b=this;b._el=a.mod,b._init(b._el)}var d=b.all;return a.augment(c,{_init:function(){this._bindUI(),0!=d(this._el).all(".tshop-Rheader_on").length&&d(this._el).all(".tshop-Rheader_on").fire("click")},_bindUI:function(){d(this._el).all(".tshop-Rheader_tab").on("click",function(a){a.preventDefault();var b=d(a.currentTarget),c=b.index();b.parent().all("a").removeClass("tshop-Rheader_on"),b.addClass("tshop-Rheader_on"),d(".tshop-pbsm-multi-mods-ranking .tshop-Rcontent").hide().item(c).show()})}}),c.selector=".tshop-pbsm-multi-mods-ranking",c},{requires:["node"]});KISSY.add("modules/multi-mods/hot-ranking/index",function(a,b){function c(a){var b=this;b._el=a.mod,b._init(b._el)}var d=b.all;return a.augment(c,{_init:function(){this._bindUI(),0!=d(this._el).all(".tshop-header_on").length&&d(this._el).all(".tshop-header_on").fire("click")},_bindUI:function(){var a=this;d(a._el).all(".tshop-header_tab").on("click",function(b){b.preventDefault();var c=d(b.currentTarget),e=c.index();c.parent().all("a").removeClass("tshop-header_on"),c.addClass("tshop-header_on"),d(a._el).all(".ranking-rest").hide().item(e).show()})}}),c.selector=".tshop-pbsm-multi-hot-ranking",c},{requires:["node"]});KISSY.add("modules/multi-mods/recommend-deprecated/index",function(a,b){function c(a){this.elem=a}function d(a){var b=this;b._mod=a.mod,b._mod&&b._init()}function e(a,b){var c=a.length,d=0,e=a.match(/[\u4E00-\u9FA5\uF900-\uFA2D]/g);null!=e&&(d+=e.length);var f=b-c-d;if(0>f){for(var g=0,h=a.substring(0,b),i=0;i<h.length&&(g+=/[\u4E00-\u9FA5\uF900-\uFA2D]/.test(h.charAt(i))?2:1,!(g>b));i++);return h.substring(0,i)+"\u2026"}return a}var a=KISSY,f=a.Event,g=a.DOM,h="disappear",i="success",j="warn",k="failure",m={"grid-m":{item3line1:[0,0,310,310],item4line1:[0,0,230,230],item5line1:[0,0,180,180],item7line1:[0,0,130,130]},"grid-m0":{item3line1:[0,0,310,310],item4line1:[0,0,230,230],item5line1:[0,0,180,180],item7line1:[0,0,130,130]},"grid-s5m0":{item3line1:[0,0,240,240],item30line1:[0,0,248,248],item4line1:[0,0,180,180]},"grid-m0s5":{item3line1:[0,0,240,240],item30line1:[0,0,248,248],item4line1:[0,0,180,180]},"grid-s5m0e5":{item3line1:[0,0,180,180],item4line1:[0,0,130,130]},"grid-m0s5e5":{item3line1:[0,0,180,180],item4line1:[0,0,130,130]},"grid-s5e5m0":{item3line1:[0,0,180,180],item4line1:[0,0,130,130]},"grid-e5s5m0":{item3line1:[0,0,180,180],item4line1:[0,0,130,130]},"grid-e5m0s5":{item3line1:[0,0,180,180],item4line1:[0,0,130,130]},"grid-m0e5s5":{item3line1:[0,0,180,180],item4line1:[0,0,130,130]},"col-sub":{item1line1:[0,0,180,180]},"col-extra":{item1line1:[0,0,180,180]}};return a.mix(c.prototype,{val:function(b,c,d){a.isString(b)&&(d=void 0===d?!0:!!d,g.html(g.get(".text",this.elem),b),this.show(c),d&&this.hide(d))},loading:function(){return this.val("\u6b63\u5728\u5904\u7406\uff0c\u8bf7\u7a0d\u540e...",1,!1)},show:function(a){var b=this.elem;g.css(b,"opacity",1),g.removeClass(b,i),g.removeClass(b,j),g.removeClass(b,k),g.removeClass(b,h),1==a?g.addClass(b,i):2==a?g.addClass(b,j):0==a&&g.addClass(b,k)},hide:function(b){var c=this,d=c.elem;return!0===b?(c.timer&&c.timer.cancel(),void(c.timer=a.later(function(){var b={opacity:0},e=new a.Anim(d,b,.5,"easeIn",function(){g.addClass(d,h),c.timer=null});e.run()},3e3))):void g.addClass(d,h)}}),a.augment(d,{_init:function(){a.log("TshopPbsmShopItemRecommend init start");var b,c=this;b=function(){c._updateToken(),c._bindEvt(),c.fixHover([{selector:".item-wrap",hClass:"item-wrap-hover"}]),c._initItemRates(),c._fixMinMax(),a.log("TshopPbsmShopItemRecommend init end")},c._ABTestRequest(b)},_ABTestRequest:function(b){var c,d,e,f=this;return e=function(){return b(),!1},(c=g.attr(f._mod,"data-ald-rcmd"))?(d=JSON.parse(c),d&&d.url?void a.io({url:d.url,dataType:"jsonp",data:{refer:document.referrer||""},success:function(b){if(!b||!b.itemList||!b.itemList.length)return e();var c=g.get(".skin-box",f._mod),h=g.innerHeight(f._mod);g.css(f._mod,"height",h),g.css(c,"display","none");var i,j=g.query(".item",f._mod);if(i=g.get(".J_TItemRatesUrl")){var k=g.val(i),l=function(){var c=[];return a.each(b,function(a){c.push(a.id)}),c.join(",")}();k.replace(/itemIds=.*&/i,"itemIds="+l+"&"),g.val(i,k)}a.each(j,function(a,c){var e=b.itemList[c],f=g.get("img",a),h=d.picSize?d.picSize:"310",i="_"+h+"x"+h+".jpg",j=e.img+i;g.attr(f,"data-ks-lazyload")?g.attr(f,"data-ks-lazyload",j):g.attr(f,"src",j),g.attr(a,"data-id",e.id),g.attr(g.query("a",a),"href",e.url),g.text(g.get(".item-name",a),e.title),g.text(g.get(".c-price",a),(d.showDiscount?e.price:e.marketPrice)||""),g.text(g.get(".sale-num",a),e.sellNum||0),g.text(g.get(".comment-num",a),e.commentNum||0)}),(new Image).src=b.acurl,g.css(f._mod,"height","auto"),g.css(c,"display","block"),e()},error:e}):e()):e()},_updateToken:function(){var b=this,c=g.get("#J_TokenField");if(c){var d=/_tb_token_=[^&].*/i,e="_tb_token_="+c.value,f=g.query(".J_TCollectItem",b._mod);a.each(f,function(a){var b=g.attr(a,"data-href");d.test(b)?g.attr(a,"data-href",b.replace(d,e)):g.attr(a,"data-href",b+=(-1!==b.lastIndexOf("&")?"&":"?")+e)})}},_bindEvt:function(){},fixHover:function(b){var c=this,d=[];a.each(b,function(b){d=g.query(b.selector,c._mod),a.each(d,function(c){f.on(c,"mouseenter",function(c){a.one(this).addClass(b.hClass)}),f.on(c,"mouseleave",function(c){a.one(this).removeClass(b.hClass)})})})},_bindItemCollectEvt:function(){var b=this,d=g.get(".items",b._mod);f.on(d,"click",function(b){var d=b.target;if(g.hasClass(d,"J_TCollectItem")){var e=d;a.io({url:g.attr(e,"data-href"),data:{itemSkuList:g.attr(e,"data-item-id")},dataType:"jsonp",success:function(a){var b,d;if(a.result.status)b="\u6536\u85cf\u6210\u529f",d=1;else{switch(a.result.message.errorCode){case 7:case 8:case 11:d=2;break;default:d=0}b=a.result.message.error}var f=new c(g.get(".J_TMsg",g.parent(e)));f.val(b,d)},error:function(a){var b=new c(g.get(".J_TMsg",g.parent(e)));b.val("\u64cd\u4f5c\u8d85\u65f6",0)}})}})},_initItemRates:function(){function b(){a.io({url:h.value,dataType:"jsonp",jsonp:"jsoncallback",type:"post",success:function(b){var c,f,h=b.batchQueryRateList,i=g.query(".item",d._mod);a.each(i,function(a){c=g.attr(a,"data-id");for(var b=0;b<h.length;b++)h[b].auctionNumId==c&&(f=g.get(".J_TRate",a),""==h[b].rateContent?g.text(f,"\u6682\u65e0\u8bc4\u8bba"):g.text(f,e(h[b].rateContent,72)))})},error:function(b){a.log("\u67e5\u8be2\u5b9d\u8d1d\u8bc4\u8bba\u5931\u8d25")}})}function c(){!d.isSendRate&&g.scrollTop(window)>=i&&(d.isSendRate=!0,b(),f.detach(window,"scroll",c))}var d=this,h=g.get(".J_TItemRatesUrl",d._mod),i=g.offset(d._mod).top-g.viewportHeight();d.isSendRate=!1,h&&""!=h.value&&f.on(window,"scroll",c)},_fixMinMax:function(){var c,d,e,f=this;if(null!=g.parent(f._mod,".col-sub"))c=m["col-sub"];else if(null!=g.parent(f._mod,".col-extra"))c=m["col-extra"];else{var h=g.parent(f._mod,".layout"),i=["grid-m","grid-m0","grid-s5m0","grid-m0s5","grid-s5m0e5","grid-m0s5e5","grid-s5e5m0","grid-e5s5m0","grid-e5m0s5","grid-m0e5s5"];for(e=0,l=i.length;e<l&&!g.hasClass(h,i[e]);e++);c=m[i[e]]}var j=["item1line1","item3line1","item30line1","item4line1","item5line1","item7line1"],k=g.get("div",g.get(".skin-box-bd",f._mod));for(e=0,l=j.length;e<l&&!g.hasClass(k,"."+j[e]);e++);if(d=c[j[e]],void 0!=d){var n=d,o=g.query("img",f._mod),p={},q=["minWidth","minHeight","maxWidth","maxHeight"];for(e=0,l=n.length;e<l;e++)0!==parseInt(n[e])&&(p[q[e]]=!0,p[q[e]+"Value"]=parseInt(n[e]));a.each(o,function(a){new b(a,p)})}}}),d.selector=".tshop-pbsm-multi-item-recommend",d},{requires:["wangpu/decoration/compatible"]});KISSY.add("modules/activity/coupon/get/base",function(a,b){var c={isOnline:function(){return window.location.host.indexOf("taobao.com")>0||window.location.host.indexOf("jiyoujia.com")>0},realHost:function(){return this.isOnline()?"taobao.com":"daily.taobao.net"},realAssetsHost:function(){return this.isOnline()?"g.tbcdn.cn":"g.assets.daily.taobao.net"}};return c}),KISSY.add("modules/activity/coupon/get/coupon",function(a,b){function c(a){var b=this;b.config=a,b.type=a.type?a.type:"hongbao",b.activityId=a.activityId,b.showItems=void 0!=a.showItems?a.showItems:!0,b.sellerId=a.sellerId,b.daily=void 0!=a.daily?a.daily:!1,b.applyChannel=a.applyChannel,b.isShop=a.isShop?!0:!1,b.token=a.token?a.token:"";var c="taoquan.taobao.com";b.daily&&(c="taoquan.daily.taobao.net"),"hongbao"==b.type?(b.cburl=a.cburl,b.applyUrl="//"+c+"/coupon/shopbonus/buyer_share_apply.htm"):b.applyUrl="//"+c+"/coupon/itemCoupon/item_coupon_promotion_apply.htm",b.init()}var a=KISSY,d=a.DOM,e=a.Event,f=function(a){return this instanceof f?(a=a||{},this.cburl=a.cburl,this.daily=!!a.daily,this.from=a.from,f.__INSTANCE__=this,this.available=!0,void this._init()):new f(a)};return a.augment(f,e.Target,{_init:function(){return a.namespace("Member.Weibo",!0),window.Member.Weibo.Bind=f,this.from&&this.cburl&&0===this.cburl.indexOf(window.location.protocol+"//"+window.location.host)?void(this.url="//member1."+(this.daily?"daily.taobao.net":"taobao.com")+"/member/fresh/weibo_bind_management.htm"):(this.available=!1,this.fire("failure"),void alert("ERROR: no from/cburl param or domain not match."))},show:function(){return this.available?(this.o=new b.Dialog({prefixCls:"applyCoupon-",width:400,headerContent:"\u9886\u53d6\u7ea2\u5305\u9700\u8f6c\u53d1\u6d3b\u52a8\u5fae\u535a",bodyContent:'<iframe src="'+this.url+"?cburl="+this.cburl+"&from="+this.from+'" style="display:block;width:400px;height:355px;" scrolling="no" frameborder="0" allowtransparency="true"></iframe>',closable:!0,closeAction:"destroy",mask:!1,zIndex:1e9}),this.o.render(),this.o.center(),this.o.get("el").all(".applyCoupon-ext-close-x").html("\xd7"),this.o.show(),this._bindEvent(),this):this},hide:function(){return this.available?(this.o&&this.o.destroy(),this.o=null,this.fire("hide"),this):this},_bindEvent:function(){this.on("success failure",function(){this.hide()},this),this.o&&this.o.on("hide",function(){this.fire("hide"),this.fire("destroy")},this)}}),window.location.href.indexOf("jiyoujia.com")>-1?loHref="//shop"+shop_config.shopId+".taobao.com/dc-3773.htm":loHref=location.href,a.augment(c,e.Target,{init:function(){var a=this,b=!1;if(-1==loHref.indexOf("taobao"))b=!0;else{var c=function(a){var b,c;return(c=String(document.cookie).match(new RegExp("(?:^| )"+a+"(?:(?:=([^;]*))|;|$)")))&&(b=c[1]?decodeURIComponent(c[1]):""),b};b=!!(c("_l_g_")&&c("_nk_")||c("ck1")&&c("tracknick")||c("lgc"))}a.initLogin(b)},normalize:function(a){var b=this;return a=b.daily?a.replace("a.tbcdn.cn","assets.daily.taobao.net").replace("taobao.com","daily.taobao.net"):a.replace("assets.daily.taobao.net","a.tbcdn.cn").replace("daily.taobao.net","taobao.com")},initLogin:function(b){var c=this;if(0==b){goldlog&&goldlog.send("//ga.mmstat.com/tbtwlact.2.2",{});var f=c.normalize("//login.taobao.com/member/login.jhtml?style=mini&is_ignore=false&full_redirect=true"),g='<div class="sns-login-content"><div class="sns-login-wrap"><div class="sns-login-title">\u6dd8\u5b9d\u4f1a\u5458</div><iframe width="330" height="285" frameborder="0"scrolling="no" src="'+f+'&redirect_url={redirectUrl}"></iframe></div><s style="display:{closeBtn}" class="sns-close-btn">&times;</s></div>',h=".sns-close-btn {    color:#9c9c97;    text-decoration:none;    font-size:22px;    position:absolute;    right:12px;    top:5px;    cursor:pointer;}.sns-popup-login {	position:absolute;}.sns-login-content {   border-radius: 3px;	border:3px solid #d5d5d5;	background-color:#FAFAFA;}.sns-login-wrap {   width: 330px;    border: 1px solid #aaa;   overflow: hidden; }.sns-login-title {   background: #f2f2f2;   height: 35px;   line-height: 35px;   font-size: 14px;   font-weight: 700;   color: #000;   padding-left: 15px;   margin-bottom: 25px;}";d.addStyleSheet(h);var i=new a.Overlay({elCls:"sns-popup-login",content:a.substitute(g,{closeBtn:"block",redirectUrl:encodeURIComponent(loHref)}),zIndex:1e9,mask:!1,align:{node:null,points:["cc","cc"],offset:[0,0]}});i.render(),i.show();var j;j=a.isFunction(i.get)?i.get("el").getDOMNode():i.container,e.on(d.get(".sns-close-btn",j),"click",function(){i.destroy()})}else a.io({url:c.applyUrl,data:{activityId:c.activityId,sellerId:c.sellerId,applyChannel:c.applyChannel},cache:!1,dataType:"jsonp",success:function(a){if(c.shopUrl=a.shopUrl,c.shopName=a.shopName,c.amount=a.amount,c.startTime=a.startTime,c.endTime=a.endTime,c.startFee=a.startFee,c.discount=a.discount,c.activeCenter=a.activeCenter,"true"==a.success)c.renderPop(a);else{if("NOT_LOGIN"==a.code)return void c.initLogin(!1);if("NOT_BIND_WEIBO"==a.code)return void c.weiboBind();if("SHARE_WEIBO"==a.code)return void c.share();if("PARAM_VALID"==a.code)return void alert(a.msg);"APPLY_ERROR"==a.code&&c.renderPop(a)}}})},weiboBind:function(){goldlog&&goldlog.send("//ga.mmstat.com/tbtwlact.2.3",{});var a=this;f({cburl:a.cburl,daily:a.daily,from:"sns"}).show().on("success",function(){a.share(),goldlog&&goldlog.send("//ga.mmstat.com/tbtwlact.2.8",{})}).on("failure",function(){goldlog&&goldlog.send("//ga.mmstat.com/tbtwlact.2.8",{})})},_getValue:function(b){var c=a.trim(d.attr(b,"placeholder")),e=a.trim(b.value),f=d.attr(b,"maxlength");return c===e?"":f&&e>=f?e.substr(0,f):e},encodeGBK:function(a){function b(a){return a?window.ActiveXObject?(execScript('SetLocale "zh-cn"',"vbscript"),a.replace(/[\d\D]/g,function(a){return window.vbsval="",execScript('window.vbsval=Hex(Asc(" '+a+'"))',"vbscript"),"%"+window.vbsval.slice(0,2)+"%"+window.vbsval.slice(-2)})):(c.src="//www.atpanel.com/jsclick?globaljs=1&separator="+a,c.src.split("&separator=").pop()):""}var c=document.createElement("img");return a.replace(/([^\x00-\xff]+)|([\x00-\xff]+)/g,function(a,c,d){return b(c)+encodeURIComponent(d||"")})},share:function(){goldlog&&goldlog.send("//ga.mmstat.com/tbtwlact.2.1",{});var c=this,d=a.Cookie.get("_nk_")||a.Cookie.get("lgc");void 0!=d&&(d=a.fromUnicode(d)),c.shopName||(c.shopName="");var e='<div class=\'apply-coupon-content clearfix\'><div class="sns-content">\n<div class="article">\n    <div class="selected">\n        <span class="title">\u540c\u6b65\u5230:</span>\n        <i class="i-sina"></i>\n    </div>\n    <div class="item">\n        <div class="share-ipt">\n            <div class="user">\n                <img src="//wwc.taobaocdn.com/avatar/getAvatar.do?userNick='+c.encodeGBK(d).toLowerCase()+'&width=80&height=80&type=sns" width="40" height="40">\n                <span class="user-nick">'+d+'</span>\n            </div>\n            <div class="entry">\n                <textarea maxlength="140" class="J_SnsShareComment">#1212\u5e97\u94fa\u7ea2\u5305\u5927\u6d3e\u9001#\u8f7b\u8f7b\u677e\u677e\u5c31\u9886\u5230'+c.amount+"\u5757\u94b1\uff0c\u597d\u55e8\u68ee\uff01\uff01\u4f60\u60f3\u8981\u5417\uff1f"+c.shopName+'\u5e97\u94fa\u6b63\u5728\u53d1\u7ea2\u5305\uff0c\u5c0f\u4f19\u4f34\u4eec\u90fd\u62a2\u75af\u4e86\uff0c\u518d\u4e0d\u53bb\u5c31\u6ca1\u5566\uff01</textarea>\n            </div>\n            <p class="count hidden">\u8fd8\u53ef\u4ee5\u8f93\u5165 <em class="J_Count">135</em> \u4e2a\u5b57</p><s></s></div>\n    </div>\n</div>\n<div class="sns-share-widget-footer">\n    <div class="operate">\n        <a class="continue J_Continue J_Submit" href="">\u7acb\u5373\u5206\u4eab</a>\n        <a class="cancel J_Cancel J_Close" href="">\u53d6\u6d88</a>\n    </div>\n    <div class="J_ExtraInfo extra-info"></div>\n</div>\n</div></div>';c.amount||(e='<div class=\'apply-coupon-content clearfix\'><div class="sns-content">\n<div class="article">\n    <div class="selected">\n        <span class="title">\u540c\u6b65\u5230:</span>\n        <i class="i-sina"></i>\n    </div>\n    <div class="item">\n        <div class="share-ipt">\n            <div class="user">\n                <img src="//wwc.taobaocdn.com/avatar/getAvatar.do?userNick='+c.encodeGBK(d).toLowerCase()+'&width=80&height=80&type=sns" width="40" height="40">\n                <span class="user-nick">'+d+'</span>\n            </div>\n            <div class="entry">\n                <textarea maxlength="140" class="J_SnsShareComment">#1212\u5e97\u94fa\u7ea2\u5305\u5927\u6d3e\u9001#\u8f7b\u8f7b\u677e\u677e\u5c31\u9886\u5230\u7ea2\u5305\uff0c\u597d\u55e8\u68ee\uff01\uff01\u4f60\u60f3\u8981\u5417\uff1f'+c.shopName+'\u5e97\u94fa\u6b63\u5728\u53d1\u7ea2\u5305\uff0c\u5c0f\u4f19\u4f34\u4eec\u90fd\u62a2\u75af\u4e86\uff0c\u518d\u4e0d\u53bb\u5c31\u6ca1\u5566\uff01</textarea>\n            </div>\n            <p class="count hidden">\u8fd8\u53ef\u4ee5\u8f93\u5165 <em class="J_Count">135</em> \u4e2a\u5b57</p><s></s></div>\n    </div>\n</div>\n<div class="sns-share-widget-footer">\n    <div class="operate">\n        <a class="continue J_Continue J_Submit" href="">\u7acb\u5373\u5206\u4eab</a>\n        <a class="cancel J_Cancel J_Close" href="">\u53d6\u6d88</a>\n    </div>\n    <div class="J_ExtraInfo extra-info"></div>\n</div>\n</div></div>');var f=new b.Dialog({prefixCls:"applyCoupon-",zIndex:1e9,mask:!1,headerContent:"\u9886\u53d6\u7ea2\u5305\u9700\u8f6c\u53d1\u6d3b\u52a8\u5fae\u535a",bodyContent:e,closeable:!0,closeAction:"destroy"});f.render(),f.get("el").all(".applyCoupon-ext-close-x").html("\xd7"),f.center(),f.show(),f.get("el").one("textarea").on("focus",function(b){a.all(b.target).css("color","#000")}),f.get("el").one("textarea").on("blur",function(b){a.all(b.target).css("color","#999")}),c._maxlength(f.get("el").getDOMNode()),f.get("el").one(".J_Close").on("click",function(a){a.preventDefault(),goldlog&&goldlog.send("//ga.mmstat.com/tbtwlact.2.7",{}),f.destroy()}),f.get("el").one(".applyCoupon-ext-close-x").on("click",function(a){goldlog&&goldlog.send("//ga.mmstat.com/tbtwlact.2.7",{})}),f.get("el").one(".J_Submit").on("click",function(b){b.preventDefault(),goldlog&&goldlog.send("//ga.mmstat.com/tbtwlact.2.6",{}),a.io({url:c.applyUrl,data:{activityId:c.activityId,sellerId:c.sellerId,applyChannel:c.applyChannel,title:encodeURIComponent("\u6dd8\u5b9d\u7f51\u53cc\u5341\u4e8c\u5e97\u94fa\u7ea2\u5305\u6d3b\u52a8"),comment:encodeURIComponent(c._getValue(f.get("el").all(".J_SnsShareComment").getDOMNode())),link:c.activeCenter},dataType:"jsonp",cache:!1,success:function(a){if(f.destroy(),"true"==a.success)goldlog&&goldlog.send("//ga.mmstat.com/tbtwlact.2.5",{activityId:c.activityId,sellerId:c.sellerId,applyChannel:c.applyChannel}),c.renderPop(a);else{if("PARAM_VALID"==a.code)return void alert(a.msg);"APPLY_ERROR"==a.code&&c.renderPop(a)}}})})},hasParam:function(a){return a.indexOf("?")>-1?a+"&":a+"?"},_maxlength:function(a){var b="maxLength"in document.createElement("textarea");if(!b){var c=a.getAttribute("maxlength");e.on(a,"valuechange",function(b){a.value.length>c&&(a.value=a.value.substring(0,c))})}},renderPop:function(c){var f=this,g="",h="",i='<div style="margin-top: 13px;color: #666;"><a class="J_close">\u786e \u5b9a</a>',j="";"hongbao"==f.type?(j="1223.1.10",goldlog&&goldlog.send("//ga.mmstat.com/tbtwlact.1.1",{})):(j="1223.2.10",goldlog&&goldlog.send("//ga.mmstat.com/tbtwlact.3.1",{}));var k='<div class="applyCouponResult"><div class="close">\xd7</div> <div class="results">';if("true"==c.success){goldlog&&goldlog.send("//ga.mmstat.com/shopcoupons.1.* ",{});var l=!1;if(f.fire("success"),k+=' <div class="label suc"></div>',c.startTime=c.startTime.slice(0,10).replace("-",".").replace("-","."),c.endTime=c.endTime.slice(0,10).replace("-",".").replace("-","."),"hongbao"==f.type){var m="";c.amount&&(m='<span class="red"><span class="money">\uffe5</span>'+c.amount+"</span>"),g="\u606d\u559c\uff0c\u60a8\u5df2\u6210\u529f\u9886\u53d6"+m+'\u5e97\u94fa\u7ea2\u5305\u3002<a target="_blank" href="//taoquan.taobao.com/framework/got_bonus.htm?scm=1223.1.10.1&tabIndex=5" style="font-size: 12px">\u67e5\u770b></a></div>',g+='<div class="date">\u4f7f\u7528\u65f6\u95f4\uff1a'+c.startTime+"-"+c.endTime+" \u5168\u5e97\u901a\u7528</div>",h="<div>"}else{var m="";c.startFee&&c.discount&&(m='<span class="red">\u6ee1'+c.startFee+"\u51cf"+c.discount+"\u5143</span>"),g="\u606d\u559c\uff0c\u60a8\u5df2\u6210\u529f\u9886\u53d6"+m+'\u5546\u54c1\u4f18\u60e0\u5238\u3002</div><div class="date">\u4f7f\u7528\u65f6\u95f4\uff1a'+c.startTime+"-"+c.endTime,c.shopUrl&&(g+='<a href="'+f.hasParam(c.shopUrl)+"scm="+j+'.4" target="_blank">\u67e5\u770b\u9002\u7528\u5b9d\u8d1d</a>'),g+="</div>"}l&&(i+='<span style="*vertical-align: bottom"><input checked="checked" class="J_collect" type="checkbox">\u6536\u85cf\u8be5\u5e97</span>')}else goldlog&&goldlog.send("//ga.mmstat.com/shopcoupons.2.* ",{}),k+='<div class="label fail"></div>',f.fire("fail"),g=c.msg+"</div>","hongbao"==f.type&&(h='<a target="_blank" href="//taoquan.taobao.com/framework/got_bonus.htm?scm=1223.1.10.1&tabIndex=5" style="font-size: 12px">\u67e5\u770b\u5df2\u9886\u5230\u7684\u5e97\u94fa\u7ea2\u5305></a>');i+="</div>","hongbao"!=f.type&&(!f.isShop&&c.activeCenter&&(g+='<div><a href="'+f.hasParam(c.activeCenter)+"scm="+j+'.1" target="_blank">\u67e5\u770b\u8be5\u5e97\u66f4\u591a\u4f18\u60e0</a></div>'),h=' <div>\u67e5\u770b\u5df2\u9886\u5546\u54c1\u4f18\u60e0\u5238\uff1a<a href="//taoquan.taobao.com/framework/got_bonus.htm?tabIndex=2&display=true&tabDomId=itemCouponTab&scm='+j+'.2" target="_blank">\u6211\u7684\u4f18\u60e0\u4fe1\u606f</a></div>'),k+=' <div class="result-text"><div class="result">'+g+'<div class="gray">'+h+" </div>"+i+"</div> </div> ",k+="</div>";var n=new b.Popup({prefixCls:"applyCoupon-",zIndex:1e9,mask:!1,content:k,closeable:!0,closeAction:"destroy"});n.render(),n.center(),n.show(),e.on(d.get(".close",n.get("el")),"click",function(a){n.destroy()}),e.on(d.get(".J_close",n.get("el")),"click",function(b){var e=d.get(".J_collect",n.get("el"));if(e&&d.prop(e,"checked")){var g;g=f.daily?"//favorite.daily.taobao.net/json/addCollectionForAll.htm":"//favorite.taobao.com/json/addCollectionForAll.htm",a.io({url:g,data:{shopId:c.shopId,favType:0},dataType:"jsonp",cache:"false"})}n.destroy()})}}),c},{requires:["overlay"]}),KISSY.add("modules/activity/coupon/get/index",["ajax","./base","./coupon.css","./coupon.js"],function(a,b){var c=b("ajax"),d=b("./base");b("./coupon.css");var e=b("./coupon.js"),f=window.shop_config.userId||window.shop_config.isvStat.userId,g={disableHTML:'\u5df2\u9886\u53d6<s class="act-sprite"></s>',shop:function(){},getCouponOrBonus:function(a,b){var c=this,g=a.attr("activity-id"),h={type:b,activityId:g,sellerId:f,daily:!d.isOnline(),applyChannel:1};new e(h).on("success",function(){a.addClass("disable").html(c.disableHTML)}).on("fail",function(){})},initCoupon:function(b,e){var g=this,h="//site."+d.realHost()+"/page-25122.htm?type=2";c.jsonp(h,{sid:f},function(c){c&&(c.coupon&&a.each(c.coupon,function(a){var c=b.filter('[coupon-id="'+a.couponId+'"]');c&&c.addClass("disable").html(g.disableHTML)}),c.bonus&&a.each(c.bonus,function(a){var b=e.filter('[bonus-id="'+a.bonusId+'"]');b&&b.addClass("disable").html(g.disableHTML)}))})}};return g}),KISSY.add("modules/activity/coupon/index",["node","./get/","kg/slide/2.0.2/index"],function(a,b){function c(a){this._mod=a.mod,this._mod&&(this.container=d(this._mod),this.init())}var d=b("node").all,e=b("./get/"),f=b("kg/slide/2.0.2/index"),g=".tshop-pbsm-activity-coupon";return a.augment(c,{init:function(){this.bindEvent(),this.initSlide()},bindEvent:function(){this.container.delegate("click",".J_getCoupon",function(a){a.preventDefault();var b=d(a.currentTarget);b.hasClass("disable")||e.getCouponOrBonus(b,"coupon")})},initSlide:function(){var a=d("#J_ActivityCouponSlide",this.container),b=a.all(".coupon-item");if(!(b.length<=3)){a.one(".prev").hide(),a.one(".slide-nav").show(),b.css("margin-right",0);var c=new f(a,{contentClass:"slide-content",pannelClass:"coupon-item",effect:"hSlide",carousel:!1,colspan:3}).on("afterSwitch",function(){c.is_last()?a.one(".next").hide():a.one(".next").show(),c.is_first()?a.one(".prev").hide():a.one(".prev").show()});a.one(".next").on("click",function(a,b){c.is_last()||c.next()}),a.one(".prev").on("click",function(a){c.is_first()||c.previous()})}}}),c.selector=g,c});KISSY.add("modules/activity/top4/index",["node","ajax","wangpu/gallery/datalazyload"],function(a,b){function c(a){var b=new RegExp("(^|&)"+a+"=([^&]*)(&|$)","i"),c=window.location.search.substr(1).match(b);return null!=c?unescape(c[2]):null}function d(a){this._mod=a.mod,this._mod&&this.init()}var e=b("node").all,f=b("ajax"),g=".tshop-pbsm-activity-top4",h=b("wangpu/gallery/datalazyload");return a.augment(d,{init:function(){this.bindEvent()},bindEvent:function(){var b=e(g),d=b.attr("data-url"),h=b.attr("data-lazy"),i=e(".J_top4Wrap",g),j=b.attr("data-show"),k=this;if(1==j||"true"==j){if(!d)return;f({url:d,type:"get",dataType:"jsonp",data:{itemId:c("itemId")||c("item_id")},success:function(b){if(b&&0==b.status&&b.result&&b.result.length){var c=b.result;i.addClass("top4-wrap");var d='<div class="item-4">';a.each(c,function(a){d+=k.tpl(a,h)}),d+="</div>",i.html(d),h&&k._lazyload(k._mod)}},fail:function(a){}})}},_lazyload:function(a){new h({container:a,autoDestroy:!1})},tpl:function(a,b){if(b)var c='<div class="act-module-item"><a href="//item.taobao.com/item.htm?id='+a.itemId+'" target="_blank" >   <div class="baby-img"> <div class="baby-img-inner">   <img class="lazy-load-img" alt="'+a.itemName+'" data-ks-lazyload="//img.alicdn.com/bao/uploaded/'+a.pic+'_240x240.jpg" src="'+b+'"> </div>   </div>   <div class="baby-main"> <p class="baby-info">'+a.itemName+'</p>       <p class="price-sec">           <span class="price price-primary"><span class="rmb">\xa5</span>'+a.promotionPrice+"</span>       </p></div></a></div>";else var c='<div class="act-module-item"><a href="//item.taobao.com/item.htm?id='+a.itemId+'" target="_blank" >   <div class="baby-img"> <div class="baby-img-inner">   <img class="lazy-load-img" alt="'+a.itemName+'" src="//img.alicdn.com/bao/uploaded/'+a.pic+'_240x240.jpg"> </div>   </div>   <div class="baby-main"> <p class="baby-info">'+a.itemName+'</p>       <p class="price-sec">           <span class="price price-primary"><span class="rmb">\xa5</span>'+a.promotionPrice+"</span>       </p></div></a></div>";return c}}),d.selector=g,d});KISSY.add("modules/shop/coupon-mod/coupon/index",function(a,b){function c(a){var b=this;b.config=a,b.safeCode=a.safeCode,b.applyUrl=a.url,b.init()}var a=KISSY,d=a.DOM,e=a.Event;return window.location.href.indexOf("jiyoujia.com")>-1?loHref="//shop"+shop_config.shopId+".taobao.com/dc-3773.htm":loHref=location.href,a.augment(c,e.Target,{init:function(){var a=this,b=!1;if(-1==loHref.indexOf("taobao"))b=!0;else{var c=function(a){var b,c;return(c=String(document.cookie).match(new RegExp("(?:^| )"+a+"(?:(?:=([^;]*))|;|$)")))&&(b=c[1]?decodeURIComponent(c[1]):""),b};b=!!(c("_l_g_")&&c("_nk_")||c("ck1")&&c("tracknick")||c("lgc"))}a.initLogin(b)},normalize:function(a){var b=this;return a=b.daily?a.replace("a.tbcdn.cn","assets.daily.taobao.net").replace("taobao.com","daily.taobao.net"):a.replace("assets.daily.taobao.net","a.tbcdn.cn").replace("daily.taobao.net","taobao.com")},initLogin:function(b){var c=this;if(0==b){goldlog&&goldlog.send("//ga.mmstat.com/tbtwlact.2.2",{});var f=c.normalize("//login.taobao.com/member/login.jhtml?style=mini&is_ignore=false&full_redirect=true"),g='<div class="sns-login-content"><div class="sns-login-wrap"><div class="sns-login-title">\u6dd8\u5b9d\u4f1a\u5458</div><iframe width="330" height="285" frameborder="0"scrolling="no" src="'+f+'&redirect_url={redirectUrl}"></iframe></div><s style="display:{closeBtn}" class="sns-close-btn">&times;</s></div>',h=".sns-close-btn {    color:#9c9c97;    text-decoration:none;    font-size:22px;    position:absolute;    right:12px;    top:5px;    cursor:pointer;}.sns-popup-login { position:absolute;}.sns-login-content {   border-radius: 3px; border:3px solid #d5d5d5; background-color:#FAFAFA;}.sns-login-wrap {   width: 330px;    border: 1px solid #aaa;   overflow: hidden; }.sns-login-title {   background: #f2f2f2;   height: 35px;   line-height: 35px;   font-size: 14px;   font-weight: 700;   color: #000;   padding-left: 15px;   margin-bottom: 25px;}";d.addStyleSheet(h);var i=new a.Overlay({elCls:"sns-popup-login",content:a.substitute(g,{closeBtn:"block",redirectUrl:encodeURIComponent(loHref)}),zIndex:1e9,mask:!1,align:{node:null,points:["cc","cc"],offset:[0,0]}});i.render(),i.show();var j;j=a.isFunction(i.get)?i.get("el").getDOMNode():i.container,e.on(d.get(".sns-close-btn",j),"click",function(){i.destroy()})}else a.io({url:c.applyUrl,data:{safeCode:c.safeCode},cache:!1,dataType:"jsonp",success:function(a){if(a.success)if(a.data&&a.data.success)c.renderPop(a.data);else{if(a.data&&"NEED_LOGIN"==a.data.errCode)return void c.initLogin(!1);c.renderPop(a.data)}else{if(a.code&&"NEED_LOGIN"==a.code)return void c.initLogin(!1);a.msg?c.renderPop({success:!1,title:a.msg}):alert("\u7cfb\u7edf\u9519\u8bef")}}})},hasParam:function(a){return a.indexOf("?")>-1?a+"&":a+"?"},renderPop:function(a){var c=this,f="",g="",h='<div style="margin-top: 20px;color: #666;"><a class="J_close">\u786e \u5b9a</a>',i='<div class="applyCouponResult"><div class="close">\xd7</div> <div class="results">';a.success?(c.fire("success"),i+=' <div class="label suc"></div>',f=a.title+"</div>",f+="</div>"):(i+='<div class="label fail"></div>',c.fire("fail"),f=a.title+"</div>"),h+="</div>",i+=' <div class="result-text"><div class="result">'+f+'<div class="gray">'+g+" </div>"+h+"</div> </div> ",i+="</div>";var j=new b.Popup({prefixCls:"applyCoupon-",zIndex:1e9,mask:!1,content:i,closeable:!0,closeAction:"destroy"});j.render(),j.center(),j.show(),e.on(d.get(".J_close",j.get("el")),"click",function(a){j.destroy()}),e.on(d.get(".close",j.get("el")),"click",function(a){j.destroy()})}}),c},{requires:["overlay"]}),KISSY.add("modules/shop/coupon-mod/index",function(a,b){function c(a){this._mod=a.mod,this._mod&&(this.container=e(this._mod),this.btn=this.container.one(".J_getCoupon"),this.url=this.btn.attr("data-url"),this.userId=window.shop_config.userId||window.shop_config.isvStat.userId,this._init())}var d=".tshop-pbsm-shop-coupon-mod",e=a.all;return a.augment(c,{_init:function(){a.log("TshopPsmShopCouponMod init start"),a.log("TshopPsmShopCouponMod init end"),this._bindEvent()},_bindEvent:function(){var a=this,b=a.btn;b.on("click",function(){a._getBonus(function(){})})},_getBonus:function(a){var c={url:this.url,safeCode:window.cc&&window.cc.getUA()};new b(c).on("success",function(){a(null)}).on("fail",function(){a(new Error("\u9886\u53d6\u5931\u8d25\uff01"))})}}),c.selector=d,c},{requires:["./coupon/index"]});